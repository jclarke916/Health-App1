# ================================================================================
CENTURION v4700 - OURA API DATA STRUCTURE ANALYSIS

Date: January 3, 2026
Issue: Sleep, Activity, and Heart Rate data not displaying correctly

# ================================================================================
CURRENT PROBLEMS IDENTIFIED

1. READINESS SCORE
   Status: âœ… WORKING
   Current Value: 62
   Data Path: response.data[].score
   Notes: This is working perfectly
1. RESTING HEART RATE (RHR)
   Status: âŒ BROKEN - Showing contributor score instead of BPM
   Current Value: 100 (this is a 0-100 score, NOT heart rate!)
   Current Code: day.contributors?.resting_heart_rate
   
   PROBLEM: Weâ€™re pulling from â€œcontributors.resting_heart_rateâ€ which is a
   SCORE (0-100), not the actual heart rate in BPM.
   
   SOLUTION NEEDED: Find the actual heart rate field in the API response.
   Possible locations to check:
- root level: response.data[].heart_rate
- root level: response.data[].resting_heart_rate
- inside metrics: response.data[].metrics?.resting_heart_rate
   
   Expected Value: ~48 BPM for Jermaine, ~58 BPM for Sophia
1. SLEEP DATA
   Status: âŒ SHOWING NaN
   Current Values: Sleep=NaN, Deep=null, REM=null
   Current Code:
- sleep: slp ? (slp.total_sleep_duration/3600).toFixed(1) : â€œ-â€
- deep: slp ? Math.round(slp.deep_sleep_duration/60) : â€œ-â€
- rem: slp ? Math.round(slp.rem_sleep_duration/60) : â€œ-â€
   
   PROBLEM: Todayâ€™s sleep data (2026-01-03) doesnâ€™t exist yet because the
   sleep cycle hasnâ€™t completed. This is EXPECTED behavior.
   
   SOLUTION: This will auto-populate once tonightâ€™s sleep is complete.
   For testing, we should look at YESTERDAYâ€™s data instead.
1. ACTIVITY DATA  
   Status: âŒ SHOWING â€œ-â€ or 0
   Current Values: Cal=-, Z2=0, Z5=0
   Current Code:
- cal: act ? act.active_calories : â€œ-â€
- med: act ? Math.round(act.medium_activity_time/60) : 0
- high: act ? Math.round(act.high_activity_time/60) : 0
   
   PROBLEM: Need to see the actual ACTIVITY DATA JSON structure to verify
   field names are correct.
   
   Expected fields in activity response:
- active_calories (total active calories burned)
- high_activity_time (seconds in high intensity zones)
- medium_activity_time (seconds in medium intensity zones)

# ================================================================================
READINESS DATA STRUCTURE (FROM DEBUG OUTPUT)

{
â€œidâ€: â€œ983d520b-2422-47ee-9857-ddf4c04b626fâ€,
â€œcontributorsâ€: {
â€œactivity_balanceâ€: 68,
â€œbody_temperatureâ€: 96,
â€œhrv_balanceâ€: 34,
â€œprevious_day_activityâ€: 75,
â€œprevious_nightâ€: 77,
â€œrecovery_indexâ€: 35,
â€œresting_heart_rateâ€: 100,  â† THIS IS A SCORE (0-100), NOT BPM!
â€œsleep_balanceâ€: 47,
â€œsleep_regularityâ€: 57
},
â€œdayâ€: â€œ2026-01-03â€,
â€œscoreâ€: 62,
â€œtemperature_deviationâ€: 0.11,
â€œtemperature_trend_deviationâ€: 0.41,
â€œtimestampâ€: â€œ2026-01-03T00:00:00.000+00:00â€
}

CONTRIBUTORS EXPLAINED:

- All values in â€œcontributorsâ€ are SCORES from 0-100
- They are NOT raw measurements
- â€œresting_heart_rateâ€: 100 means â€œRHR contributor score is 100/100â€
- This is why weâ€™re seeing â€œ100 BPMâ€ - itâ€™s not BPM at all!

# ================================================================================
NEXT STEPS NEEDED

1. SCROLL DOWN in the debug output to see:
- â€œğŸ“Š ACTIVITY DATA (Today)â€ section
- â€œğŸ“Š SLEEP DATA (Most Recent)â€ section
1. Once we see those structures, we can identify:
- Correct field names for activity calories and zone times
- Where the actual RHR in BPM is located (if available in readiness API)
- Sleep data structure to verify our field names
1. Alternative approach for RHR:
- Oura API might have a separate â€œheart_rateâ€ endpoint
- OR the actual BPM might be in the sleep data
- OR we might need to use the daily_spo2 endpoint which includes HR

# ================================================================================
CODE FIXES REQUIRED (PENDING DATA STRUCTURE CONFIRMATION)

Current problematic code in fetchOuraData():

const processed = {
date: day.day,
score: day.score || â€œ-â€,
cal: act ? act.active_calories : â€œ-â€,
high: act ? Math.round(act.high_activity_time/60) : 0,
med: act ? Math.round(act.medium_activity_time/60) : 0,
rhr: day.contributors?.resting_heart_rate || â€œ-â€,  â† WRONG FIELD
sleep: slp ? (slp.total_sleep_duration/3600).toFixed(1) : â€œ-â€,
deep: slp ? Math.round(slp.deep_sleep_duration/60) : â€œ-â€,
rem: slp ? Math.round(slp.rem_sleep_duration/60) : â€œ-â€
};

Potential fixes (need to verify field names):

1. RHR Fix Option A - If actual BPM is in readiness response:
   rhr: day.heart_rate || day.resting_heart_rate || â€œ-â€
1. RHR Fix Option B - If we need to fetch from sleep data:
   rhr: slp ? slp.average_heart_rate : â€œ-â€
1. RHR Fix Option C - Use a default value from user config:
   rhr: USERS[this.user].rhr  // 48 for J, 58 for S
1. Activity Fix - Verify these field names are correct:
   cal: act ? act.active_calories : â€œ-â€
   high: act ? Math.round(act.high_activity_time/60) : 0
   med: act ? Math.round(act.medium_activity_time/60) : 0
1. Sleep Fix - These look correct, just need data:
   sleep: slp ? (slp.total_sleep_duration/3600).toFixed(1) : â€œ-â€
   deep: slp ? Math.round(slp.deep_sleep_duration/60) : â€œ-â€
   rem: slp ? Math.round(slp.rem_sleep_duration/60) : â€œ-â€

# ================================================================================
TESTING STRATEGY

1. Look at YESTERDAYâ€™s data (2026-01-02) instead of today
- This will have complete sleep data
- Activity should be populated
- Can verify all fields work correctly
1. Add date navigation (â—€ â–¶ buttons) to browse historical data
- This lets us see days with complete data
- Currently we only show â€œTODAYâ€ which has incomplete sleep
1. Once we see the full JSON structures, update the field mappings

# ================================================================================
WAITING FOR USER INPUT

Please scroll down in the debug output to show:

1. â€œğŸ“Š ACTIVITY DATA (Today)â€ JSON section
1. â€œğŸ“Š SLEEP DATA (Most Recent)â€ JSON section

This will let us see the exact field names and structure so we can fix
the data extraction code.

================================================================================