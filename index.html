<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Centurion | v209 SMART Goals</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #000000; --card-bg: #111111; --text-main: #E5E4E2; --text-dim: #888888;
            --accent-gold: #D4AF37; --accent-silver: #444444; --glute-pink: #d63384;
            --carb-high: #ff9100; --carb-low: #00b0ff; --target-green: #2ecc71;
            --recovery-purple: #9b59b6; --heat-red: #e74c3c; --ice-blue: #3498db;
            --macro-pro: #e74c3c; --macro-carb: #f39c12; --macro-fat: #3498db; --macro-cal: #9b59b6;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-dark); color: var(--text-main); margin: 0; padding: 20px; -webkit-tap-highlight-color: transparent; }
        .container { max-width: 1000px; width: 100%; margin: 0 auto; position: relative; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid #333; padding-bottom: 20px; position: relative; }
        .version-tag { position: absolute; top: 0; right: 0; font-size: 0.6rem; color: #444; letter-spacing: 1px; font-weight: 800; }
        h1 { font-weight: 300; letter-spacing: 2px; text-transform: uppercase; margin: 0; background: linear-gradient(to right, #fff, #888); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .profile-badges { display: flex; justify-content: center; gap: 10px; margin-top: 15px; }
        .badge { background: #1a1a1a; padding: 10px 20px; border-radius: 4px; border: 1px solid #333; font-size: 0.7rem; color: var(--accent-silver); text-transform: uppercase; cursor: pointer; font-weight: 800; transition: 0.3s; opacity: 0.5; }
        .badge.active-user { border-color: var(--accent-gold); color: #fff; opacity: 1; box-shadow: 0 0 10px rgba(212, 175, 55, 0.2); }
        .badge.active-user.sophia { border-color: var(--glute-pink); box-shadow: 0 0 10px rgba(214, 51, 132, 0.2); }

        .status-bar { text-align: center; color: var(--accent-gold); font-size: 0.85rem; margin: 15px 0; text-transform: uppercase; font-weight: 700; letter-spacing: 1px; }
        .controls { display: flex; justify-content: center; gap: 8px; margin-bottom: 25px; width: 100%; }
        .nav-btn { background: var(--card-bg); border: 1px solid #333; color: var(--text-main); padding: 12px 0; width: 24%; border-radius: 6px; cursor: pointer; font-size: 0.65rem; font-weight: 800; text-transform: uppercase; text-align: center; }
        .grocery-btn { background: #1a1a1a; color: var(--target-green); border-color: var(--target-green); }

        .tabs { display: flex; justify-content: space-between; background: var(--card-bg); padding: 5px; border-radius: 8px; margin-bottom: 25px; border: 1px solid #222; overflow-x: auto; }
        .tab-btn { background: none; border: none; color: #555; padding: 10px; cursor: pointer; flex: 1; font-size: 0.75rem; display: flex; flex-direction: column; align-items: center; min-width: 62px; }
        .tab-btn.active { color: var(--accent-gold); background: rgba(255,255,255,0.03); font-weight: 800; border-radius: 4px; }
        
        .card { background: var(--card-bg); border-radius: 12px; padding: 30px; border: 1px solid #222; position: relative; margin-bottom: 20px; }
        .card::before { content: ""; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: var(--accent-gold); }
        
        .macro-dashboard { background: #0a0a0a; border: 1px solid #222; border-radius: 8px; padding: 15px; margin-bottom: 20px; cursor: pointer; transition: 0.2s; position: relative; }
        .macro-dashboard:hover { border-color: var(--accent-gold); background: #111; }
        .view-goals-link { position: absolute; top: 15px; right: 15px; color: var(--accent-gold); font-size: 0.6rem; font-weight: 800; opacity: 0.8; }
        .macro-header { display: flex; justify-content: space-between; font-size: 0.7rem; text-transform: uppercase; font-weight: 700; color: #888; margin-bottom: 10px; }
        .macro-row { margin-bottom: 12px; }
        .macro-label { display: flex; justify-content: space-between; font-size: 0.65rem; margin-bottom: 4px; font-weight: 700; }
        .macro-bar-bg { height: 8px; background: #222; border-radius: 4px; overflow: hidden; }
        .macro-bar-fill { height: 100%; border-radius: 4px; transition: width 0.5s ease; }
        .p-fill { background: var(--macro-pro); }
        .c-fill { background: var(--macro-carb); }
        .f-fill { background: var(--macro-fat); }
        .cal-fill { background: var(--macro-cal); }
        
        .label { color: var(--accent-silver); font-size: 0.6rem; text-transform: uppercase; font-weight: 700; margin-bottom: 5px; letter-spacing: 1px; }
        .value { font-size: 1.1rem; margin-bottom: 15px; color: #fff; cursor: pointer; border-bottom: 1px solid transparent; display: flex; align-items: center; gap: 8px; }
        .carb-pill { padding: 4px 12px; border-radius: 4px; font-size: 0.7rem; font-weight: 900; color: #fff; text-transform: uppercase; float: right; }
        
        .workout-header { display:flex; justify-content:space-between; margin-bottom:20px; font-weight:800; text-transform:uppercase; color:var(--accent-gold); align-items: center; }
        .workout-title-btn { cursor: pointer; border: 1px solid transparent; padding: 5px 10px; border-radius: 6px; margin-left: -10px; transition: 0.2s; display: flex; align-items: center; gap: 8px; }
        .workout-title-btn:hover { border-color: var(--accent-gold); background: rgba(212, 175, 55, 0.1); }
        
        .protocol-row { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px; border-top: 1px solid #222; padding-top: 15px; }
        .proto-btn { background: #151515; border: 1px solid #333; color: #aaa; padding: 8px 12px; border-radius: 4px; font-size: 0.6rem; font-weight: 800; text-transform: uppercase; cursor: pointer; display: flex; align-items: center; gap: 6px; transition: 0.2s; }
        .proto-btn:hover { border-color: var(--accent-gold); color: #fff; transform: translateY(-2px); }
        .proto-btn.active { background: rgba(46, 204, 113, 0.1); border-color: var(--target-green); color: var(--target-green); }
        .rec-btn { border-color: var(--recovery-purple); color: #ccc; }
        .rec-btn:hover { border-color: #fff; color: var(--recovery-purple); }

        .juice-card { background: linear-gradient(145deg, #0a0a0a, #111111); border: 1px solid #333; border-radius: 12px; padding: 30px; position: relative; margin-bottom: 20px; cursor: pointer; transition: 0.3s; opacity: 0.6; }
        .juice-card.active { opacity: 1; border-color: var(--accent-gold); box-shadow: 0 0 20px rgba(212, 175, 55, 0.1); }
        .juice-name { font-size: 1.6rem; font-weight: 800; letter-spacing: 1px; text-transform: uppercase; margin-bottom: 10px; display: flex; align-items: center; justify-content: space-between; }
        .juice-benefit { font-size: 0.8rem; color: #ccc; font-style: italic; margin-bottom: 10px; display: block; border-left: 3px solid; padding-left: 12px; line-height: 1.5; }
        .juice-badge { float: right; border: 1px solid; padding: 4px 8px; border-radius: 4px; font-size: 0.6rem; font-weight: 800; text-transform: uppercase; margin-bottom: 10px; display: inline-block; }
        .juice-macro-row { font-size: 0.7rem; color: var(--accent-gold); font-weight: 700; margin-top: 15px; letter-spacing: 1px; }

        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); overflow-y: auto; padding-top: 20px; }
        .modal-content { background: #050505; margin: 0 auto; padding: 35px; border: 1px solid #333; width: 92%; max-width: 750px; border-radius: 12px; }
        
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .stat-box { background: #111; padding: 15px; border-radius: 6px; border: 1px solid #222; text-align: center; }
        .stat-val { font-size: 1.1rem; color: #fff; font-weight: 800; }
        .stat-lbl { font-size: 0.55rem; color: #666; text-transform: uppercase; margin-top: 5px; font-weight: 700; }
        
        /* 3-BAR LAYOUT */
        .prog-section { margin-bottom: 30px; }
        .prog-title { font-size: 0.7rem; color: #888; text-transform: uppercase; font-weight: 700; margin-bottom: 10px; display: flex; justify-content: space-between; }
        .prog-bar-row { display: flex; align-items: center; margin-bottom: 8px; }
        .prog-label { font-size: 0.55rem; font-weight: 800; width: 60px; letter-spacing: 0.5px; } /* Wider to fit words */
        .prog-track { flex: 1; height: 8px; background: #151515; border-radius: 4px; overflow: hidden; border: 1px solid #222; margin: 0 10px; }
        .prog-fill { height: 100%; }
        .prog-val { font-size: 0.7rem; font-weight: 800; width: 60px; text-align: right; }

        .rec-section { margin-bottom: 25px; padding-bottom: 20px; border-bottom: 1px solid #222; }
        .rec-header { font-size: 0.8rem; font-weight: 800; text-transform: uppercase; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .rec-header.warmup { color: var(--heat-red); }
        .rec-header.gym { color: var(--ice-blue); }
        .rec-header.home { color: var(--recovery-purple); }
        .rec-item { background: #111; padding: 15px; border-radius: 8px; margin-bottom: 10px; border: 1px solid #222; }
        .rec-tool { color: #fff; font-weight: 700; font-size: 0.9rem; margin-bottom: 4px; }
        .rec-detail { color: #888; font-size: 0.8rem; }
        
        .shake-option { background: #111; border: 1px solid #333; padding: 20px; border-radius: 8px; margin-bottom: 10px; cursor: pointer; transition: 0.2s; display: flex; justify-content: space-between; align-items: center; }
        .shake-option:hover { border-color: var(--accent-gold); background: #1a1a1a; }
        .shake-name { font-weight: 800; color: #fff; font-size: 0.9rem; }
        .shake-macros { font-size: 0.75rem; color: #888; margin-top: 5px; }
        
        .snack-slot { border: 1px dashed #333; padding: 10px; border-radius: 6px; margin-bottom: 8px; cursor: pointer; color: #888; font-size: 0.8rem; display: flex; justify-content: space-between; align-items: center; }
        .snack-slot:hover { border-color: var(--accent-gold); color: #fff; }
        .snack-slot.filled { border-style: solid; border-color: var(--accent-silver); color: #fff; background: #151515; }
        .snack-remove { color: #666; font-size: 1.2rem; padding: 0 10px; }
        .snack-remove:hover { color: #e74c3c; }

        .hist-table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 0.75rem; color: #ccc; }
        .hist-table th { text-align: left; border-bottom: 1px solid #333; padding: 8px; color: var(--accent-gold); font-size: 0.65rem; text-transform: uppercase; }
        .hist-table td { border-bottom: 1px solid #222; padding: 12px 8px; }
        .hist-table tr:last-child td { border-bottom: none; }
        
        .chef-steps { counter-reset: step; }
        .chef-steps p { margin-bottom: 20px; line-height: 1.5; color: #ddd; position: relative; padding-left: 30px; }
        .chef-steps p strong { color: #fff; }
        .chef-steps p::before { counter-increment: step; content: counter(step) "."; position: absolute; left: 0; color: var(--accent-gold); font-weight: 800; }
        
        .scan-alert { text-align: center; color: var(--heat-red); font-size: 0.7rem; font-weight: 800; margin-top: 10px; text-transform: uppercase; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 0.7; } 50% { opacity: 1; } 100% { opacity: 0.7; } }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="version-tag">VER 209.0</div>
        <h1>THE CENTURION</h1>
        <div class="profile-badges">
            <div id="badgeJ" class="badge active-user" onclick="switchUser('J')">üßîüèæ‚Äç‚ôÇÔ∏è JERMAINE</div>
            <div id="badgeS" class="badge" onclick="switchUser('S')">üë©üèæ‚Äçü¶± SOPHIA</div>
        </div>
    </header>
    <div id="dateRangeDisplay" class="status-bar">...</div>
    <div class="controls">
        <button class="nav-btn" onclick="changeWeek(-1)">PREV WEEK</button>
        <button class="nav-btn" onclick="resetToCurrent()">TODAY</button>
        <button class="nav-btn" onclick="changeWeek(1)">NEXT WEEK</button>
        <button class="nav-btn grocery-btn" onclick="generateGroceryList()">GROCERIES</button>
    </div>
    <div id="dayTabs" class="tabs"></div>
    <div id="dayContent"></div>
</div>

<div id="jermaineModal" class="modal">
    <div class="modal-content">
        <span onclick="closeModal('jermaineModal')" style="float:right; cursor:pointer; font-size:24px;">&times;</span>
        <h2 style="color:var(--accent-gold);">üßîüèæ‚Äç‚ôÇÔ∏è JERMAINE: CLINICAL DATA</h2>
        <div class="stat-grid">
            <div class="stat-box"><div class="stat-val">217.1</div><div class="stat-lbl">Weight (lbs)</div></div>
            <div class="stat-box"><div class="stat-val">98.8</div><div class="stat-lbl">Muscle Mass (lbs)</div></div>
            <div class="stat-box"><div class="stat-val">20.7%</div><div class="stat-lbl">Body Fat %</div></div>
            <div class="stat-box"><div class="stat-val">1996</div><div class="stat-lbl">BMR (kcal)</div></div>
        </div>
        
        <div style="color:var(--target-green); font-size:0.8rem; font-weight:800; text-transform:uppercase; margin-bottom:25px; text-align:center; letter-spacing:2px;">NEXT 30 DAYS: FEB 24 TARGET</div>
        
        <div class="prog-section">
            <div class="prog-title"><span>Body Fat %</span><span style="color:var(--target-green)">Target: 19.2%</span></div>
            <div class="prog-bar-row"><div class="prog-label" style="color:#777">START</div><div class="prog-track"><div class="prog-fill" style="width:17.9%; background:#555"></div></div><div class="prog-val" style="color:#777">17.9%</div></div>
            <div class="prog-bar-row"><div class="prog-label" style="color:#fff">NOW</div><div class="prog-track"><div class="prog-fill" style="width:20.7%; background:var(--accent-gold)"></div></div><div class="prog-val" style="color:#fff">20.7%</div></div>
            <div class="prog-bar-row"><div class="prog-label" style="color:var(--target-green)">GOAL</div><div class="prog-track"><div class="prog-fill" style="width:19.2%; background:var(--target-green)"></div></div><div class="prog-val" style="color:var(--target-green)">19.2%</div></div>
        </div>
        <div class="prog-section">
            <div class="prog-title"><span>Muscle Mass</span><span style="color:var(--target-green)">Target: 99.8 lbs</span></div>
            <div class="prog-bar-row"><div class="prog-label" style="color:#777">START</div><div class="prog-track"><div class="prog-fill" style="width:90.4%; background:#555"></div></div><div class="prog-val" style="color:#777">99.4</div></div>
            <div class="prog-bar-row"><div class="prog-label" style="color:#fff">NOW</div><div class="prog-track"><div class="prog-fill" style="width:89.8%; background:var(--accent-gold)"></div></div><div class="prog-val" style="color:#fff">98.8</div></div>
            <div class="prog-bar-row"><div class="prog-label" style="color:var(--target-green)">GOAL</div><div class="prog-track"><div class="prog-fill" style="width:91.8%; background:var(--target-green)"></div></div><div class="prog-val" style="color:var(--target-green)">99.8</div></div>
        </div>
        
        <div class="scan-alert">‚ö†Ô∏è NEXT SCAN DUE: IN 30 DAYS</div>
            
        <h3 style="color:#888; font-size:0.75rem; text-transform:uppercase; margin-top:30px; border-bottom:1px solid #333; padding-bottom:10px;">SCAN HISTORY</h3>
        <table class="hist-table">
            <thead><tr><th>Date</th><th>Weight</th><th>Muscle</th><th>Body Fat</th><th>Visceral</th></tr></thead>
            <tbody id="jHistBody"></tbody>
        </table>
    </div>
</div>

<div id="sophiaModal" class="modal">
    <div class="modal-content">
        <span onclick="closeModal('sophiaModal')" style="float:right; cursor:pointer; font-size:24px;">&times;</span>
        <h2 style="color:var(--glute-pink);">üë©üèæ‚Äçü¶± SOPHIA: CLINICAL DATA</h2>
        <div class="stat-grid">
            <div class="stat-box"><div class="stat-val">141.5</div><div class="stat-lbl">Weight (lbs)</div></div>
            <div class="stat-box"><div class="stat-val">49.2</div><div class="stat-lbl">Muscle Mass (lbs)</div></div>
            <div class="stat-box"><div class="stat-val">36.1%</div><div class="stat-lbl">Body Fat %</div></div>
            <div class="stat-box"><div class="stat-val">1332</div><div class="stat-lbl">BMR (kcal)</div></div>
        </div>
        
        <div style="color:var(--target-green); font-size:0.8rem; font-weight:800; text-transform:uppercase; margin-bottom:25px; text-align:center; letter-spacing:2px;">NEXT 30 DAYS: FEB 24 TARGET</div>
        <div class="prog-section">
            <div class="prog-title"><span>Body Fat %</span><span style="color:var(--target-green)">Target: 34.6%</span></div>
            <div class="prog-bar-row"><div class="prog-label" style="color:#777">START</div><div class="prog-track"><div class="prog-fill" style="width:33.0%; background:#555"></div></div><div class="prog-val" style="color:#777">33.0%</div></div>
            <div class="prog-bar-row"><div class="prog-label" style="color:#fff">NOW</div><div class="prog-track"><div class="prog-fill" style="width:36.1%; background:var(--glute-pink)"></div></div><div class="prog-val" style="color:#fff">36.1%</div></div>
            <div class="prog-bar-row"><div class="prog-label" style="color:var(--target-green)">GOAL</div><div class="prog-track"><div class="prog-fill" style="width:34.6%; background:var(--target-green)"></div></div><div class="prog-val" style="color:var(--target-green)">34.6%</div></div>
        </div>
        <div class="prog-section">
            <div class="prog-title"><span>Muscle Mass</span><span style="color:var(--target-green)">Target: 49.8 lbs</span></div>
            <div class="prog-bar-row"><div class="prog-label" style="color:#777">START</div><div class="prog-track"><div class="prog-fill" style="width:90.9%; background:#555"></div></div><div class="prog-val" style="color:#777">50.0</div></div>
            <div class="prog-bar-row"><div class="prog-label" style="color:#fff">NOW</div><div class="prog-track"><div class="prog-fill" style="width:89.4%; background:var(--glute-pink)"></div></div><div class="prog-val" style="color:#fff">49.2</div></div>
            <div class="prog-bar-row"><div class="prog-label" style="color:var(--target-green)">GOAL</div><div class="prog-track"><div class="prog-fill" style="width:90.5%; background:var(--target-green)"></div></div><div class="prog-val" style="color:var(--target-green)">49.8</div></div>
        </div>

        <div class="scan-alert">‚ö†Ô∏è NEXT SCAN DUE: IN 30 DAYS</div>

        <h3 style="color:#888; font-size:0.75rem; text-transform:uppercase; margin-top:30px; border-bottom:1px solid #333; padding-bottom:10px;">SCAN HISTORY</h3>
        <table class="hist-table">
            <thead><tr><th>Date</th><th>Weight</th><th>Muscle</th><th>Body Fat</th><th>Visceral</th></tr></thead>
            <tbody id="sHistBody"></tbody>
        </table>
    </div>
</div>

<div id="recipeModal" class="modal"><div class="modal-content"><span onclick="closeModal('recipeModal')" style="float:right; cursor:pointer;">&times;</span><h2 id="modalTitle" style="color:#fff; margin-bottom:5px;"></h2><div style="color:var(--accent-gold); font-size:0.75rem; font-weight:800; margin:15px 0 5px 0;">INGREDIENTS</div><ul id="modalIng" style="list-style:none; padding:0; margin-bottom:25px; color:#ccc; font-size:0.9rem;"></ul><div style="color:var(--accent-gold); font-size:0.75rem; font-weight:800; margin-bottom:12px;">CHEF PREPARATION</div><div id="modalSteps" class="chef-steps" style="counter-reset: step;"></div><div id="modBox" style="background:rgba(214, 51, 132, 0.1); border:1px solid var(--glute-pink); padding:15px; border-radius:6px; margin-top:20px;"><div style="color:var(--glute-pink); font-size:0.8rem; font-weight:800; text-transform:uppercase;">üçë Sophia's Mod</div><div id="modalMod" style="color:#e5e4e2; font-size:0.85rem;"></div></div></div></div>

<div id="juiceModal" class="modal"><div class="modal-content">
    <span onclick="closeModal('juiceModal')" style="float:right; cursor:pointer;">&times;</span>
    <h2 id="jTitle" style="color:var(--accent-gold);"></h2>
    <div id="jMacros" style="color:#888; font-size:0.8rem; margin-bottom:20px; font-weight:700;"></div>
    <div id="jPrep" class="chef-steps" style="counter-reset: step;"></div>
</div></div>

<div id="protocolModal" class="modal"><div class="modal-content"><span onclick="closeModal('protocolModal')" style="float:right; cursor:pointer;">&times;</span><h2 id="protoTitle" style="color:var(--accent-gold);"></h2><div id="protoBody" style="font-size:0.95rem; color:#ccc; line-height:1.7;"></div></div></div>
<div id="groceryModal" class="modal"><div class="modal-content"><span onclick="closeModal('groceryModal')" style="float:right; cursor:pointer;">&times;</span><h2 style="color:var(--target-green); margin-bottom:20px;">üõí WEEKLY SHOPPING LIST</h2><div id="groceryList" style="color:#ccc; line-height:1.6; font-size:0.9rem;"></div></div></div>
<div id="recoveryModal" class="modal"><div class="modal-content"><span onclick="closeModal('recoveryModal')" style="float:right; cursor:pointer;">&times;</span><h2 id="recTitle" style="color:#fff; margin-bottom:5px;"></h2><p style="color:#888; font-size:0.8rem; margin-bottom:25px; font-style:italic;">Daily Recovery Protocol</p><div class="rec-section"><div class="rec-header warmup">üî• PRE-WORKOUT (HOME/CAR)</div><div id="recWarmup"></div></div><div class="rec-section"><div class="rec-header gym">üíß GYM AMENITIES (IN-SHAPE)</div><div id="recGym"></div></div><div class="rec-section" style="border-bottom:none;"><div class="rec-header home">üè† HOME RESTORATION</div><div id="recHome"></div></div></div></div>
<div id="snackModal" class="modal"><div class="modal-content"><span onclick="closeModal('snackModal')" style="float:right; cursor:pointer;">&times;</span><h2 style="color:var(--accent-gold); margin-bottom:20px;">SELECT SNACK ITEM</h2><div id="snackOptionsList"></div></div></div>

<script>
    let currentUser = 'J'; 
    let dayState = {}; 
    let selectedDateStr = "";
    let currentSnackSlot = 1;

    // --- CLINICAL HISTORY DATA ---
    const jermaineHistory = [
        { date: "Jan 24, 2025", w: "217.1", m: "98.8", bf: "20.7%", v: "10" },
        { date: "Oct 30, 2024", w: "210.8", m: "99.4", bf: "17.9%", v: "-" }
    ];
    const sophiaHistory = [
        { date: "Jan 24, 2025", w: "141.5", m: "49.2", bf: "36.1%", v: "9" },
        { date: "Oct 30, 2024", w: "136.1", m: "50.0", bf: "33.0%", v: "-" }
    ];

    function renderHistory() {
        const jBody = document.getElementById('jHistBody');
        jBody.innerHTML = jermaineHistory.map(h => `<tr><td>${h.date}</td><td>${h.w}</td><td>${h.m}</td><td>${h.bf}</td><td>${h.v}</td></tr>`).join('');
        
        const sBody = document.getElementById('sHistBody');
        sBody.innerHTML = sophiaHistory.map(h => `<tr><td>${h.date}</td><td>${h.w}</td><td>${h.m}</td><td>${h.bf}</td><td>${h.v}</td></tr>`).join('');
    }

    const macroTargets = {
        'J': { 'HIGH CARB': { p: 160, c: 300, f: 75, k: 2500 }, 'LOW CARB': { p: 160, c: 80, f: 100, k: 1860 } },
        'S': { 'HIGH CARB': { p: 105, c: 180, f: 55, k: 1635 }, 'LOW CARB': { p: 105, c: 50, f: 70, k: 1250 } }
    };

    const snackDB = {
        "Pea Protein ISO": { p: 25, c: 2, f: 2, k: 120 },
        "Peanut Protein": { p: 8, c: 5, f: 2, k: 70 },
        "Centurion Blend (Pea+Peanut)": { p: 33, c: 7, f: 4, k: 190 },
        "Double Scoop Pea": { p: 50, c: 4, f: 4, k: 240 },
        "Kirkland Mixed Nuts (1.5oz)": { p: 9, c: 8, f: 23, k: 260 },
        "Hummus & Carrots": { p: 6, c: 20, f: 10, k: 180 },
        "Beef Jerky (1oz)": { p: 12, c: 3, f: 1, k: 80 },
        "Hard Boiled Eggs (2)": { p: 12, c: 1, f: 10, k: 140 },
        "Edamame (1 cup)": { p: 17, c: 15, f: 8, k: 188 },
        "Greek Yogurt (1 cup)": { p: 20, c: 8, f: 0, k: 120 },
        "Tuna Packet (StarKist)": { p: 17, c: 0, f: 1, k: 80 },
        "Apple & Almond Butter": { p: 4, c: 22, f: 12, k: 200 },
        "Cottage Cheese & Pineapple": { p: 14, c: 18, f: 2, k: 140 },
        "REMOVE": { p: 0, c: 0, f: 0, k: 0 }
    };

    const juiceData = {
        "TITAN RED": { color: "#E74C3C", icon: "ü¶Ö", badge: "‚ö° NITRIC BOOST", text: "Beet nitrates maximize oxygen delivery.", prep: ["2 Beets", "2 Carrots", "1 Pomegranate", "1 Orange"], macros: {p: 2, c: 25, f: 0, k: 110} },
        "ZENITH GREEN": { color: "#2ECC71", icon: "ü¶â", badge: "üåø ALKALIZER", text: "Cilantro & Dandelion flush cortisol.", prep: ["4 Kale", "1c Wheatgrass", "1 Cucumber", "1/2c Cilantro"], macros: {p: 2, c: 15, f: 0, k: 70} },
        "PLASMA FLUSH": { color: "#FF6B81", icon: "ü¶©", badge: "‚ö° NITRO PUMP", text: "L-Citrulline reduces lifting fatigue.", prep: ["3c Watermelon", "1 Lime", "Pinch Salt"], macros: {p: 1, c: 28, f: 0, k: 120} },
        "APOLLO GOLD": { color: "#F1C40F", icon: "ü¶Å", badge: "üõ°Ô∏è JOINT GUARD", text: "Turmeric & Ginger reduce inflammation.", prep: ["2 Pears", "2in Ginger", "1in Turmeric", "Black Pepper"], macros: {p: 1, c: 30, f: 0, k: 130} }
    };

    const protocolData = { 
        "Sea Moss": { text: "92 minerals + Iodine.", macros: {p:0, c:1, f:0, k:5} },
        "Mg Electrolytes": { text: "CNS recovery.", macros: {p:0, c:0, f:0, k:0} },
        "Kombucha": { text: "Gut lining.", macros: {p:0, c:12, f:0, k:60} } 
    };

    const recipeDB = {
        "Bison Steak & Eggs": { ing: ["6oz Bison Sirloin", "2 Eggs", "Tomato", "Salt/Pepper", "**Asparagus**", "**Bell Peppers**"], steps: ["Remove bison from fridge 20 mins prior to cooking.", "Heat a cast-iron skillet over **High Heat**.", "Season bison heavily with salt and pepper.", "Sear steak for **3 minutes per side** for medium-rare.", "Remove steak and let rest for 5 minutes.", "In the same skillet, lower heat to **Medium**. Add asparagus and bell peppers.", "Saut√© vegetables for **5-7 minutes** until tender-crisp.", "Push veggies to the side, crack eggs into the pan.", "Fry eggs for **2-3 minutes** until whites are set but yolks runny."], mod: "Sophia: 3oz bison.", macros: { J:{p:65,c:5,f:28,k:530}, S:{p:35,c:5,f:18,k:320} } },
        "Crab Scramble": { ing: ["4oz Crab", "3 Egg Whites", "Chives", "Ghee", "**Spinach**", "**Tomato**"], steps: ["Whisk egg whites vigorously in a bowl until frothy.", "Heat non-stick pan over **Low Heat**. Add 1 tsp Ghee.", "Add spinach and diced tomato. Saut√© for **2 minutes** until wilted.", "Pour in egg whites. Use spatula to push edges to center.", "When eggs are 80% done (about **2 minutes**), fold in crab meat.", "Sprinkle with fresh chives and remove from heat immediately."], mod: "Sophia: 3oz crab.", macros: { J:{p:45,c:3,f:5,k:238}, S:{p:30,c:3,f:3,k:158} } },
        "Japanese Tamagoyaki": { ing: ["4 Eggs", "Dashi", "Coconut Aminos", "Oil", "**Scallions**", "**Zucchini**"], steps: ["Whisk eggs, 1 tbsp dashi, and 1 tsp aminos in a bowl. Mix in finely chopped scallions.", "Heat rectangular pan over **Medium Heat**. Brush with oil.", "Saut√© finely diced zucchini for **2 mins** then set aside.", "Pour a thin layer of egg mixture. Sprinkle zucchini. Cook **60 seconds**.", "Roll the egg to one side of the pan.", "Pour next layer, lift the roll to let egg flow under.", "Repeat until all egg is used (approx **5-6 layers**)."], mod: "Sophia: 1.5 palms.", macros: { J:{p:28,c:6,f:20,k:318}, S:{p:18,c:4,f:12,k:196} } },
        "Sea Moss Smoothie": { ing: ["2tbsp Sea Moss", "Spinach", "Berries", "Protein Powder", "**Cucumber**"], steps: ["Add spinach, cucumber, and water/almond milk to blender first.", "Blend greens on **High** until liquid.", "Add frozen berries, sea moss gel, and protein powder.", "Blend on **High** for **45-60 seconds** until completely smooth."], mod: "Add 1 scoop collagen.", macros: { J:{p:25,c:38,f:5,k:295}, S:{p:25,c:32,f:5,k:275} } },
        "Southwest Bison Scramble": { ing: ["4oz Bison", "3 Egg Whites", "Poblanos", "Cumin", "**Onions**", "**Kale**"], steps: ["Heat pan over **Medium-High Heat**.", "Saut√© diced poblanos and onions for **4 minutes** until caramelized.", "Add ground bison and cumin. Cook until browned (**4-5 mins**).", "Toss in kale and cook for **1 min** until wilted.", "Lower heat to **Low**. Pour in egg whites.", "Scramble gently for **2 minutes** until fluffy."], mod: "Sophia: 3oz bison.", macros: { J:{p:48,c:8,f:12,k:332}, S:{p:32,c:6,f:8,k:224} } },
        "Protein Berry Bowl": { ing: ["1 scoop Whey", "Frozen Berries", "Chia Seeds", "Almond Milk", "**Cauliflower Rice (Frozen)**"], steps: ["Place frozen berries, frozen cauliflower rice (adds bulk/fiber, no taste), and protein powder in a bowl.", "Pour small amount of almond milk over top.", "Mash with a spoon until it forms a 'sorbet' texture.", "Top with chia seeds. No cooking required."], mod: "Sophia: 1.5 palms.", macros: { J:{p:35,c:28,f:10,k:342}, S:{p:25,c:22,f:8,k:260} } },
        "Chicken Apple Sausage Scramble": { ing: ["1 Chicken Sausage", "3 Eggs", "Apple", "Sage", "**Mushrooms**", "**Spinach**"], steps: ["Slice sausage into coins. Dice apple and mushrooms.", "Heat pan over **Medium Heat**.", "Saut√© sausage, mushrooms, and apple for **5 minutes** until golden.", "Add spinach and cook until wilted.", "Crack eggs directly into pan. Scramble vigorously.", "Cook for **2 minutes** until eggs are set."], mod: "Sophia: 1/2 sausage.", macros: { J:{p:38,c:14,f:22,k:406}, S:{p:25,c:10,f:15,k:275} } },
        "Bison & Poached Eggs": { ing: ["6oz Bison Patty", "2 Poached Eggs", "**Asparagus**"], steps: ["Grill patty. Steam asparagus."], mod: "Sophia: 3oz patty.", macros: { J:{p:62,c:4,f:30,k:534}, S:{p:35,c:3,f:20,k:332} } },
        "Omelet Du Fromage": { ing: ["3 Eggs", "Goat Cheese", "Chives", "**Arugula**"], steps: ["French fold omelet. Serve with side salad."], mod: "Sophia: 2 eggs.", macros: { J:{p:26,c:2,f:24,k:328}, S:{p:18,c:1,f:16,k:220} } },
        "Smoked Salmon Scramble": { ing: ["4oz Smoked Salmon", "3 Eggs", "Dill", "**Cucumber**"], steps: ["Fold salmon into eggs. Serve with sliced cucumber."], mod: "Sophia: 3oz salmon.", macros: { J:{p:40,c:3,f:22,k:370}, S:{p:28,c:2,f:15,k:255} } },
        "Hard Boiled Scotch Egg": { ing: ["4oz Bison", "1 Boiled Egg", "**Mixed Greens**"], steps: ["Wrap egg in bison. Serve on greens."], mod: "Sophia: 1/2 portion.", macros: { J:{p:45,c:5,f:20,k:380}, S:{p:22,c:3,f:10,k:190} } },
        "Green Omelet": { ing: ["3 Eggs", "Spinach", "Kale Pesto", "**Broccoli**"], steps: ["Blend greens in eggs. Saut√© broccoli on side."], mod: "Sophia: 2 eggs.", macros: { J:{p:24,c:6,f:20,k:300}, S:{p:16,c:4,f:14,k:206} } },
        "Chia Pudding": { ing: ["1/4c Chia", "Almond Milk", "Protein", "**Zucchini (Grated)**"], steps: ["Soak overnight. Mix in grated zucchini for volume."], mod: "Sophia: 1.5 palms.", macros: { J:{p:30,c:22,f:18,k:370}, S:{p:20,c:16,f:12,k:252} } },
        "Egg White Frittata": { ing: ["1c Egg Whites", "Bison Sausage", "**Peppers**", "**Onion**"], steps: ["Bake 350F with veggies."], mod: "Sophia: 1 slice.", macros: { J:{p:40,c:8,f:10,k:282}, S:{p:25,c:5,f:6,k:174} } },
        "Sea Moss Fruit Bowl": { ing: ["2tbsp Sea Moss", "Mango", "Kiwi", "**Cucumber**"], steps: ["Mix gel with fruit and cucumber slices."], mod: "Add protein side.", macros: { J:{p:5,c:48,f:0,k:212}, S:{p:5,c:32,f:0,k:148} } },
        "Turkey Bacon & Eggs": { ing: ["4 slices Turkey Bacon", "3 Eggs", "**Tomato**", "**Avocado**"], steps: ["Crisp bacon. Serve with sliced tomato/avo."], mod: "Sophia: 2 slices.", macros: { J:{p:35,c:5,f:22,k:358}, S:{p:22,c:3,f:15,k:235} } },
        "Spinach Mushroom Scramble": { ing: ["3 Eggs", "Spinach", "Shiitake", "**Onions**"], steps: ["Saut√© veg. Scramble eggs."], mod: "Sophia: 2 eggs.", macros: { J:{p:22,c:7,f:15,k:251}, S:{p:14,c:4,f:10,k:162} } },
        "Greek Yogurt Parfait": { ing: ["1c Greek Yogurt", "Walnuts", "Honey", "**Cucumber**"], steps: ["Layer ingredients. Cucumber adds crunch."], mod: "Sophia: 1/2 cup.", macros: { J:{p:25,c:27,f:10,k:298}, S:{p:14,c:16,f:6,k:174} } },
        "Bison Breakfast Burrito Bowl": { ing: ["4oz Bison", "Black Beans", "Salsa", "**Lettuce**", "**Peppers**"], steps: ["Brown bison. Serve over lettuce/peppers."], mod: "Sophia: 2oz bison.", macros: { J:{p:45,c:34,f:12,k:424}, S:{p:28,c:22,f:8,k:272} } },
        "Cottage Cheese Bowl": { ing: ["1c Cottage Cheese", "Peaches", "**Cucumber**"], steps: ["Serve chilled with diced cucumber."], mod: "Sophia: 1/2 cup.", macros: { J:{p:28,c:17,f:5,k:225}, S:{p:14,c:11,f:3,k:127} } },
        "Avocado Toast (GF) & Egg": { ing: ["1 slice GF Bread", "1/2 Avocado", "1 Egg", "**Radish**"], steps: ["Toast bread. Top with radish slices."], mod: "Sophia: 1/2 avocado.", macros: { J:{p:12,c:26,f:18,k:314}, S:{p:12,c:26,f:18,k:314} } },
        "Shakshuka (Bison)": { ing: ["4oz Bison", "Tomato Sauce", "2 Eggs", "**Spinach**"], steps: ["Poach eggs in sauce. Add spinach at end."], mod: "Sophia: 2oz bison.", macros: { J:{p:48,c:12,f:20,k:420}, S:{p:28,c:9,f:14,k:274} } },
        "Quinoa Breakfast Bowl": { ing: ["1/2c Quinoa", "Almond Milk", "Berries", "**Zucchini**"], steps: ["Simmer quinoa with grated zucchini."], mod: "Sophia: 1/4 cup.", macros: { J:{p:12,c:47,f:6,k:290}, S:{p:8,c:26,f:4,k:172} } },
        "Steak & Spinach (Leftover)": { ing: ["4oz Steak", "Spinach", "**Mushrooms**"], steps: ["Reheat steak. Saut√© mushrooms."], mod: "Sophia: 2oz steak.", macros: { J:{p:35,c:4,f:15,k:291}, S:{p:18,c:3,f:8,k:156} } },
        "Protein Pancakes": { ing: ["1 Banana", "2 Eggs", "Protein", "**Cauliflower Rice**"], steps: ["Mix cauliflower into batter. Fry."], mod: "Sophia: 2 cakes.", macros: { J:{p:35,c:38,f:10,k:382}, S:{p:25,c:27,f:8,k:280} } },
        "Overnight Oats (GF)": { ing: ["1/2c Oats", "Chia", "Almond Milk", "**Carrot (Grated)**"], steps: ["Soak overnight. Add carrot cake flavor."], mod: "Sophia: 1/4 cup.", macros: { J:{p:10,c:38,f:8,k:264}, S:{p:6,c:20,f:5,k:149} } },
        "Acai Bowl": { ing: ["1 pk Acai", "Spinach", "Protein", "**Cucumber**"], steps: ["Blend frozen with cucumber."], mod: "Sophia: 1/2 bowl.", macros: { J:{p:25,c:42,f:8,k:340}, S:{p:15,c:27,f:5,k:213} } },
        "Breakfast Salad": { 
            ing: ["**Mixed Greens/Arugula**", "2 Boiled Eggs", "**Turkey Bacon (Uncured)**", "**Tomato**", "**Cucumber**"], 
            steps: [
                "Crisp the turkey bacon in a pan or oven (400F for 10 mins).",
                "Chop bacon and boiled eggs.",
                "Toss mixed greens, tomato, and cucumber in a bowl.",
                "Top with egg and bacon. Drizzle with olive oil or lemon."
            ], 
            mod: "Sophia: 1 egg.", 
            macros: { J:{p:20,c:8,f:18,k:274}, S:{p:12,c:5,f:12,k:176} } 
        },
        "Tofu Scramble": { 
            ing: ["1 block Firm Tofu", "Turmeric", "Nutritional Yeast", "**Bell Peppers**", "**Kale**", "**Onion**"], 
            steps: [
                "Press tofu for 10 minutes to remove water.",
                "Saut√© diced onion and peppers in oil for **5 minutes**.",
                "Crumble tofu into the pan. Add turmeric, salt, and nutritional yeast.",
                "Cook for **5-7 minutes** until slightly browned. Stir in kale at the end."
            ], 
            mod: "Sophia: 1/2 block.", 
            macros: { J:{p:28,c:14,f:12,k:276}, S:{p:14,c:8,f:6,k:142} } 
        },
        "Bone Broth & Egg": { ing: ["1c Bone Broth", "1 Egg", "**Spinach**"], steps: ["Drop egg and spinach in broth."], mod: "Sophia: 1 cup.", macros: { J:{p:16,c:2,f:5,k:117}, S:{p:16,c:2,f:5,k:117} } },

        // LUNCHES
        "Sardine Bowl": { 
            ing: ["1 tin Sardines", "1/2 Avocado", "Lemon", "Olive Oil", "**Cucumber**", "**Radish**"], 
            steps: [
                "Drain oil from sardine tin.",
                "In a bowl, mash avocado with lemon juice.",
                "Slice cucumber and radish thinly.",
                "Top avocado with sardines and veggies.",
                "Drizzle with fresh olive oil and cracked pepper. No cooking required."
            ], 
            mod: "Sophia: 1.5 palms.", 
            macros: { J:{p:25,c:8,f:20,k:312}, S:{p:18,c:5,f:15,k:227} } 
        },
        "Bison Laab": { 
            ing: ["6oz Bison", "Lime", "Fish Sauce", "Mint", "Chili", "**Green Beans**", "**Cabbage**"], 
            steps: [
                "Heat wok or skillet over **High Heat**.",
                "Add bison and chopped green beans. Cook until browned (**5-6 mins**).",
                "Remove from heat. Immediately stir in lime juice and fish sauce.",
                "Toss with fresh mint, chili flakes, and shredded cabbage.",
                "Serve in lettuce cups."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:45,c:10,f:12,k:328}, S:{p:22,c:6,f:6,k:166} } 
        },
        "Stealth Liver Sliders": { 
            ing: ["5oz Ground Bison", "1oz Beef Liver (ground)", "Smoked Paprika", "**Portobello Mushrooms (Bun)**", "**Grilled Onions**"], 
            steps: [
                "Mix bison and liver thoroughly. Form into patties.",
                "Season with paprika, salt, and pepper.",
                "Grill or pan-sear for **4 minutes per side** (Medium).",
                "Saut√© mushrooms and onions in the same pan.",
                "Serve patties between mushroom caps."
            ], 
            mod: "Sophia: 1 slider.", 
            macros: { J:{p:48,c:6,f:15,k:351}, S:{p:24,c:3,f:8,k:180} } 
        },
        "Crab Tower": { 
            ing: ["4oz Lump Crab Meat", "Mango", "Cucumber", "**Avocado**", "**Microgreens**"], 
            steps: [
                "Dice mango, cucumber, and avocado into small cubes.",
                "Using a ring mold (or a cut plastic cup), press avocado layer down first.",
                "Add mango layer, then cucumber layer.",
                "Top with crab meat and press gently.",
                "Remove mold and garnish with microgreens and lime."
            ], 
            mod: "Sophia: 3oz crab.", 
            macros: { J:{p:25,c:18,f:5,k:217}, S:{p:18,c:12,f:3,k:147} } 
        },
        "Sriracha Bison Tacos": { 
            ing: ["5oz Bison", "Greek Yogurt", "Sriracha", "**Cabbage Slaw**", "**Radish**", "**Lettuce Cups**"], 
            steps: [
                "Brown bison in a pan over **Medium-High Heat**.",
                "Mix yogurt and sriracha to create a creamy sauce.",
                "Fill lettuce cups with meat.",
                "Top with cabbage slaw and sliced radishes.",
                "Drizzle sauce over tacos."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:42,c:12,f:12,k:324}, S:{p:24,c:8,f:6,k:182} } 
        },
        "Chicken Satay": { 
            ing: ["6oz Chicken Breast", "Peanut Butter (Natural)", "Soy Sauce", "**Snap Peas**", "**Red Peppers**"], 
            steps: [
                "Cut chicken into strips and thread onto skewers.",
                "Mix peanut butter, soy sauce, and lime for dipping.",
                "Grill skewers for **3-4 minutes per side**.",
                "Serve with raw snap peas and pepper strips for crunch."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:50,c:10,f:10,k:330}, S:{p:25,c:6,f:5,k:169} } 
        },
        "Octopus Salad": { 
            ing: ["6oz Boiled Octopus", "Boiled Potato", "Paprika", "Olive Oil", "**Celery**", "**Arugula**"], 
            steps: [
                "Slice pre-cooked octopus into bite-sized rounds.",
                "Dice boiled potato and celery.",
                "Toss all ingredients in a bowl with arugula.",
                "Dress generously with olive oil, paprika, and sea salt."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:40,c:28,f:5,k:317}, S:{p:20,c:17,f:3,k:175} } 
        },
        "Shrimp Ceviche": { 
            ing: ["6oz Shrimp (Raw or Pre-cooked)", "Limes (lots)", "Tomato", "**Cucumber**", "**Jalapeno**", "**Red Onion**"], 
            steps: [
                "If raw: Chop shrimp and soak in lime juice for **30 minutes** until opaque.",
                "If cooked: Chop shrimp.",
                "Mix with diced tomato, cucumber, onion, and jalapeno.",
                "Let sit in fridge for 15 mins for flavors to meld. Serve cold."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:35,c:12,f:3,k:215}, S:{p:18,c:7,f:2,k:118} } 
        },
        "Sardine Cucumber Boats": { 
            ing: ["1 tin Sardines", "Large Cucumbers", "Dill", "Mustard", "**Cherry Tomatoes**"], 
            steps: [
                "Slice cucumbers lengthwise and scoop out the seeds to make 'boats'.",
                "Mash sardines with mustard and dill.",
                "Fill the cucumber hollows with the sardine mix.",
                "Top with halved cherry tomatoes."
            ], 
            mod: "Sophia: 1.5 palms.", 
            macros: { J:{p:25,c:7,f:15,k:263}, S:{p:18,c:4,f:10,k:178} } 
        },
        "Bison Lettuce Cups": { 
            ing: ["6oz Bison", "Water Chestnuts", "Ginger", "Soy Sauce", "**Carrots**", "**Scallions**", "**Butter Lettuce**"], 
            steps: [
                "Heat pan to **High**. Saut√© ginger and bison until browned.",
                "Add chopped water chestnuts and grated carrots. Cook **2 mins**.",
                "Stir in soy sauce/aminos.",
                "Spoon mixture into butter lettuce leaves. Top with scallions."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:45,c:14,f:12,k:344}, S:{p:22,c:8,f:6,k:174} } 
        },
        "Tuna Tartare": { 
            ing: ["6oz Sushi Grade Tuna", "Sesame Oil", "Soy Sauce", "**Avocado**", "**Cucumber**", "**Sesame Seeds**"], 
            steps: [
                "Ensure tuna is very cold (easier to cut). Dice into small cubes.",
                "Dice avocado and cucumber to same size.",
                "Gently toss tuna with sesame oil and soy sauce.",
                "Fold in avocado/cucumber. Sprinkle with seeds. Serve immediately."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:42,c:6,f:14,k:318}, S:{p:21,c:4,f:7,k:163} } 
        },
        "Salmon Salad": { 
            ing: ["6oz Canned Salmon", "Celery", "Mayo (Avocado Oil)", "**Pickles**", "**Mixed Greens**", "**Red Onion**"], 
            steps: [
                "Drain salmon. Flake into a bowl.",
                "Mix with diced celery, pickles, onion, and mayo.",
                "Season with dill or black pepper.",
                "Serve scoop over a large bed of mixed greens."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:38,c:5,f:18,k:334}, S:{p:19,c:3,f:10,k:178} } 
        },
        "Ostrich Carpaccio": { 
            ing: ["4oz Ostrich Fillet", "Capers", "Olive Oil", "Lemon", "**Arugula**", "**Parmesan Shavings**"], 
            steps: [
                "Slice raw ostrich as thin as possible (freeze for 20 mins prior helps).",
                "Lay slices flat on a plate.",
                "Top with a handful of arugula.",
                "Drizzle with oil and lemon. Scatter capers and cheese."
            ], 
            mod: "Sophia: 2oz.", 
            macros: { J:{p:28,c:3,f:10,k:214}, S:{p:14,c:2,f:5,k:109} } 
        },
        "Bison Kofta": { 
            ing: ["6oz Bison", "Cumin", "Coriander", "Cinnamon", "**Zucchini**", "**Red Peppers**"], 
            steps: [
                "Mix bison with spices. Form into sausage shapes around skewers.",
                "Heat grill or grill pan to **Medium-High**.",
                "Grill koftas for **3-4 minutes per side**.",
                "Grill zucchini and pepper slices alongside meat."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:45,c:9,f:15,k:351}, S:{p:22,c:5,f:8,k:180} } 
        },
        "Crab & Avocado Salad": { 
            ing: ["4oz Crab", "Avocado", "Grapefruit Segments", "**Fennel**", "**Spinach**"], 
            steps: [
                "Slice fennel bulb very thinly.",
                "Combine spinach, fennel, and grapefruit in a bowl.",
                "Top with crab meat and avocado slices.",
                "Dress with grapefruit juice and olive oil."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:25,c:16,f:15,k:299}, S:{p:18,c:10,f:10,k:202} } 
        },
        "Spicy Sardine Wrap": { 
            ing: ["1 tin Sardines", "Large Collard Green Leaves", "**Kimchi**", "**Carrots**"], 
            steps: [
                "Blanch collard leaf for 30 seconds to soften (optional). Remove thick stem.",
                "Place sardines in center.",
                "Top with spicy kimchi and shredded carrots.",
                "Roll tight like a burrito."
            ], 
            mod: "Sophia: 1.5 palms.", 
            macros: { J:{p:25,c:6,f:15,k:259}, S:{p:18,c:3,f:10,k:174} } 
        },
        "Bison Burger": { 
            ing: ["6oz Bison", "Mustard", "**Iceberg Lettuce**", "**Tomato**", "**Pickles**", "**Onion**"], 
            steps: [
                "Form bison into a patty. Salt exterior.",
                "Grill or pan sear on **High Heat** for **3-4 minutes per side**.",
                "Use large iceberg leaves as the 'bun'.",
                "Assemble with tomato, onion, pickles, and mustard."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:45,c:5,f:20,k:380}, S:{p:22,c:3,f:10,k:190} } 
        },
        "Chicken Waldorf Salad": { 
            ing: ["6oz Cooked Chicken", "Apple", "Walnuts", "Yogurt Dressing", "**Celery**", "**Grapes**", "**Mixed Greens**"], 
            steps: [
                "Cube the cooked chicken.",
                "Chop apple, celery, and halve the grapes.",
                "Toss chicken, fruit, nuts, and celery with yogurt.",
                "Serve over a bed of mixed greens."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:48,c:18,f:15,k:399}, S:{p:24,c:12,f:8,k:216} } 
        },
        "Shrimp Summer Rolls": { 
            ing: ["6 Cooked Shrimp", "Rice Paper Wrappers", "Mint/Basil", "**Cucumber**", "**Carrot**", "**Lettuce**"], 
            steps: [
                "Dip rice paper in warm water for 5 seconds.",
                "Lay flat. Place shrimp, herbs, and julienned veggies in center.",
                "Fold sides in and roll tight.",
                "Repeat for all rolls. Serve cold."
            ], 
            mod: "Sophia: 3 rolls.", 
            macros: { J:{p:30,c:34,f:2,k:274}, S:{p:15,c:17,f:1,k:137} } 
        },
        "Cod Fish Tacos": { 
            ing: ["6oz Cod", "Cabbage Slaw", "Lime", "**Radish**", "**Avocado**", "**Corn Tortillas (or Lettuce)**"], 
            steps: [
                "Season cod with cumin and chili powder.",
                "Sear in pan over **Medium-High** for **3 minutes per side**.",
                "Flake fish into tortillas (or lettuce cups).",
                "Top with crunchy slaw, radish, and avocado."
            ], 
            mod: "Sophia: 1 taco.", 
            macros: { J:{p:35,c:28,f:10,k:342}, S:{p:18,c:17,f:6,k:194} } 
        },
        "Seared Ahi Salad": { 
            ing: ["6oz Ahi Tuna Block", "Sesame Seeds", "**Mixed Greens**", "**Edamame**", "**Cucumber**", "**Radish**"], 
            steps: [
                "Coat tuna block in sesame seeds.",
                "Sear in very hot pan for **45 seconds per side** (keep center raw).",
                "Slice thinly.",
                "Arrange over greens, edamame, and cucumber."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:42,c:9,f:8,k:276}, S:{p:21,c:5,f:4,k:140} } 
        },
        "Turkey Meatballs": { 
            ing: ["6oz Ground Turkey", "Spinach", "Marinara", "**Zucchini Noodles (Zoodles)**", "**Garlic**"], 
            steps: [
                "Mix turkey, chopped spinach, and garlic. Form balls.",
                "Bake at **400¬∞F** for **15-18 minutes**.",
                "Meanwhile, saut√© zoodles for **2 minutes** (do not overcook).",
                "Top zoodles with meatballs and marinara."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:35,c:12,f:10,k:278}, S:{p:18,c:6,f:5,k:141} } 
        },
        "Grilled Chicken Caesar": { 
            ing: ["6oz Chicken Breast", "Romaine Hearts", "Parmesan", "**Cherry Tomatoes**", "**Cucumber**"], 
            steps: [
                "Grill chicken breast until cooked through.",
                "Chop romaine hearts.",
                "Toss lettuce with caesar dressing, tomatoes, and cucumber.",
                "Slice warm chicken over the cold salad."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:50,c:8,f:15,k:367}, S:{p:25,c:5,f:8,k:192} } 
        },
        "Beef Carpaccio": { 
            ing: ["4oz Beef Tenderloin", "Arugula", "Parmesan Shavings", "Lemon", "**Capers**", "**Shallots**"], 
            steps: [
                "Slice raw beef paper-thin.",
                "Arrange on chilled plate.",
                "Pile arugula in center. Top with capers, shallots, and cheese.",
                "Drizzle everything with olive oil and lemon."
            ], 
            mod: "Sophia: 2oz.", 
            macros: { J:{p:28,c:3,f:12,k:232}, S:{p:14,c:2,f:6,k:118} } 
        },
        "Poke Bowl": { 
            ing: ["4oz Tuna", "Cauli Rice", "Edamame", "**Seaweed Salad**", "**Cucumber**", "**Carrot**"], 
            steps: [
                "Use sushi-grade tuna, cubed.",
                "Place cauliflower rice as base.",
                "Arrange toppings (edamame, seaweed, cucumber) around the fish.",
                "Drizzle with soy/ginger sauce."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:35,c:18,f:10,k:302}, S:{p:22,c:12,f:6,k:190} } 
        },
        "Lobster Roll": { 
            ing: ["4oz Lobster Meat", "Celery", "Mayo", "Chives", "**Butter Lettuce Leaves**", "**Lemon**"], 
            steps: [
                "Chop cooked lobster meat into chunks.",
                "Mix gently with mayo, diced celery, lemon juice, and chives.",
                "Season with salt and paprika.",
                "Spoon mixture into large butter lettuce leaves (instead of bread)."
            ], 
            mod: "Sophia: 2oz.", 
            macros: { J:{p:22,c:28,f:15,k:335}, S:{p:11,c:17,f:8,k:184} } 
        },
        "Thai Beef Salad": { 
            ing: ["4oz Steak", "Lime", "Chili", "Mint/Cilantro", "**Mixed Greens**", "**Cucumber**", "**Red Onion**"], 
            steps: [
                "Grill steak to medium-rare. Let rest, then slice thin.",
                "In a large bowl, combine mixed greens, cucumber, and onion.",
                "Make dressing: Lime juice, fish sauce, chili, pinch of stevia.",
                "Toss beef and salad with dressing. Garnish with mint."
            ], 
            mod: "Sophia: 2oz.", 
            macros: { J:{p:30,c:12,f:12,k:276}, S:{p:15,c:7,f:6,k:142} } 
        },
        "Smoked Mackerel Pate": { 
            ing: ["4oz Smoked Mackerel", "Cream Cheese/Yogurt Mix", "Lemon", "**Cucumber Slices**", "**Radish**", "**Dill**"], 
            steps: [
                "Remove skin from mackerel.",
                "In a bowl/blender, mix fish with cream cheese (or greek yogurt), lemon, and dill.",
                "Mash until smooth.",
                "Slice cucumber and radish into rounds.",
                "Spread pate onto veggie slices."
            ], 
            mod: "Sophia: 2oz.", 
            macros: { J:{p:25,c:5,f:25,k:345}, S:{p:12,c:3,f:15,k:195} } 
        },
        "Gazpacho w/ Shrimp": { 
            ing: ["Tomato Base", "4 Cooked Shrimp", "**Bell Peppers**", "**Cucumber**", "**Onion**"], 
            steps: [
                "Roughly chop tomatoes, peppers, cucumber, and onion.",
                "Blend vegetables with olive oil and vinegar until smooth (or chunky if preferred).",
                "Chill for at least 30 mins.",
                "Serve in a bowl topped with whole cooked shrimp."
            ], 
            mod: "Sophia: 3 shrimp.", 
            macros: { J:{p:15,c:19,f:2,k:154}, S:{p:10,c:12,f:2,k:106} } 
        },
        "Curried Chicken Salad": { 
            ing: ["6oz Chicken", "Curry Powder", "Grapes", "Yogurt/Mayo", "**Celery**", "**Cashews**", "**Spinach**"], 
            steps: [
                "Dice cooked chicken.",
                "Mix yogurt/mayo with curry powder.",
                "Combine chicken, sauce, halved grapes, chopped celery, and cashews.",
                "Serve over a bed of fresh spinach."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:48,c:15,f:18,k:414}, S:{p:24,c:9,f:9,k:213} } 
        },

        // DINNERS
        "Ostrich Steaks": { 
            ing: ["6oz Ostrich Steaks", "Blackberries", "Ghee", "Rosemary", "**Broccoli**", "**Sweet Potato**"], 
            steps: [
                "Pat ostrich steaks completely dry.",
                "Heat cast iron skillet over **High Heat** with ghee.",
                "Sear steaks for **3 minutes per side** (aim for rare/medium-rare).",
                "Rest for 5-8 minutes. Top with blackberries.",
                "Serve with steamed broccoli and roasted sweet potato."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:48,c:25,f:10,k:382}, S:{p:24,c:15,f:6,k:210} } 
        },
        "Wild Elk Medallions": { ing: ["6oz Elk", "Juniper", "Bone Broth", "**Brussels Sprouts**", "**Carrots**"], steps: ["Sear meat 3m/side. Roast veggies 400F 20m."], mod: "Sophia: 3oz.", macros: { J:{p:50,c:12,f:5,k:293}, S:{p:25,c:8,f:3,k:159} } },
        "Miso Sea Bass": { 
            ing: ["6oz Sea Bass", "Miso Paste", "Mirin", "Bok Choy", "**Shiitake Mushrooms**", "**Snap Peas**"], 
            steps: [
                "Marinate fish in miso/mirin mix for 20 mins.",
                "Preheat oven to **400¬∞F (200¬∞C)**.",
                "Place fish and veggies on parchment paper. Bake for **12-15 minutes**.",
                "Finish under broiler for **1-2 minutes**."
            ], 
            mod: "Sophia: 3oz.", 
            macros: { J:{p:40,c:18,f:15,k:367}, S:{p:20,c:10,f:8,k:192} } 
        },
        "Garlic Ghee Lobster": { ing: ["2 Tails", "Garlic", "Ghee", "**Asparagus**", "**Cauliflower**"], steps: ["Grill lobster 5m. Roast veggies."], mod: "Sophia: 1 tail.", macros: { J:{p:45,c:8,f:20,k:392}, S:{p:22,c:5,f:10,k:198} } },
        "Grilled Branzino": { ing: ["Whole Fish", "Lemon", "Rosemary", "**Fennel**", "**Tomato**"], steps: ["Grill fish 6m/side. Serve with roasted fennel."], mod: "Sophia: 1/2 fish.", macros: { J:{p:40,c:10,f:15,k:335}, S:{p:20,c:6,f:8,k:176} } },
        "Bison Fillet": { ing: ["6oz Fillet", "Thyme", "Ghee", "**Green Beans**", "**Mushrooms**"], steps: ["Sear meat 4m/side. Saut√© veggies."], mod: "Sophia: 3oz.", macros: { J:{p:45,c:8,f:15,k:347}, S:{p:22,c:5,f:8,k:180} } },
        "SF Style Cioppino": { ing: ["Mussels", "White Fish", "Fennel", "**Tomato**", "**Spinach**"], steps: ["Simmer broth. Add seafood at end."], mod: "Sophia: 1.5 cups.", macros: { J:{p:40,c:20,f:8,k:312}, S:{p:25,c:14,f:5,k:201} } },
        "Bison Ribeye": { ing: ["8oz Ribeye", "Salt", "Pepper", "**Asparagus**", "**Peppers**"], steps: ["Sear steak 3m/side. Grill veggies."], mod: "Sophia: 3oz.", macros: { J:{p:55,c:6,f:35,k:559}, S:{p:25,c:4,f:15,k:251} } },
        "Elk Stir Fry": { ing: ["6oz Elk", "Broccoli", "Ginger", "**Snow Peas**", "**Carrots**"], steps: ["Wok sear meat then veggies."], mod: "Sophia: 3oz.", macros: { J:{p:50,c:18,f:8,k:344}, S:{p:25,c:10,f:4,k:176} } },
        "Grilled Octopus": { ing: ["6oz Octopus", "Lemon", "Oregano", "**Potato**", "**Olives**"], steps: ["Grill octopus. Serve with potato salad."], mod: "Sophia: 3oz.", macros: { J:{p:45,c:25,f:5,k:325}, S:{p:22,c:15,f:3,k:175} } },
        "Scallops & Asparagus": { ing: ["6 Scallops", "Asparagus", "Lemon", "**Cauliflower Puree**"], steps: ["Sear scallops 2m/side. Serve over puree."], mod: "Sophia: 3 scallops.", macros: { J:{p:35,c:12,f:5,k:233}, S:{p:18,c:8,f:3,k:131} } },
        "Bison Meatballs": { ing: ["6oz Bison", "Almond Flour", "Marinara", "**Spaghetti Squash**"], steps: ["Bake meatballs. Serve over squash."], mod: "Sophia: 3oz.", macros: { J:{p:42,c:15,f:18,k:390}, S:{p:21,c:8,f:10,k:206} } },
        "Steamed Mussels": { ing: ["1lb Mussels", "Garlic", "White Wine", "**Tomato**", "**Parsley**"], steps: ["Steam open. Discard unopened."], mod: "Sophia: 1/2 lb.", macros: { J:{p:40,c:14,f:8,k:288}, S:{p:20,c:8,f:4,k:148} } },
        "Surf & Turf": { ing: ["3oz Bison", "3 Shrimp", "Ghee", "**Broccoli**", "**Carrots**"], steps: ["Grill meat/shrimp. Steam veggies."], mod: "Sophia: 2oz/2 shrimp.", macros: { J:{p:40,c:8,f:15,k:327}, S:{p:25,c:5,f:8,k:192} } },
        "Pan Seared Cod": { ing: ["6oz Cod", "Capers", "Butter", "**Green Beans**", "**Almonds**"], steps: ["Sear cod. Saut√© beans with almonds."], mod: "Sophia: 3oz.", macros: { J:{p:35,c:6,f:12,k:272}, S:{p:18,c:4,f:6,k:142} } },
        "Garlic Shrimp Skewers": { ing: ["6 Shrimp", "Garlic", "Parsley", "**Zucchini**", "**Peppers**"], steps: ["Grill skewers 2m/side."], mod: "Sophia: 4 shrimp.", macros: { J:{p:30,c:6,f:8,k:216}, S:{p:20,c:4,f:5,k:141} } },
        "Chicken Piccata": { ing: ["6oz Chicken", "Lemon", "Capers", "**Asparagus**", "**Artichoke**"], steps: ["Pan fry chicken. Add veggies."], mod: "Sophia: 3oz.", macros: { J:{p:48,c:8,f:15,k:359}, S:{p:24,c:5,f:8,k:188} } },
        "Herb Crusted Branzino": { ing: ["Fillets", "Parsley", "Almond Meal", "**Spinach**", "**Tomato**"], steps: ["Pan fry fish. Wilt spinach."], mod: "Sophia: 1 fillet.", macros: { J:{p:40,c:8,f:15,k:327}, S:{p:20,c:5,f:8,k:172} } },
        "Salmon Plank": { ing: ["6oz Salmon", "Cedar Plank", "Lemon", "**Asparagus**", "**Squash**"], steps: ["Grill 15m. Grill veggies."], mod: "Sophia: 3oz.", macros: { J:{p:38,c:6,f:20,k:356}, S:{p:19,c:4,f:10,k:182} } },
        "Bison Short Ribs": { ing: ["8oz Ribs", "Red Wine", "Carrots", "**Celery**", "**Onion**"], steps: ["Braise 3h with root veggies."], mod: "Sophia: 4oz.", macros: { J:{p:50,c:15,f:30,k:530}, S:{p:25,c:8,f:15,k:267} } },
        "Dungeness Crab Legs": { ing: ["1lb Legs", "Ghee", "Lemon", "**Corn**", "**Potato**"], steps: ["Steam crab and veggies."], mod: "Sophia: 1/2 lb.", macros: { J:{p:45,c:25,f:15,k:415}, S:{p:22,c:15,f:8,k:220} } },
        "Lamb Chops": { ing: ["3 Chops", "Rosemary", "Garlic", "**Peas**", "**Mint**"], steps: ["Sear 3m/side. Serve with peas."], mod: "Sophia: 2 chops.", macros: { J:{p:50,c:10,f:35,k:555}, S:{p:30,c:6,f:20,k:324} } },
        "Halibut w/ Mango Salsa": { ing: ["6oz Halibut", "Mango", "Jalapeno", "**Broccoli**", "**Rice**"], steps: ["Pan sear fish. Serve with broccoli/rice."], mod: "Sophia: 3oz.", macros: { J:{p:38,c:25,f:5,k:297}, S:{p:19,c:15,f:3,k:163} } },
        "Duck Breast": { ing: ["6oz Duck", "Orange Glaze", "**Bok Choy**", "**Mushrooms**"], steps: ["Sear skin side down. Saut√© greens."], mod: "Sophia: 3oz.", macros: { J:{p:40,c:14,f:25,k:441}, S:{p:20,c:8,f:12,k:220} } },
        "Venison Steak": { ing: ["6oz Venison", "Juniper", "Thyme", "**Parsnip**", "**Carrot**"], steps: ["Sear rare. Roast root veggies."], mod: "Sophia: 3oz.", macros: { J:{p:50,c:15,f:6,k:314}, S:{p:25,c:8,f:3,k:159} } },
        "Rainbow Trout": { ing: ["Whole Trout", "Almonds", "Butter", "**Green Beans**"], steps: ["Pan fry with beans."], mod: "Sophia: 1/2 fish.", macros: { J:{p:40,c:8,f:15,k:327}, S:{p:20,c:5,f:8,k:172} } },
        "Clams Linguine": { ing: ["1lb Clams", "Zucchini", "Garlic", "**Tomato**", "**Basil**"], steps: ["Steam clams. Toss with zucchini noodles."], mod: "Sophia: 1/2 lb.", macros: { J:{p:35,c:18,f:8,k:284}, S:{p:18,c:10,f:4,k:148} } },
        "Swordfish Steak": { ing: ["6oz Swordfish", "Lemon", "Oregano", "**Eggplant**", "**Peppers**"], steps: ["Grill 4m/side. Grill veggies."], mod: "Sophia: 3oz.", macros: { J:{p:40,c:8,f:15,k:327}, S:{p:20,c:5,f:8,k:172} } },
        "Squid Ink Risotto": { 
            ing: ["Squid (Calamari) Rings", "Cauliflower Rice", "Squid/Cuttlefish Ink (1-2 tsp)", "**Shallots**", "**Garlic**", "**Fish Stock**"], 
            steps: [
                "Heat olive oil in a pan. Saut√© shallots and garlic until soft.",
                "Add cauliflower rice. Stir to coat.",
                "Dissolve squid ink in warm fish stock. Pour slowly into pan.",
                "Simmer until liquid absorbs and 'rice' is tender (**5-7 mins**).",
                "In a separate pan, quickly sear squid rings (2 mins max). Top risotto."
            ], 
            mod: "Sophia: 1/2 cup.", 
            macros: { J:{p:35,c:24,f:10,k:326}, S:{p:18,c:16,f:6,k:190} } 
        },
        "Paella (Seafood Only)": { ing: ["Shrimp", "Mussels", "Saffron", "**Peas**", "**Peppers**"], steps: ["Simmer rice and seafood."], mod: "Sophia: 1 cup.", macros: { J:{p:45,c:40,f:12,k:448}, S:{p:25,c:28,f:8,k:284} } }
    };

    const weeklySchedule = [
        { w: "REST & RECOVERY", c: "LOW CARB", j: "APOLLO GOLD", rec: ["üî´ THERABODY", "üßò STATIC"] },
        { w: "HEAVY LIFT", c: "HIGH CARB", j: "PLASMA FLUSH", rec: ["üßñ‚Äç‚ôÇÔ∏è SAUNA", "üë¢ NORMATEC"] },
        { w: "BOXING (TRAINER)", c: "HIGH CARB", j: "TITAN RED", rec: ["üõèÔ∏è MASSAGE", "üî´ THERABODY"] },
        { w: "REFORM & LOW LIFT", c: "LOW CARB", j: "ZENITH GREEN", rec: ["üßñ‚Äç‚ôÇÔ∏è SAUNA"] },
        { w: "BOXING (TRAINER)", c: "HIGH CARB", j: "TITAN RED", rec: ["üõèÔ∏è MASSAGE", "üë¢ NORMATEC"] },
        { w: "YOGA & REFORM", c: "LOW CARB", j: "ZENITH GREEN", rec: ["üßñ‚Äç‚ôÇÔ∏è SAUNA", "üî´ THERABODY"] },
        { w: "CS4 HIIT", c: "HIGH CARB", j: "TITAN RED", rec: ["üë¢ NORMATEC"] }
    ];

    const recoveryData = [
        { warmup: [{t:"None", d:"", n:"Rest Day"}], gym: [{t:"None", d:"", n:"Rest Day"}], home: [{t:"Normatec", d:"30 min", n:"HIPS Attachment (Level 5)"}, {t:"Thera Knee", d:"Contrast", n:"Cycle Hot/Cold"}, {t:"Theragun Pro", d:"Supersoft", n:"Neck/Traps"}] },
        { warmup: [{t:"Thera Knee", d:"15 min", n:"Heat + Vibration"}, {t:"Theragun Pro", d:"2 min", n:"Heat Head - Glutes/Quads"}], gym: [{t:"Cryotherapy", d:"3 min", n:"If RPE > 9/10"}, {t:"Sauna", d:"20 min", n:"HGH Release"}, {t:"Aqua Massage", d:"10 min", n:"Mental reset"}], home: [{t:"Normatec", d:"45 min", n:"HIPS Attachment (Level 7)"}, {t:"Theragun Pro", d:"Thumb", n:"Glute trigger points"}] },
        { warmup: [{t:"Theragun Pro", d:"2 min", n:"Heat Head - Shoulders"}], gym: [{t:"Aqua Massage", d:"15 min", n:"Upper Back setting"}, {t:"Sauna", d:"15 min", n:"Cardio Flush"}], home: [{t:"Normatec", d:"30 min", n:"LEGS Attachment (Zone 1 Boost)"}, {t:"Theragun Pro", d:"Cold", n:"Wrists/Knuckles"}] },
        { warmup: [{t:"Theragun Pro", d:"Full Body", n:"Standard Ball - Sweep"}], gym: [{t:"Sauna", d:"15 min", n:"Circulation only"}], home: [{t:"Normatec", d:"30 min", n:"LEGS (Level 4)"}] },
        { warmup: [{t:"Thera Knee", d:"10 min", n:"Heat - If stiff"}, {t:"Theragun Pro", d:"Dampener", n:"Obliques - Rotation prep"}], gym: [{t:"Aqua Massage", d:"15 min", n:"Neck/Traps"}], home: [{t:"Normatec", d:"30 min", n:"HIPS (Level 6)"}] },
        { warmup: [{t:"Theragun Pro", d:"Heat", n:"Hamstrings"}], gym: [{t:"Sauna", d:"20 min", n:"Deep heat"}], home: [{t:"Thera Knee", d:"20 min", n:"Contrast Mode"}] },
        { warmup: [{t:"Thera Knee", d:"15 min", n:"Heat + Vibration"}], gym: [{t:"Cryotherapy", d:"Recommended", n:"Systemic flush"}, {t:"Aqua Massage", d:"10 min", n:"Cool down"}], home: [{t:"Normatec", d:"60 min", n:"LEGS (Level 7)"}, {t:"Thera Knee", d:"Cold", n:"If puffy"}] }
    ];

    const bKeys = Object.keys(recipeDB).slice(0, 30);
    const lKeys = Object.keys(recipeDB).slice(30, 60);
    const dKeys = Object.keys(recipeDB).slice(60, 90);
    const masterSchedule = Array.from({length: 30}, (_, i) => ({ b: bKeys[i], l: lKeys[i], d: dKeys[i] }));
    let weekOffset = 0;
    let selectedDayIndex = 0; 
    let selectedDateObj = new Date();

    function getMonday(offset) { let d = new Date(); let day = d.getDay(), diff = d.getDate() - day + (day == 0 ? -6:1); let mon = new Date(d.setDate(diff)); mon.setDate(mon.getDate() + (offset * 7)); return mon; }

    function switchUser(user) {
        currentUser = user;
        document.getElementById('badgeJ').classList.toggle('active-user', user === 'J');
        document.getElementById('badgeS').classList.toggle('active-user', user === 'S');
        document.getElementById('badgeJ').classList.toggle('sophia', false); 
        document.getElementById('badgeS').classList.toggle('sophia', user === 'S'); 
        showDay(selectedDateObj, selectedDayIndex);
        renderHistory();
    }

    function renderTabs() {
        const monday = getMonday(weekOffset);
        document.getElementById('dateRangeDisplay').innerText = `${monday.toLocaleDateString('en-US', {month:'short', day:'numeric'})} ‚Äî ${new Date(monday.getTime() + 6*86400000).toLocaleDateString('en-US', {month:'short', day:'numeric'})}`;
        const tabs = document.getElementById('dayTabs'); tabs.innerHTML = '';
        ["MON", "TUE", "WED", "THU", "FRI", "SAT", "SUN"].forEach((day, i) => {
            let tabDate = new Date(monday); tabDate.setDate(monday.getDate() + i);
            const btn = document.createElement('button');
            const isToday = tabDate.toDateString() === new Date().toDateString();
            btn.className = 'tab-btn' + (isToday && weekOffset === 0 ? ' active' : '');
            btn.innerHTML = `${day}<span>${tabDate.getDate()}</span>`;
            let dIndex = (i + 1) % 7; 
            btn.onclick = () => { document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); showDay(tabDate, dIndex); };
            tabs.appendChild(btn); if(btn.className.includes('active')) showDay(tabDate, dIndex);
        });
    }

    function getDayState(dateKey) {
        if (!dayState[dateKey]) {
            dayState[dateKey] = { s1: null, s2: null, s3: null, proto: {sea: false, kom: false}, juice: false };
        }
        return dayState[dateKey];
    }

    function calculateMacros(meal, scheduleType, dateKey) {
        const state = getDayState(dateKey);
        const rB = recipeDB[meal.b].macros[currentUser] || {p:0,c:0,f:0,k:0};
        const rL = recipeDB[meal.l].macros[currentUser] || {p:0,c:0,f:0,k:0};
        const rD = recipeDB[meal.d].macros[currentUser] || {p:0,c:0,f:0,k:0};

        let total = {
            p: rB.p + rL.p + rD.p,
            c: rB.c + rL.c + rD.c,
            f: rB.f + rL.f + rD.f,
            k: rB.k + rL.k + rD.k
        };

        if (state.s1) { let s = snackDB[state.s1]; total.p+=s.p; total.c+=s.c; total.f+=s.f; total.k+=s.k; }
        if (state.s2) { let s = snackDB[state.s2]; total.p+=s.p; total.c+=s.c; total.f+=s.f; total.k+=s.k; }
        if (state.s3) { let s = snackDB[state.s3]; total.p+=s.p; total.c+=s.c; total.f+=s.f; total.k+=s.k; }

        if (state.proto.sea) { let p = protocolData["Sea Moss"].macros; total.p+=p.p; total.c+=p.c; total.f+=p.f; total.k+=p.k; }
        if (state.proto.kom) { let p = protocolData["Kombucha"].macros; total.p+=p.p; total.c+=p.c; total.f+=p.f; total.k+=p.k; }

        // AUTO-INCLUDE JUICE
        const dayIdx = new Date(dateKey).getDay();
        const schedJuiceName = weeklySchedule[(dayIdx + 6) % 7].j; 
        const jM = juiceData[schedJuiceName].macros;
        total.p+=jM.p; total.c+=jM.c; total.f+=jM.f; total.k+=jM.k;

        const goal = macroTargets[currentUser][scheduleType];
        return { total, goal, state };
    }

    function showDay(dateObj, dayIndex) {
        selectedDateObj = dateObj;
        selectedDayIndex = dayIndex;
        selectedDateStr = dateObj.toISOString().split('T')[0];

        const start = new Date(2025, 0, 1);
        const dayId = Math.floor((dateObj - start) / 86400000);
        const schedule = weeklySchedule[dayIndex];
        const meal = masterSchedule[dayId % 30]; 
        const juice = juiceData[schedule.j];

        const { total, goal, state } = calculateMacros(meal, schedule.c, selectedDateStr);
        const pPct = Math.min((total.p / goal.p) * 100, 100);
        const cPct = Math.min((total.c / goal.c) * 100, 100);
        const fPct = Math.min((total.f / goal.f) * 100, 100);
        const kPct = Math.min((total.k / goal.k) * 100, 100);

        document.getElementById('dayContent').innerHTML = `
            <div class="macro-dashboard" onclick="openProfileModal()">
                <div class="view-goals-link">VIEW GOALS ‚Üó</div>
                <div class="macro-header">
                    <span>${currentUser === 'J' ? 'JERMAINE' : 'SOPHIA'} DAILY MACROS</span>
                </div>
                
                <div class="macro-row"><div class="macro-label"><span>PROTEIN</span><span>${total.p}g / ${goal.p}g</span></div><div class="macro-bar-bg"><div class="macro-bar-fill p-fill" style="width:${pPct}%"></div></div></div>
                <div class="macro-row"><div class="macro-label"><span>CARBS</span><span>${total.c}g / ${goal.c}g</span></div><div class="macro-bar-bg"><div class="macro-bar-fill c-fill" style="width:${cPct}%"></div></div></div>
                <div class="macro-row"><div class="macro-label"><span>FATS</span><span>${total.f}g / ${goal.f}g</span></div><div class="macro-bar-bg"><div class="macro-bar-fill f-fill" style="width:${fPct}%"></div></div></div>
                <div class="macro-row" style="margin-bottom:0"><div class="macro-label"><span>CALORIES</span><span>${total.k} / ${goal.k}</span></div><div class="macro-bar-bg"><div class="macro-bar-fill cal-fill" style="width:${kPct}%"></div></div></div>
            </div>

            <div class="card">
                <div class="workout-header">
                    <div class="workout-title-btn" onclick="openRecovery(${dayIndex})">
                        <span>${schedule.w}</span> <span class="info-icon">‚ìò</span>
                    </div>
                    <span class="carb-pill" style="background:${schedule.c==='HIGH CARB'?'var(--carb-high)':'var(--carb-low)'}">${schedule.c}</span>
                </div>
                <div class="label">üç≥ Breakfast</div><div class="value" onclick="openRecipe('${meal.b}')"><span style="color:#fff">üßîüèæ‚Äç‚ôÇÔ∏è J</span> <span style="color:var(--glute-pink)">üë©üèæ‚Äçü¶± S</span> : ${meal.b}</div>
                <div class="label">ü•ó Lunch</div><div class="value" onclick="openRecipe('${meal.l}')"><span style="color:#fff">üßîüèæ‚Äç‚ôÇÔ∏è J</span> <span style="color:var(--glute-pink)">üë©üèæ‚Äçü¶± S</span> : ${meal.l}</div>
                <div class="label">üçΩÔ∏è Dinner</div><div class="value" onclick="openRecipe('${meal.d}')"><span style="color:#fff">üßîüèæ‚Äç‚ôÇÔ∏è J</span> <span style="color:var(--glute-pink)">üë©üèæ‚Äçü¶± S</span> : ${meal.d}</div>
                
                <div class="label">ü•§ Snack Slot 1</div>
                <div class="snack-slot ${state.s1?'filled':''}" onclick="openSnackSelector(1)"><span>${state.s1 ? state.s1 : '+ ADD SNACK 1'}</span>${state.s1 ? '<span class="snack-remove" onclick="event.stopPropagation(); removeSnack(1)">√ó</span>' : ''}</div>
                <div class="label">ü•ú Snack Slot 2</div>
                <div class="snack-slot ${state.s2?'filled':''}" onclick="openSnackSelector(2)"><span>${state.s2 ? state.s2 : '+ ADD SNACK 2'}</span>${state.s2 ? '<span class="snack-remove" onclick="event.stopPropagation(); removeSnack(2)">√ó</span>' : ''}</div>
                <div class="label">üçé Snack Slot 3</div>
                <div class="snack-slot ${state.s3?'filled':''}" onclick="openSnackSelector(3)"><span>${state.s3 ? state.s3 : '+ ADD SNACK 3'}</span>${state.s3 ? '<span class="snack-remove" onclick="event.stopPropagation(); removeSnack(3)">√ó</span>' : ''}</div>

                <div class="protocol-row">
                    <span class="proto-btn ${state.proto.sea ? 'active' : ''}" onclick="toggleProtocol('sea')">üåä SEA MOSS</span>
                    <span class="proto-btn ${state.proto.kom ? 'active' : ''}" onclick="toggleProtocol('kom')">üçÑ KOMBUCHA</span>
                    <span class="proto-btn" style="color:var(--target-green); border-color:var(--target-green);">üíß 1.2 GAL</span>
                </div>
                <div class="protocol-row" style="margin-top:8px; padding-top:0; border-top:none;">
                    ${schedule.rec.map(r => `<span class="proto-btn rec-btn">${r}</span>`).join('')}
                </div>
            </div>
            <div class="juice-card active" style="border-color:${juice.color};" onclick="openJuiceModal('${schedule.j}')">
                <span class="juice-badge" style="color:${juice.color}; border-color:${juice.color}">${juice.badge}</span>
                <div class="label" style="color:${juice.color}">Kuvings Catalyst</div>
                <div class="juice-name" style="color:#fff">${schedule.j} <span style="font-size:1.5rem">${juice.icon}</span></div>
                <div class="juice-benefit" style="border-color:${juice.color}">${juice.text}</div>
                <div class="juice-macro-row">${juice.macros.k} KCAL ‚Ä¢ ${juice.macros.c}G CARB ‚Ä¢ INCLUDED ‚úì</div>
            </div>`;
    }

    function generateGroceryList() {
        const monday = getMonday(weekOffset);
        let ingredients = { "Sea Moss Gel": "1 Jar", "Kombucha": "7 Bottles", "Mg Electrolytes": "1 Tub", "Water (Gallons)": "8 Gallons", "Pea/Peanut Protein": "1 Bag Each" };
        for (let i = 0; i < 7; i++) {
            let tabDate = new Date(monday); tabDate.setDate(monday.getDate() + i);
            const start = new Date(2025, 0, 1);
            const dayId = Math.floor((tabDate - start) / 86400000);
            const meal = masterSchedule[dayId % 30];
            [meal.b, meal.l, meal.d].forEach(mName => recipeDB[mName].ing.forEach(ing => ingredients[ing] = "Check"));
            const dStr = tabDate.toISOString().split('T')[0];
            if (dayState[dStr]) {
                if (dayState[dStr].s1) ingredients[dayState[dStr].s1] = "Check";
                if (dayState[dStr].s2) ingredients[dayState[dStr].s2] = "Check";
                if (dayState[dStr].s3) ingredients[dayState[dStr].s3] = "Check";
            }
        }
        let html = "<ul>";
        for (const [key, val] of Object.entries(ingredients)) html += `<li style="margin-bottom:8px; border-bottom:1px solid #333; padding-bottom:4px;">${key}</li>`;
        html += "</ul>";
        document.getElementById('groceryList').innerHTML = html;
        document.getElementById('groceryModal').style.display = 'block';
    }

    function openSnackSelector(slot) {
        currentSnackSlot = slot;
        const container = document.getElementById('snackOptionsList');
        container.innerHTML = Object.keys(snackDB).map(key => {
            const s = snackDB[key];
            return `<div class="shake-option" onclick="selectSnack('${key}')"><div><div class="shake-name" style="${key==='REMOVE'?'color:#e74c3c':''}">${key}</div>${key!=='REMOVE' ? `<div class="shake-macros">P: ${s.p}g | C: ${s.c}g | Kcal: ${s.k}</div>` : ''}</div><span style="color:var(--accent-gold); font-size:1.2rem;">+</span></div>`;
        }).join('');
        openModal('snackModal');
    }

    function selectSnack(name) {
        const slotKey = currentSnackSlot === 1 ? 's1' : (currentSnackSlot === 2 ? 's2' : 's3');
        if (name === 'REMOVE') dayState[selectedDateStr][slotKey] = null;
        else dayState[selectedDateStr][slotKey] = name;
        closeModal('snackModal');
        showDay(selectedDateObj, selectedDayIndex);
    }
    
    function removeSnack(slot) {
        const slotKey = slot === 1 ? 's1' : (slot === 2 ? 's2' : 's3');
        dayState[selectedDateStr][slotKey] = null;
        showDay(selectedDateObj, selectedDayIndex);
    }

    function toggleProtocol(type) {
        dayState[selectedDateStr].proto[type] = !dayState[selectedDateStr].proto[type];
        showDay(selectedDateObj, selectedDayIndex);
    }

    function openJuiceModal(jName) {
        const j = juiceData[jName];
        document.getElementById('jTitle').innerText = jName;
        document.getElementById('jMacros').innerText = `MACROS: P: ${j.macros.p}g | C: ${j.macros.c}g | Kcal: ${j.macros.k}`;
        document.getElementById('jPrep').innerHTML = j.prep.map(s => `<p>‚Ä¢ ${s}</p>`).join('');
        openModal('juiceModal');
    }

    function openProfileModal() {
        if (currentUser === 'J') openModal('jermaineModal');
        else openModal('sophiaModal');
    }

    function openRecovery(idx) {
        const data = recoveryData[idx];
        const title = weeklySchedule[idx].w;
        document.getElementById('recTitle').innerText = title + " RECOVERY";
        const buildList = (arr) => arr.map(item => `<div class="rec-item"><div class="rec-tool">${item.t} ${item.d ? `<span style="float:right; opacity:0.7; font-size:0.8em">${item.d}</span>` : ''}</div><div class="rec-detail">${item.n}</div></div>`).join('');
        document.getElementById('recWarmup').innerHTML = buildList(data.warmup);
        document.getElementById('recGym').innerHTML = buildList(data.gym);
        document.getElementById('recHome').innerHTML = buildList(data.home);
        openModal('recoveryModal');
    }

    function openRecipe(n) { 
        let r = recipeDB[n];
        document.getElementById('modalTitle').innerText = n; 
        document.getElementById('modalIng').innerHTML = r.ing.map(i => '<li>‚Ä¢ ' + i.replace(/\*\*(.*?)\*\*/g, '<b style="color:var(--target-green)">$1</b>') + '</li>').join('');
        document.getElementById('modalSteps').innerHTML = r.steps.map(s => `<p>${s.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>')}</p>`).join(''); 
        document.getElementById('modalMod').innerText = r.mod; 
        const jM = r.macros.J; const sM = r.macros.S;
        const macroHTML = `<div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:20px; font-size:0.8rem; text-align:center;"><div style="background:#111; padding:10px; border-radius:6px; border:1px solid #333"><div style="color:var(--accent-gold); font-weight:800; margin-bottom:5px;">JERMAINE</div><div>P: ${jM.p}g | C: ${jM.c}g | K: ${jM.k}</div></div><div style="background:#111; padding:10px; border-radius:6px; border:1px solid var(--glute-pink)"><div style="color:var(--glute-pink); font-weight:800; margin-bottom:5px;">SOPHIA</div><div>P: ${sM.p}g | C: ${sM.c}g | K: ${sM.k}</div></div></div>`;
        document.getElementById('modBox').innerHTML = `<div style="color:var(--glute-pink); font-size:0.8rem; font-weight:800; text-transform:uppercase;">üçë Sophia's Mod</div><div id="modalMod" style="color:#e5e4e2; font-size:0.85rem;">${r.mod}</div>` + macroHTML;
        document.getElementById('modBox').style.display = 'block'; 
        openModal('recipeModal'); 
    }
    
    function openProtocol(n) { document.getElementById('protoTitle').innerText = n; document.getElementById('protoBody').innerHTML = protocolData[n].text; openModal('protocolModal'); }
    function openModal(id) { document.getElementById(id).style.display = 'block'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    function changeWeek(dir) { weekOffset += dir; renderTabs(); }
    function resetToCurrent() { weekOffset = 0; renderTabs(); }
    
    window.onload = function() {
        renderTabs();
        renderHistory();
    };
</script>
</body>
</html>