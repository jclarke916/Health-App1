<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centurion Safe Mode</title>
    <style>
        body { 
            background-color: #001133; /* Deep Blue = Success */
            color: #fff; 
            font-family: monospace; 
            padding: 20px; 
            margin: 0;
        }
        .btn {
            background: #00ff00; 
            color: #000; 
            padding: 15px; 
            font-size: 1rem; 
            font-weight: bold; 
            border: none; 
            border-radius: 8px; 
            width: 100%;
            cursor: pointer;
            margin-bottom: 20px;
        }
        .log {
            background: #fff; 
            color: #000; 
            padding: 10px; 
            border-radius: 8px; 
            min-height: 200px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>

    <button class="btn" onclick="startSystem()">⚡ BOOT SYSTEM</button>

    <div style="margin-bottom:5px">SYSTEM LOG:</div>
    <div id="console" class="log">Waiting for boot...</div>

<script>
    // GLOBAL CONFIG
    const KEY = "AIzaSyBtqgUcbq5uVGFZ5nHPDyhthLDii7uRNrg";
    
    function log(msg) {
        const box = document.getElementById('console');
        const time = new Date().toLocaleTimeString();
        box.innerHTML = `[${time}] ${msg}\n` + box.innerHTML;
    }

    async function startSystem() {
        log("Booting...");
        
        // 1. CHECK API KEY
        if(!KEY) { log("❌ CRITICAL: No API Key found in code."); return; }
        log("✅ API Key detected.");

        // 2. CHECK INTERNET / OURA PROXY
        log("Testing Network (Oura Proxy)...");
        try {
            const r = await fetch('https://corsproxy.io/?https://api.ouraring.com/v2/ping');
            // Even a 401 is success here, it means we hit the server
            log(`✅ Network OK (Status: ${r.status})`);
        } catch(e) {
            log(`❌ Network Error: ${e.message}`);
        }

        // 3. CHECK GOOGLE API PERMISSIONS
        log("Testing Google API (ListModels)...");
        try {
            const url = `https://generativelanguage.googleapis.com/v1beta/models?key=${KEY}`;
            const res = await fetch(url);
            const data = await res.json();

            if(data.error) {
                log(`❌ GOOGLE ERROR:\n${data.error.message}`);
            } else if (data.models) {
                log(`✅ GOOGLE CONNECTED! Found ${data.models.length} models.`);
                
                // FIND USABLE MODELS
                const usable = data.models
                    .filter(m => m.supportedGenerationMethods.includes('generateContent'))
                    .map(m => m.name.replace('models/', ''));
                
                log("--- USABLE MODELS ---");
                log(usable.join("\n"));
                log("---------------------");
                
                // 4. ATTEMPT GENERATION (using first available)
                if(usable.length > 0) {
                    const target = usable[0]; // Pick the first valid one
                    log(`Attempting generation with: ${target}`);
                    await testGen(target);
                }
            }
        } catch(e) {
            log(`❌ CRASH: ${e.message}`);
        }
    }

    async function testGen(modelName) {
        try {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${KEY}`;
            const res = await fetch(url, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ contents: [{ parts: [{ text: "Ping" }] }] })
            });
            const data = await res.json();
            
            if(data.candidates) {
                log(`✅✅✅ SUCCESS! AI Responded: "${data.candidates[0].content.parts[0].text}"`);
            } else {
                log(`❌ Gen Failed: ${JSON.stringify(data)}`);
            }
        } catch(e) {
            log(`❌ Gen Crash: ${e.message}`);
        }
    }

    // Catch Syntax Errors that happen before click
    window.onerror = function(msg, url, line) {
        alert("GLOBAL CRASH: " + msg + "\nLine: " + line);
        return true;
    };
</script>
</body>
</html>