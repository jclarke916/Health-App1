<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Centurion | v224.00 Ultra Stable</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root{--bg:#050505;--card:#141414;--gold:#D4AF37;--green:#00E676;--blue:#00B0FF;--purple:#D500F9;--text:#fff;--g-pro:linear-gradient(90deg,#FF5252,#D50000);--g-carb:linear-gradient(90deg,#FFAB40,#FF6D00);--g-cal:linear-gradient(90deg,#B388FF,#6200EA);--g-fib:linear-gradient(90deg,#00E676,#00C853)}
        *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
        body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);margin:0;padding:15px;font-size:14px}
        .container{max-width:500px;margin:0 auto; padding-bottom: 50px;}
        h1{text-align:center;font-weight:200;letter-spacing:5px;text-transform:uppercase;font-size:1.2rem;margin:10px 0}
        .version-tag { display: block; text-align: center; font-size: 0.5rem; color: #444; margin-top: -8px; margin-bottom: 15px; letter-spacing: 2px; }
        .badge-row{display:flex;justify-content:center;gap:8px;margin-bottom:15px}
        .u-badge{background:#000;padding:8px 16px;border-radius:20px;border:1px solid #333;font-size:0.6rem;font-weight:800;cursor:pointer;color:#666}
        .u-badge.active{border-color:var(--gold);color:var(--gold)}
        .status-bar{text-align:center;color:#888;font-size:0.65rem;font-weight:800;margin-bottom:10px;text-transform:uppercase}
        .controls{display:flex;gap:5px;margin-bottom:15px}
        .nav-btn{background:#111;border:1px solid #222;color:#888;padding:10px;flex:1;border-radius:8px;font-size:0.55rem;font-weight:800;cursor:pointer}
        .card, .macro-dashboard{background:var(--card);border-radius:20px;padding:20px;margin-bottom:15px;border:1px solid rgba(255,255,255,0.03);position:relative}
        .card::before{content:"";position:absolute;left:0;top:20px;bottom:20px;width:3px;background:var(--gold);border-radius:0 4px 4px 0}
        .value{ font-size: 0.95rem; margin-bottom: 12px; font-weight: 500; cursor: pointer; border-bottom: 1px solid #222; padding-bottom: 4px; display: flex; justify-content: space-between; align-items: center; }
        .macro-row{margin-bottom:10px}
        .macro-label{display:flex;justify-content:space-between;font-size:0.55rem;font-weight:800;color:#777;margin-bottom:3px}
        .macro-bg{height:5px;background:#222;border-radius:10px;overflow:hidden}
        .macro-fill{height:100%;border-radius:10px;transition:width 0.8s}
        .tabs{display:flex;gap:4px;margin-bottom:15px}
        .tab{flex:1;padding:10px 0;background:#111;border:1px solid #222;color:#444;border-radius:8px;font-size:0.55rem;font-weight:800;text-align:center;cursor:pointer}
        .tab.active{background:#222;color:#fff;border-color:444}
        .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:#0a0a0a;z-index:2000;overflow-y:auto;}
        .modal-content{background:#0a0a0a;padding:25px;min-height:100%;}
        .close-btn-float { position: fixed; top: 20px; right: 20px; width: 40px; height: 40px; background: rgba(30,30,30,0.8); border-radius: 50%; border: 1px solid #333; color: #fff; font-size: 24px; text-align: center; line-height: 38px; cursor: pointer; z-index: 2001; }
        .meal-img { display: block; width: 100%; height: auto; min-height: 220px; object-fit: cover; border-radius: 14px; background-color: #111; transition: opacity 0.5s ease, filter 0.5s ease; opacity: 0; filter: blur(10px); }
        .img-loader { height: 220px; display: flex; align-items: center; justify-content: center; color: var(--gold); font-size: 0.8rem; font-weight: 700; background: rgba(255,255,255,0.02); border-radius: 14px; border: 1px dashed #333; animation: pulse 1.5s infinite; position: absolute; width: 100%; top: 0; left: 0; z-index: 1; }
        @keyframes pulse { 0% { opacity: 0.4; } 50% { opacity: 1; } 100% { opacity: 0.4; } }
        .snack-grid { display: flex; gap: 10px; margin-bottom: 15px; }
        .snack-slot { flex: 1; border: 1px dashed #333; border-radius: 12px; padding: 12px 5px; text-align: center; cursor: pointer; position: relative; min-height: 60px; background: rgba(255,255,255,0.02); display: flex; flex-direction: column; justify-content: center; }
        .snack-slot.filled { border: 1px solid var(--gold); background: #111; }
        .remove-snack { position: absolute; top: -5px; right: -5px; background: #333; color: #aaa; border: 1px solid #222; border-radius: 50%; width: 16px; height: 16px; font-size: 9px; line-height: 14px; text-align: center; font-weight: 800; }
        .label{color:#666;font-size:0.5rem;text-transform:uppercase;font-weight:900;margin-bottom:4px; display: flex; justify-content: space-between;}
        .snack-label { font-size: 0.65rem; color: #fff; font-weight: 700; }
        .snack-macro { font-size: 0.5rem; color: #666; margin-top: 4px; }
    </style>
</head>
<body>
<div class="container">
    <header><h1>THE CENTURION</h1>
        <span class="version-tag">v224.00 Stable Flow</span>
        <div class="badge-row">
            <div id="bj" class="u-badge active" onclick="switchU('J')">üßîüèæ‚Äç‚ôÇÔ∏è JERMAINE</div>
            <div id="bs" class="u-badge" onclick="switchU('S')">üë©üèæ‚Äçü¶± SOPHIA</div>
        </div>
    </header>
    <div id="dateDisplay" class="status-bar">...</div>
    <div class="controls">
        <button class="nav-btn" onclick="changeW(-1)">PREV</button>
        <button class="nav-btn" onclick="resetD()">TODAY</button>
        <button class="nav-btn" onclick="changeW(1)">NEXT</button>
        <button class="nav-btn" onclick="openBio()" style="color:var(--green)">MY DATA</button>
    </div>
    <div id="dayTabs" class="tabs"></div>
    <div id="dayContent"></div>
</div>

<div id="masterModal" class="modal">
    <div class="close-btn-float" onclick="closeM()">&times;</div>
    <div class="modal-content">
        <h2 id="mTitle" style="font-size:1.5rem; margin-top:10px;"></h2>
        <div id="mSub" style="color:var(--gold);font-size:0.85rem;margin:10px 0; text-transform:uppercase; letter-spacing:1px; font-weight:700;"></div>
        <div id="mImgWrapper" style="position:relative; width:100%; min-height:220px;"></div>
        <div id="mBody" class="chef-steps" style="counter-reset:step"></div>
        <div id="mTip" class="chef-tip" style="margin-top:30px; padding:15px; border:1px solid #222; background:#111; border-radius:10px; color:#888; font-style:italic;"></div>
    </div>
</div>

<script>
let user='J', offset=0, snackLog = {}, currentSlot = 0, selDate = new Date();
selDate.setHours(12,0,0,0);

const mDB = {
    b: ["Turmeric Scramble|Eggs,Spinach,Garlic,Turmeric|scramble|Prep: 5m|22|2|240", "Za'atar Avocado|Eggs,Avocado,Radish,Za'atar|raw|Prep: 5m|24|18|380", "Bison & Rainbow|Ground Bison,Peppers,Onion,Garlic|sear|Prep: 10m|45|8|480", "Ginger Poach|Bone Broth,Eggs,Bok Choy,Ginger|poach|Prep: 5m|20|4|220", "Turkey Sage Pan|Turkey,Fennel,Apple,Sage|sear|Prep: 10m|35|12|360", "Salmon Omelet|Smoked Salmon,Asparagus,Eggs|flat|Prep: 5m|38|2|410", "Purple Toast|Sardines,Cabbage,Avocado,Sourdough|raw|Prep: 10m|25|22|450"],
    l: ["Pepperfin Molino|Albacore Tuna,Jalapeno,Ponzu|raw|Prep: 10m|30|4|260", "Thai Beef Salad|Sirloin,Cucumber,Lime,Fish Sauce|sear|Prep: 15m|45|16|480", "Chicken Chimichurri|Chicken Breast,Parsley,Garlic|poach|Prep: 15m|40|4|420", "Sardine Bowl|Sardines,Radish,Fennel,Lemon|raw|Prep: 10m|28|6|320", "Cold Flank|Flank,Asparagus,Tomato,Dijon|sear|Prep: 10m|42|6|450"],
    d: ["Sea Steak Mikuni|Red Tuna,Daikon,Soy Sauce|sear|Prep: 10m|38|6|320", "Whole Branzino|Branzino,Fennel,Lemon,Garlic|bake|Prep: 10m|40|0|450", "Miso Glazed Cod|Cod,Miso,Ginger,Bok Choy|bake|Prep: 15m|35|8|340", "Harissa Shrimp|Shrimp,Harissa,Cauliflower|sear|Prep: 10m|30|6|290", "Ginger Beef Stir|Flank Steak,Ginger,Peppers|sear|Prep: 15m|45|10|460"],
    s: ["Double Scoop Shake|Whey,Water|shake|Prep: 2m|50|2|240", "Turkey Roll-Ups|Turkey,Swiss,Pickle|raw|Prep: 5m|40|2|240", "Skyr Bowl|Skyr,Blueberries|raw|Prep: 2m|28|12|160", "Beef Jerky|Grass-fed Jerky|raw|Prep: 0m|25|4|180"]
};

const jDB={"PLASMA FLUSH Juice":["Recovery","3c Watermelon, 1 Lime",1,32,140],"TITAN RED Juice":["Endurance","2 Beets, 2 Carrots, Pom",3,42,185],"ZENITH GREEN Juice":["Alkalizer","4 Kale, 1 Cucumber",4,18,90],"APOLLO GOLD Juice":["Anti-Inflammatory","2 Pears, Turmeric",1,45,195]};

function stableSeed(s) {
    let h = 0;
    for(let i = 0; i < s.length; i++) h = Math.imul(31, h) + s.charCodeAt(i) | 0;
    return Math.abs(h);
}

function saveData() {
    localStorage.setItem('centurion_data', JSON.stringify({user, snackLog, selDate: selDate.toISOString()}));
}

function loadData() {
    const raw = localStorage.getItem('centurion_data');
    if (raw) {
        const data = JSON.parse(raw);
        user = data.user || 'J';
        snackLog = data.snackLog || {};
        if(data.selDate) selDate = new Date(data.selDate);
    }
}

function switchU(uID, save=true) {
    user=uID;
    document.querySelectorAll('.u-badge').forEach(b=>b.classList.remove('active'));
    document.getElementById('b'+uID.toLowerCase()).classList.add('active');
    render();
    if(save) saveData();
}

function changeW(d){ selDate.setDate(selDate.getDate() + (d*7)); render(); saveData(); }
function resetD(){ selDate = new Date(); selDate.setHours(12,0,0,0); render(); saveData(); }

function openR(n, i, a, t) {
    document.getElementById('mTitle').innerText = n;
    const wrapper = document.getElementById('mImgWrapper');
    wrapper.innerHTML = '<div class="img-loader">‚ú® Chef is plating...</div>';
    
    const cleanName = n.replace(/[^a-zA-Z ]/g, "").trim();
    const seed = stableSeed(cleanName);
    const prompt = encodeURIComponent(`food photo of ${cleanName}, plated, restaurant lighting`);
    const imgUrl = `https://image.pollinations.ai/prompt/${prompt}?width=800&height=600&seed=${seed}&nologo=true&model=turbo`;

    const img = document.createElement("img");
    img.className = "meal-img";
    img.alt = cleanName;
    img.decoding = "async";
    img.loading = "eager";
    
    const kill = setTimeout(() => {
        if (!img.complete) img.src = "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=800&q=80";
    }, 4200000); // 70 Minutes

    img.onload = () => {
        clearTimeout(kill);
        img.style.opacity = "1";
        img.style.filter = "blur(0)";
    };
    img.onerror = () => {
        img.src = "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=800&q=80";
        img.style.opacity = "1";
        img.style.filter = "blur(0)";
    };

    wrapper.appendChild(img);
    setTimeout(() => img.src = imgUrl, 50);

    document.getElementById('mBody').innerHTML = `<p>${t}</p><br><strong>Ingredients:</strong><br>${i.split(',').join(' ‚Ä¢ ')}`;
    document.getElementById('masterModal').style.display = 'block';
}

function render() {
    const start = new Date(selDate);
    start.setDate(selDate.getDate() - (selDate.getDay() === 0 ? 6 : selDate.getDay() - 1));
    const days = ["MON","TUE","WED","THU","FRI","SAT","SUN"];
    const tabs = document.getElementById('dayTabs'); tabs.innerHTML = '';
    
    document.getElementById('dateDisplay').innerText = start.toLocaleDateString('en-US', {month:'short', day:'numeric'}) + " - " + 
        new Date(start.getTime() + 6*864e5).toLocaleDateString('en-US', {month:'short', day:'numeric'});

    for(let i=0; i<7; i++) {
        let d = new Date(start.getTime() + i*864e5);
        const active = d.toDateString() === selDate.toDateString();
        const tab = document.createElement('div');
        tab.className = 'tab' + (active ? ' active' : '');
        tab.innerHTML = `${days[i]}<br>${d.getDate()}`;
        tab.onclick = () => { selDate = d; render(); saveData(); };
        tabs.appendChild(tab);
        if(active) showDay(d, i);
    }
}

function showDay(dObj, idx) {
    const id = Math.abs(stableSeed(dObj.toDateString()));
    const dateKey = dObj.toDateString();
    if(!snackLog[dateKey]) snackLog[dateKey] = [null, null];
    const snacks = snackLog[dateKey];

    const b = mDB.b[id % mDB.b.length].split('|');
    const l = mDB.l[id % mDB.l.length].split('|');
    const dn = mDB.d[id % mDB.d.length].split('|');
    const jcs = ["PLASMA FLUSH Juice","TITAN RED Juice","ZENITH GREEN Juice","TITAN RED Juice","ZENITH GREEN Juice","TITAN RED Juice","APOLLO GOLD Juice"];
    const j = jDB[jcs[idx]];

    const sc = (user==='J') ? 1 : 0.6;
    let p = Math.round((parseInt(b[4])+parseInt(l[4])+parseInt(dn[4]))*sc) + j[2];
    let c = Math.round((parseInt(b[5])+parseInt(l[5])+parseInt(dn[5]))*sc) + j[3];
    let k = Math.round((parseInt(b[6])+parseInt(l[6])+parseInt(dn[6]))*sc) + j[4];
    
    let snackHTML = '<div class="snack-grid">';
    snacks.forEach((sIdx, i) => {
        if(sIdx === null) {
            snackHTML += `<div class="snack-slot" onclick="openSnackSelector(${i})">Ôºã ADD</div>`;
        } else {
            const s = mDB.s[sIdx].split('|');
            p += parseInt(s[4]); c += parseInt(s[5]); k += parseInt(s[6]);
            snackHTML += `<div class="snack-slot filled" onclick="openR('${s[0]}','${s[1]}','','${s[3]}')">
                <div class="remove-snack" onclick="event.stopPropagation(); removeSnack(${i})">‚úï</div>
                <div class="snack-label">${s[0]}</div></div>`;
        }
    });
    snackHTML += '</div>';

    const g = (user==='J') ? {P:165, C:160, K:2200, F:35} : {P:105, C:55, K:1300, F:25};
    let f = Math.round(c * 0.2);

    document.getElementById('dayContent').innerHTML = `
        <div class="card">
            <div class="label">üç≥ Breakfast</div><div class="value" onclick="openR('${b[0]}','${b[1]}','','${b[3]}')">${b[0]}</div>
            <div class="label">ü•ó Lunch</div><div class="value" onclick="openR('${l[0]}','${l[1]}','','${l[3]}')">${l[0]}</div>
            <div class="label">üçΩÔ∏è Dinner</div><div class="value" onclick="openR('${dn[0]}','${dn[1]}','','${dn[3]}')">${dn[0]}</div>
            <div class="label">ü•ú Snacks</div>${snackHTML}
        </div>
        <div class="macro-dashboard">
            <div class="macro-row"><div class="macro-label"><span>PROTEIN</span><span>${p}g/${g.P}g</span></div><div class="macro-bg"><div class="macro-fill" style="width:${Math.min(p/g.P*100,100)}%; background:var(--g-pro)"></div></div></div>
            <div class="macro-row"><div class="macro-label"><span>FIBER</span><span>${f}g/${g.F}g</span></div><div class="macro-bg"><div class="macro-fill" style="width:${Math.min(f/g.F*100,100)}%; background:var(--g-fib)"></div></div></div>
            <div class="macro-row"><div class="macro-label"><span>CALORIES</span><span>${k}/${g.K}</span></div><div class="macro-bg"><div class="macro-fill" style="width:${Math.min(k/g.K*100,100)}%; background:var(--g-cal)"></div></div></div>
        </div>
        <div class="card" style="text-align:center"><div class="label">JUICE</div><div class="juice-name">${jcs[idx]}</div></div>`;
}

function openSnackSelector(slot) {
    currentSlot = slot;
    let h = '';
    mDB.s.forEach((s, idx) => { h += `<div class="value" onclick="applySnack(${idx})">${s.split('|')[0]}</div>`; });
    document.getElementById('mTitle').innerText = "SELECT SNACK";
    document.getElementById('mImgWrapper').innerHTML = '';
    document.getElementById('mBody').innerHTML = h;
    document.getElementById('masterModal').style.display = 'block';
}

function applySnack(idx) { snackLog[selDate.toDateString()][currentSlot] = idx; closeM(); render(); saveData(); }
function removeSnack(slot) { snackLog[selDate.toDateString()][slot] = null; render(); saveData(); }
function closeM() { document.getElementById('masterModal').style.display = 'none'; }

window.onload = () => { loadData(); render(); };
</script>
</body>
</html>