<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Centurion Minimal Test</title>
<style>
body{background:#000;color:#fff;font-family:system-ui;padding:20px}
button{padding:15px 30px;font-size:16px;margin:10px;cursor:pointer}
#log{background:#111;padding:15px;margin-top:20px;border-radius:8px;max-height:500px;overflow-y:auto;font-family:monospace;font-size:12px}
.log-entry{margin:5px 0;padding:3px}
</style>
</head>
<body>
<h1>ğŸ”¬ Minimal Fetch Test</h1>
<p>Testing if corsproxy.io can reach Oura API</p>

<button onclick="testFetch()">TEST FETCH</button>
<button onclick="clearLog()">CLEAR LOG</button>

<div id="log"></div>

<script>
const TOKEN = 'JSZCKR6G3RYCXSGAMOJK3KAW2CJNAJYF'; // Jermaine's token

function log(msg) {
    const entry = document.createElement('div');
    entry.className = 'log-entry';
    entry.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
    document.getElementById('log').appendChild(entry);
    console.log(msg);
}

function clearLog() {
    document.getElementById('log').innerHTML = '';
}

async function testFetch() {
    log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    log('ğŸ§ª STARTING MINIMAL TEST');
    log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    
    try {
        const today = new Date();
        const dateStr = today.toISOString().split('T')[0];
        log(`ğŸ“… Date: ${dateStr}`);
        
        const url = `https://corsproxy.io/?${encodeURIComponent(`https://api.ouraring.com/v2/usercollection/sleep?start_date=${dateStr}&end_date=${dateStr}`)}`;
        log(`ğŸ”— URL: ${url.substring(0, 80)}...`);
        
        log('ğŸŒ Calling fetch...');
        const response = await fetch(url, {
            headers: {'Authorization': `Bearer ${TOKEN}`}
        });
        
        log(`âœ… Response received!`);
        log(`ğŸ“Š Status: ${response.status} ${response.statusText}`);
        log(`ğŸ“¦ OK: ${response.ok}`);
        
        if (response.ok) {
            const data = await response.json();
            log(`âœ… JSON parsed successfully`);
            log(`ğŸ“ˆ Records: ${data.data?.length || 0}`);
            if (data.data && data.data.length > 0) {
                log(`ğŸ“‹ Sample: ${JSON.stringify(data.data[0]).substring(0, 100)}...`);
            }
        } else {
            const text = await response.text();
            log(`âŒ Error response: ${text.substring(0, 200)}`);
        }
        
        log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
        log('âœ… TEST COMPLETED');
        log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
        
    } catch (error) {
        log(`âŒ ERROR: ${error.name}`);
        log(`âŒ Message: ${error.message}`);
        log(`âŒ Stack: ${error.stack}`);
        log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
        log('âŒ TEST FAILED');
        log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    }
}

log('âœ… Test page loaded - Click TEST FETCH to start');
</script>

</body>
</html>