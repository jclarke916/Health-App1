<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Centurion Minimal Test</title>
<style>
body{background:#000;color:#fff;font-family:system-ui;padding:20px}
button{padding:15px 30px;font-size:16px;margin:10px;cursor:pointer}
#log{background:#111;padding:15px;margin-top:20px;border-radius:8px;max-height:500px;overflow-y:auto;font-family:monospace;font-size:12px}
.log-entry{margin:5px 0;padding:3px}
</style>
</head>
<body>
<h1>ğŸ”¬ Minimal Fetch Test</h1>
<p>Testing if corsproxy.io can reach Oura API</p>

<button onclick="testFetch('corsproxy')">TEST CORSPROXY.IO</button>
<button onclick="testFetch('allorigins')">TEST ALLORIGINS</button>
<button onclick="testFetch('api1')">TEST API.CODETABS</button>
<button onclick="clearLog()">CLEAR LOG</button>

<div id="log"></div>

<script>
const TOKEN = 'JSZCKR6G3RYCXSGAMOJK3KAW2CJNAJYF'; // Jermaine's token

function log(msg) {
    const entry = document.createElement('div');
    entry.className = 'log-entry';
    entry.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
    document.getElementById('log').appendChild(entry);
    console.log(msg);
}

function clearLog() {
    document.getElementById('log').innerHTML = '';
}

async function testFetch(proxy = 'corsproxy') {
    log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    log(`ğŸ§ª TESTING ${proxy.toUpperCase()}`);
    log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    
    try {
        const today = new Date();
        const dateStr = today.toISOString().split('T')[0];
        log(`ğŸ“… Date: ${dateStr}`);
        
        const ouraUrl = `https://api.ouraring.com/v2/usercollection/sleep?start_date=${dateStr}&end_date=${dateStr}`;
        
        let url;
        if (proxy === 'corsproxy') {
            url = `https://corsproxy.io/?${encodeURIComponent(ouraUrl)}`;
        } else if (proxy === 'allorigins') {
            url = `https://api.allorigins.win/raw?url=${encodeURIComponent(ouraUrl)}`;
        } else if (proxy === 'api1') {
            url = `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(ouraUrl)}`;
        }
        
        log(`ğŸ”— Proxy: ${proxy}`);
        log(`ğŸ”— URL: ${url.substring(0, 80)}...`);
        
        log('ğŸŒ Calling fetch...');
        const response = await fetch(url, {
            headers: {'Authorization': `Bearer ${TOKEN}`}
        });
        
        log(`âœ… Response received!`);
        log(`ğŸ“Š Status: ${response.status} ${response.statusText}`);
        log(`ğŸ“¦ OK: ${response.ok}`);
        
        if (response.ok) {
            const data = await response.json();
            log(`âœ… JSON parsed successfully`);
            log(`ğŸ“ˆ Records: ${data.data?.length || 0}`);
            if (data.data && data.data.length > 0) {
                log(`ğŸ“‹ Sample: ${JSON.stringify(data.data[0]).substring(0, 100)}...`);
            }
            log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
            log(`âœ… ${proxy.toUpperCase()} WORKS!`);
            log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
        } else {
            const text = await response.text();
            log(`âŒ Error response: ${text.substring(0, 200)}`);
            log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
            log(`âŒ ${proxy.toUpperCase()} FAILED (${response.status})`);
            log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
        }
        
    } catch (error) {
        log(`âŒ ERROR: ${error.name}`);
        log(`âŒ Message: ${error.message}`);
        log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
        log(`âŒ ${proxy.toUpperCase()} FAILED`);
        log('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    }
}

log('âœ… Test page loaded - Click buttons to test different proxies');
</script>

</body>
</html>