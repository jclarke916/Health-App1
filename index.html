<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Centurion | v225 Streamlined</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-body: #050505; --bg-card: #121212; --text-main: #FFFFFF; --text-muted: #888888;
            --accent-gold: #D4AF37; --glute-pink: #FF4081; --target-green: #00E676;
            --heat-red: #FF3D00; --ice-blue: #00B0FF; --recovery-purple: #D500F9;
            --grad-pro: linear-gradient(90deg, #FF5252, #D50000);
            --grad-carb: linear-gradient(90deg, #FFAB40, #FF6D00);
            --grad-fat: linear-gradient(90deg, #448AFF, #2962FF);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-body); color: var(--text-main); margin: 0; padding: 30px 20px; font-size: 16px; line-height: 1.6; }
        .container { max-width: 600px; margin: 0 auto; width: 100%; position: relative; }
        
        header { text-align: center; margin-bottom: 25px; position: relative; }
        .version-tag { position: absolute; top: 0; right: 0; font-size: 0.6rem; color: #333; font-weight: 800; letter-spacing: 1px; }
        h1 { font-weight: 200; letter-spacing: 4px; text-transform: uppercase; margin: 0; font-size: 1.4rem; color: #fff; }
        
        .profile-badges { display: flex; justify-content: center; gap: 15px; margin-top: 20px; }
        .badge { background: #000; padding: 10px 20px; border-radius: 30px; border: 1px solid #222; font-size: 0.7rem; color: #666; text-transform: uppercase; cursor: pointer; font-weight: 700; transition: 0.3s; }
        .badge.active-user { border-color: var(--accent-gold); color: var(--accent-gold); background: rgba(212, 175, 55, 0.05); }
        .badge.active-user.sophia { border-color: var(--glute-pink); color: var(--glute-pink); background: rgba(255, 64, 129, 0.05); }

        .status-bar { text-align: center; color: var(--text-muted); font-size: 0.75rem; margin: 20px 0; text-transform: uppercase; font-weight: 600; letter-spacing: 2px; }
        
        .controls { display: flex; justify-content: space-between; gap: 10px; margin-bottom: 25px; }
        .nav-btn { background: var(--bg-card); border: 1px solid #222; color: var(--text-muted); padding: 14px 0; width: 24%; border-radius: 12px; cursor: pointer; font-size: 0.65rem; font-weight: 800; text-transform: uppercase; }
        .grocery-btn { color: var(--target-green); border-color: rgba(0, 230, 118, 0.2); background: rgba(0, 230, 118, 0.05); }

        .tabs { display: flex; justify-content: space-between; background: var(--bg-card); padding: 5px; border-radius: 16px; margin-bottom: 30px; border: 1px solid #222; }
        .tab-btn { background: none; border: none; color: #555; padding: 12px 0; cursor: pointer; flex: 1; font-size: 0.7rem; display: flex; flex-direction: column; align-items: center; border-radius: 12px; }
        .tab-btn.active { color: #fff; background: #222; font-weight: 700; }

        /* CARDS */
        .card { background: var(--bg-card); border-radius: 20px; padding: 25px; margin-bottom: 20px; border: 1px solid #222; box-shadow: 0 10px 30px -10px rgba(0,0,0,0.5); }
        
        /* 1. WORKOUT HEADER (Clickable) */
        .workout-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; cursor: pointer; border-bottom: 1px solid #1a1a1a; padding-bottom: 15px; }
        .workout-title { font-size: 1rem; font-weight: 800; text-transform: uppercase; color: #fff; display: flex; flex-direction: column; }
        .workout-sub { font-size: 0.6rem; color: var(--recovery-purple); font-weight: 600; margin-top: 4px; letter-spacing: 1px; }
        .carb-pill { font-size: 0.6rem; font-weight: 900; padding: 5px 10px; border-radius: 6px; color: #fff; text-transform: uppercase; letter-spacing: 1px; }

        /* 2. THREE BAR GOAL SYSTEM */
        .goal-system { margin-bottom: 25px; }
        .goal-row { display: flex; align-items: center; margin-bottom: 12px; }
        .goal-label { width: 50px; font-size: 0.65rem; color: #666; font-weight: 800; text-transform: uppercase; }
        .goal-track { flex: 1; height: 6px; background: #1a1a1a; border-radius: 10px; margin: 0 12px; overflow: hidden; }
        .goal-fill { height: 100%; border-radius: 10px; }
        .goal-val { width: 50px; text-align: right; font-size: 0.7rem; color: #fff; font-weight: 700; }
        
        /* 3. CLICKABLE PROTOCOLS */
        .protocol-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 10px; }
        .proto-btn { 
            background: #0a0a0a; border: 1px solid #222; color: #666; 
            padding: 15px 0; border-radius: 12px; text-align: center; cursor: pointer; transition: 0.2s;
            display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 5px;
        }
        .proto-icon { font-size: 1.2rem; margin-bottom: 2px; }
        .proto-name { font-size: 0.6rem; font-weight: 800; text-transform: uppercase; letter-spacing: 0.5px; }
        .proto-btn.active { border-color: var(--target-green); color: var(--target-green); background: rgba(0, 230, 118, 0.05); }

        /* MEALS */
        .meal-row { margin-bottom: 20px; border-left: 2px solid #222; padding-left: 15px; cursor: pointer; transition: 0.2s; }
        .meal-row:hover { border-left-color: var(--accent-gold); }
        .meal-lbl { font-size: 0.6rem; color: #555; font-weight: 800; text-transform: uppercase; margin-bottom: 4px; }
        .meal-val { font-size: 1rem; color: #fff; font-weight: 500; }

        /* MODALS */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); backdrop-filter: blur(5px); overflow-y: auto; padding: 20px; }
        .modal-content { background: #121212; margin: 40px auto; padding: 30px; border: 1px solid #333; width: 100%; max-width: 600px; border-radius: 20px; }
        .close-btn { float: right; font-size: 1.5rem; cursor: pointer; color: #666; }
        
        /* RECOVERY STREAMLINE */
        .rec-timeline { position: relative; padding-left: 20px; border-left: 2px solid #222; margin-top: 20px; }
        .rec-node { margin-bottom: 30px; position: relative; }
        .rec-node::before { content: ''; position: absolute; left: -26px; top: 5px; width: 10px; height: 10px; border-radius: 50%; background: #333; }
        .rec-node.warmup::before { background: var(--heat-red); }
        .rec-node.gym::before { background: var(--ice-blue); }
        .rec-node.home::before { background: var(--recovery-purple); }
        
        .rec-cat { font-size: 0.7rem; font-weight: 900; text-transform: uppercase; margin-bottom: 8px; letter-spacing: 1px; }
        .rec-item { font-size: 0.95rem; color: #fff; margin-bottom: 4px; }
        .rec-desc { font-size: 0.8rem; color: #777; font-style: italic; }

        .chef-steps { counter-reset: step; color: #ccc; font-size: 0.9rem; line-height: 1.6; margin-top: 20px; }
        .chef-steps p { margin-bottom: 20px; position: relative; padding-left: 30px; }
        .chef-steps p::before { counter-increment: step; content: counter(step); position: absolute; left: 0; top: 2px; color: var(--accent-gold); font-weight: 800; font-size: 0.8rem; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="version-tag">v225</div>
        <h1>CENTURION</h1>
        <div class="profile-badges">
            <div id="badgeJ" class="badge active-user" onclick="switchUser('J')">Jermaine</div>
            <div id="badgeS" class="badge" onclick="switchUser('S')">Sophia</div>
        </div>
    </header>
    
    <div id="dateRangeDisplay" class="status-bar">...</div>
    
    <div class="controls">
        <button class="nav-btn" onclick="changeWeek(-1)">PREV</button>
        <button class="nav-btn" onclick="resetToCurrent()">TODAY</button>
        <button class="nav-btn" onclick="changeWeek(1)">NEXT</button>
        <button class="nav-btn grocery-btn" onclick="generateGroceryList()">SHOP</button>
    </div>
    
    <div id="dayTabs" class="tabs"></div>
    <div id="dayContent"></div>
</div>

<div id="recipeModal" class="modal"><div class="modal-content">
    <span class="close-btn" onclick="closeModal('recipeModal')">&times;</span>
    <h2 id="modalTitle" style="color:#fff; margin-top:0; margin-bottom:10px;"></h2>
    <div id="modalTimeBadge" style="background:#222; display:inline-block; padding:5px 10px; border-radius:5px; font-size:0.7rem; color:#aaa; margin-bottom:20px;"></div>
    <div style="color:var(--accent-gold); font-size:0.7rem; font-weight:800; margin-bottom:10px;">INGREDIENTS</div>
    <ul id="modalIng" style="color:#ccc; padding-left:20px; margin-bottom:25px; font-size:0.9rem;"></ul>
    <div style="color:var(--accent-gold); font-size:0.7rem; font-weight:800; margin-bottom:10px;">CHEF PREPARATION</div>
    <div id="modalSteps" class="chef-steps"></div>
    <div style="background:#1a050a; border:1px solid var(--glute-pink); padding:15px; border-radius:10px; margin-top:20px;">
        <div style="color:var(--glute-pink); font-size:0.7rem; font-weight:800; text-transform:uppercase;">üçë Sophia's Mod</div>
        <div id="modalMod" style="color:#fff; font-size:0.85rem; margin-top:5px;"></div>
    </div>
</div></div>

<div id="protocolDetailModal" class="modal"><div class="modal-content">
    <span class="close-btn" onclick="closeModal('protocolDetailModal')">&times;</span>
    <h2 id="pdTitle" style="color:var(--target-green); margin-top:0;"></h2>
    <div style="font-size:1.2rem; color:#fff; font-weight:700; margin-bottom:5px;" id="pdAmount"></div>
    <div style="font-size:0.9rem; color:var(--ice-blue); margin-bottom:20px;" id="pdTime"></div>
    <div style="font-size:0.95rem; color:#ccc; line-height:1.6;" id="pdBenefits"></div>
    <button id="pdCompleteBtn" style="width:100%; padding:15px; margin-top:25px; background:var(--target-green); border:none; border-radius:10px; font-weight:800; cursor:pointer;">MARK AS DONE</button>
</div></div>

<div id="recoveryModal" class="modal"><div class="modal-content">
    <span class="close-btn" onclick="closeModal('recoveryModal')">&times;</span>
    <h2 id="recTitle" style="color:#fff; margin-top:0; text-transform:uppercase;"></h2>
    <div style="color:#666; font-size:0.8rem; font-style:italic;">Daily Recovery Protocol</div>
    
    <div class="rec-timeline">
        <div class="rec-node warmup">
            <div class="rec-cat" style="color:var(--heat-red)">PRE-WORKOUT</div>
            <div id="recWarmup"></div>
        </div>
        <div class="rec-node gym">
            <div class="rec-cat" style="color:var(--ice-blue)">GYM AMENITIES</div>
            <div id="recGym"></div>
        </div>
        <div class="rec-node home">
            <div class="rec-cat" style="color:var(--recovery-purple)">HOME RESTORATION</div>
            <div id="recHome"></div>
        </div>
    </div>
</div></div>

<div id="groceryModal" class="modal"><div class="modal-content">
    <span class="close-btn" onclick="closeModal('groceryModal')">&times;</span>
    <h2 style="color:var(--target-green); margin-top:0;">üõí GROCERY LIST</h2>
    <div id="groceryList" style="color:#ccc; line-height:1.6;"></div>
</div></div>

<script>
    let currentUser = 'J'; 
    let dayState = {}; 
    let selectedDateStr = "";
    
    const protocolDetails = {
        "sea": { title: "SEA MOSS", amount: "2 Tbsp (Gel)", time: "First thing AM", benefits: "Thyroid support & gut lining repair." },
        "kom": { title: "KOMBUCHA", amount: "4-6 oz", time: "Before Lunch", benefits: "Probiotics & insulin blunting." },
        "water": { title: "HYDRATION", amount: "1 Gallon", time: "All Day", benefits: "Flush toxins & muscle fullness." }
    };
    
    const recipeDB = {
        "Bison Steak & Eggs": { time: "35 MIN", ing: ["6oz Bison Sirloin", "2 Eggs", "Asparagus"], steps: ["Sear steak 3m/side.", "Fry eggs."], mod: "3oz bison." },
        "Crab Scramble": { time: "15 MIN", ing: ["4oz Crab", "3 Egg Whites", "Spinach"], steps: ["Fold crab into eggs."], mod: "3oz crab." },
        "Japanese Tamagoyaki": { time: "25 MIN", ing: ["4 Eggs", "Dashi", "Sesame Oil"], steps: ["Layered rolled omelet."], mod: "1.5 palms." },
        "Sea Moss Smoothie": { time: "5 MIN", ing: ["2tbsp Sea Moss", "Blueberries", "Protein"], steps: ["Blend."], mod: "Add collagen." },
        "Southwest Bison Scramble": { time: "20 MIN", ing: ["4oz Bison", "3 Egg Whites", "Poblano"], steps: ["Brown bison."], mod: "3oz." },
        "Avocado Toast (Sprouted)": { time: "10 MIN", ing: ["Sprouted Bread", "1/2 Avocado", "2 Eggs"], steps: ["Toast & Assemble."], mod: "1 slice." },
        "Sprouted Breakfast Wrap": { time: "15 MIN", ing: ["Tortilla", "3 Eggs", "Turkey Bacon"], steps: ["Crisp bacon, wrap."], mod: "1/2 wrap." },
        "Bison Laab": { time: "25 MIN", ing: ["Bison", "Lime", "Mint", "Fish Sauce"], steps: ["Cook meat, toss in sauce."], mod: "3oz." },
        "Stealth Liver Sliders": { time: "30 MIN", ing: ["Bison/Liver", "Mushrooms", "Paprika"], steps: ["Grill 4m/side."], mod: "1 slider." },
        "Chicken Satay": { time: "30 MIN", ing: ["Chicken", "Peanut Butter", "Soy Sauce"], steps: ["Grill skewers."], mod: "3oz." },
        "Sardine Bowl": { time: "5 MIN", ing: ["Sardines", "Avocado", "Radish"], steps: ["Mash & Serve."], mod: "1.5 palms." },
        "Squid Ink Risotto": { time: "45 MIN", ing: ["Squid", "Cauli Rice", "Ink", "Garlic"], steps: ["Simmer rice with ink."], mod: "1/2 cup." },
        "Thai Beef Salad": { time: "30 MIN", ing: ["Steak", "Lemongrass", "Chili", "Lime"], steps: ["Grill & Slice."], mod: "2oz." }
    };

    const macroTargets = { 'J': { 'HIGH CARB': { p: 160, c: 300, f: 75 }, 'LOW CARB': { p: 160, c: 80, f: 100 } }, 'S': { 'HIGH CARB': { p: 105, c: 180, f: 55 }, 'LOW CARB': { p: 105, c: 50, f: 70 } } };
    
    // Default macros for demo (simplified)
    const mealMacros = { p: 40, c: 30, f: 15 }; 

    const weeklySchedule = [
        { w: "REST & RECOVERY", c: "LOW CARB", rec: {warm: "Light Stretching", gym: "Sauna (20m)", home: "Epsom Salt Bath"} }, 
        { w: "CHEST & TRICEPS", c: "HIGH CARB", rec: {warm: "Rotator Cuff Bands", gym: "Steam Room (15m)", home: "Ice Pack on Shoulders"} }, 
        { w: "BACK & BICEPS", c: "HIGH CARB", rec: {warm: "Lat Activation", gym: "Cold Plunge", home: "Foam Roll Lats"} }, 
        { w: "LEGS & GLUTES", c: "HIGH CARB", rec: {warm: "Hip Openers", gym: "Sauna (15m)", home: "Theragun Quads"} }, 
        { w: "ACTIVE REST", c: "LOW CARB", rec: {warm: "Walking", gym: "Jacuzzi", home: "Magnesium Oil"} }, 
        { w: "SHOULDERS & ARMS", c: "HIGH CARB", rec: {warm: "Band Pull-Aparts", gym: "Steam Room", home: "Elevation"} }, 
        { w: "GLUTE FOCUS", c: "HIGH CARB", rec: {warm: "Glute Bridges", gym: "Sauna", home: "Stretching"} }  
    ];
    
    const meals = [
        {b: "Bison Steak & Eggs", l: "Bison Laab", d: "Squid Ink Risotto"},
        {b: "Crab Scramble", l: "Stealth Liver Sliders", d: "Thai Beef Salad"},
        {b: "Japanese Tamagoyaki", l: "Chicken Satay", d: "Squid Ink Risotto"},
        {b: "Sea Moss Smoothie", l: "Sardine Bowl", d: "Thai Beef Salad"},
        {b: "Southwest Bison Scramble", l: "Bison Laab", d: "Squid Ink Risotto"},
        {b: "Avocado Toast (Sprouted)", l: "Stealth Liver Sliders", d: "Thai Beef Salad"},
        {b: "Sprouted Breakfast Wrap", l: "Chicken Satay", d: "Squid Ink Risotto"}
    ];

    let weekOffset = 0; let selectedDayIndex = 0; let selectedDateObj = new Date();

    function getMonday(offset) { 
        let d = new Date(); let day = d.getDay(), diff = d.getDate() - day + (day == 0 ? -6:1); 
        let mon = new Date(d.setDate(diff)); mon.setDate(mon.getDate() + (offset * 7)); return mon; 
    }

    function switchUser(user) { 
        currentUser = user; 
        document.getElementById('badgeJ').classList.toggle('active-user', user === 'J');
        document.getElementById('badgeS').classList.toggle('active-user', user === 'S');
        showDay(selectedDateObj, selectedDayIndex); 
    }

    function renderTabs() { 
        const tabsContainer = document.getElementById('dayTabs'); tabsContainer.innerHTML = '';
        const mon = getMonday(weekOffset); const days = ['M','T','W','T','F','S','S'];
        let start = new Date(mon); let end = new Date(mon); end.setDate(end.getDate()+6);
        document.getElementById('dateRangeDisplay').innerText = `${start.toLocaleDateString()} - ${end.toLocaleDateString()}`;
        for(let i=0; i<7; i++) {
            let d = new Date(mon); d.setDate(mon.getDate() + i);
            let btn = document.createElement('button');
            btn.className = 'tab-btn' + (i === selectedDayIndex ? ' active' : '');
            btn.innerHTML = `${d.getDate()}<span>${days[i]}</span>`;
            btn.onclick = () => { selectedDayIndex = i; selectedDateObj = d; renderTabs(); showDay(d, i); };
            tabsContainer.appendChild(btn);
        }
    }

    function getDayState(dateKey) { 
        if (!dayState[dateKey]) dayState[dateKey] = { proto: {sea: false, kom: false, water: false} }; 
        return dayState[dateKey]; 
    }

    function showDay(dateObj, dayIndex) { 
        let schedIndex = (dayIndex + 1) % 7; 
        let sched = weeklySchedule[schedIndex];
        let mealPlan = meals[schedIndex]; 
        const state = getDayState(dateObj.toDateString());
        const goals = macroTargets[currentUser][sched.c];
        
        // Mock current totals
        const currentP = 110; const currentC = 90; const currentF = 45; 
        const pct = (val, max) => Math.min(100, (val/max)*100) + '%';
        const pColor = currentUser === 'J' ? 'var(--accent-gold)' : 'var(--glute-pink)';

        let html = `
            <div class="workout-header" onclick="openRecovery(${schedIndex})">
                <div class="workout-title" style="color:${pColor}">
                    ${sched.w}
                    <span class="workout-sub">TAP FOR RECOVERY &rarr;</span>
                </div>
                <div class="carb-pill" style="background:${sched.c==='HIGH CARB'?'var(--heat-red)':'#333'}">${sched.c}</div>
            </div>

            <div class="card goal-system">
                <div class="goal-row">
                    <div class="goal-label">PRO</div>
                    <div class="goal-track"><div class="goal-fill" style="width:${pct(currentP, goals.p)}; background:var(--grad-pro)"></div></div>
                    <div class="goal-val">${currentP}/${goals.p}</div>
                </div>
                <div class="goal-row">
                    <div class="goal-label">CARB</div>
                    <div class="goal-track"><div class="goal-fill" style="width:${pct(currentC, goals.c)}; background:var(--grad-carb)"></div></div>
                    <div class="goal-val">${currentC}/${goals.c}</div>
                </div>
                <div class="goal-row">
                    <div class="goal-label">FAT</div>
                    <div class="goal-track"><div class="goal-fill" style="width:${pct(currentF, goals.f)}; background:var(--grad-fat)"></div></div>
                    <div class="goal-val">${currentF}/${goals.f}</div>
                </div>
            </div>

            <div class="protocol-grid">
                <div class="proto-btn ${state.proto.sea ? 'active' : ''}" onclick="openProtocolDetail('sea')">
                    <div class="proto-icon">ü™∏</div><div class="proto-name">SEA MOSS</div>
                </div>
                <div class="proto-btn ${state.proto.kom ? 'active' : ''}" onclick="openProtocolDetail('kom')">
                    <div class="proto-icon">ü•É</div><div class="proto-name">KOMBUCHA</div>
                </div>
                <div class="proto-btn ${state.proto.water ? 'active' : ''}" onclick="openProtocolDetail('water')">
                    <div class="proto-icon">üíß</div><div class="proto-name">WATER</div>
                </div>
            </div>

            <div class="card">
                <div class="meal-row" onclick="openRecipe('${mealPlan.b}')">
                    <div class="meal-lbl">Breakfast</div>
                    <div class="meal-val">${mealPlan.b}</div>
                </div>
                <div class="meal-row" onclick="openRecipe('${mealPlan.l}')">
                    <div class="meal-lbl">Lunch</div>
                    <div class="meal-val">${mealPlan.l}</div>
                </div>
                <div class="meal-row" style="margin-bottom:0;" onclick="openRecipe('${mealPlan.d}')">
                    <div class="meal-lbl">Dinner</div>
                    <div class="meal-val">${mealPlan.d}</div>
                </div>
            </div>
        `;
        document.getElementById('dayContent').innerHTML = html;
    }

    // --- MODAL FUNCTIONS ---
    let currentProto = null;
    function openProtocolDetail(type) { 
        currentProto = type; const data = protocolDetails[type]; 
        document.getElementById('pdTitle').innerText = data.title; 
        document.getElementById('pdAmount').innerText = data.amount; 
        document.getElementById('pdTime').innerText = "Best time: " + data.time; 
        document.getElementById('pdBenefits').innerText = data.benefits; 
        
        const btn = document.getElementById('pdCompleteBtn');
        const state = getDayState(selectedDateObj.toDateString());
        if(state.proto[type]) {
            btn.innerText = "COMPLETED"; btn.style.background = "#333"; btn.style.color = "#666";
        } else {
            btn.innerText = "MARK AS DONE"; btn.style.background = "var(--target-green)"; btn.style.color = "#000";
            btn.onclick = () => { state.proto[type] = true; closeModal('protocolDetailModal'); showDay(selectedDateObj, selectedDayIndex); };
        }
        openModal('protocolDetailModal'); 
    }

    function openRecovery(idx) {
        let sched = weeklySchedule[idx];
        document.getElementById('recTitle').innerText = sched.w;
        // Helper to format
        const fmt = (txt) => `<div class="rec-item">${txt.split('(')[0]}</div><div class="rec-desc">${txt.split('(')[1] ? '('+txt.split('(')[1] : ''}</div>`;
        document.getElementById('recWarmup').innerHTML = fmt(sched.rec.warm);
        document.getElementById('recGym').innerHTML = fmt(sched.rec.gym);
        document.getElementById('recHome').innerHTML = fmt(sched.rec.home);
        openModal('recoveryModal');
    }

    function openRecipe(n) { 
        let r = recipeDB[n] || recipeDB["Bison Steak & Eggs"]; 
        document.getElementById('modalTitle').innerText = n; 
        document.getElementById('modalTimeBadge').innerText = r.time;
        document.getElementById('modalIng').innerHTML = r.ing.map(i => `<li>${i}</li>`).join('');
        document.getElementById('modalSteps').innerHTML = r.steps.map(s => `<p>${s}</p>`).join(''); 
        document.getElementById('modalMod').innerText = r.mod; 
        openModal('recipeModal'); 
    }

    function generateGroceryList() { 
        document.getElementById('groceryList').innerHTML = "<ul><li>6x 8oz Bison Steaks</li><li>2 Dozen Pasture Eggs</li><li>1 Bag Spinach</li><li>1 Bag Cauliflower Rice</li><li>1 Jar Sea Moss</li></ul>";
        openModal('groceryModal');
    }

    function openModal(id) { document.getElementById(id).style.display = 'block'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    function changeWeek(dir) { weekOffset += dir; renderTabs(); }
    function resetToCurrent() { weekOffset = 0; renderTabs(); showDay(new Date(), new Date().getDay() === 0 ? 6 : new Date().getDay() - 1); }

    window.onload = function() { 
        let d = new Date(); let dayIndex = d.getDay() === 0 ? 6 : d.getDay() - 1; 
        selectedDateObj = d; selectedDayIndex = dayIndex;
        renderTabs(); showDay(d, dayIndex); 
    };
</script>
</body>
</html>