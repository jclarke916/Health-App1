<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Centurion | v222.53 Core</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root{--bg:#050505;--card:#141414;--gold:#D4AF37;--green:#00E676;--blue:#00B0FF;--purple:#D500F9;--text:#fff;--g-pro:linear-gradient(90deg,#FF5252,#D50000);--g-carb:linear-gradient(90deg,#FFAB40,#FF6D00);--g-cal:linear-gradient(90deg,#B388FF,#6200EA)}
        *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
        body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);margin:0;padding:15px;font-size:14px}
        .container{max-width:500px;margin:0 auto}
        h1{text-align:center;font-weight:200;letter-spacing:5px;text-transform:uppercase;font-size:1.2rem;margin:10px 0}
        .badge-row{display:flex;justify-content:center;gap:8px;margin-bottom:15px}
        .u-badge{background:#000;padding:8px 16px;border-radius:20px;border:1px solid #333;font-size:0.6rem;font-weight:800;cursor:pointer;color:#666}
        .u-badge.active{border-color:var(--gold);color:var(--gold)}
        .status-bar{text-align:center;color:#888;font-size:0.65rem;font-weight:800;margin-bottom:10px;text-transform:uppercase}
        .controls{display:flex;gap:5px;margin-bottom:15px}
        .nav-btn{background:#111;border:1px solid #222;color:#888;padding:10px;flex:1;border-radius:8px;font-size:0.55rem;font-weight:800;cursor:pointer}
        .card, .macro-dashboard{background:var(--card);border-radius:20px;padding:20px;margin-bottom:15px;border:1px solid rgba(255,255,255,0.03);position:relative}
        .card::before{content:"";position:absolute;left:0;top:20px;bottom:20px;width:3px;background:var(--gold);border-radius:0 4px 4px 0}
        .label{color:#666;font-size:0.5rem;text-transform:uppercase;font-weight:900;margin-bottom:4px}
        
        /* UPDATED VALUE CLASS FOR ALIGNMENT */
        .value{
            font-size: 0.95rem;
            margin-bottom: 12px;
            font-weight: 500;
            cursor: pointer;
            border-bottom: 1px solid #222;
            padding-bottom: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .proto-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-top:10px;border-top:1px solid #222;padding-top:15px}
        .proto-box{background:#0a0a0a;border:1px solid #333;padding:8px 2px;border-radius:8px;text-align:center;font-size:0.5rem;font-weight:800;cursor:pointer}
        .proto-box.active{border-color:var(--green);color:var(--green)}
        .proto-box.rec{border-color:var(--purple);color:var(--purple)}
        .p-qty{display:block;color:#fff;font-size:0.6rem;margin-bottom:2px}
        .macro-row{margin-bottom:10px}
        .macro-label{display:flex;justify-content:space-between;font-size:0.55rem;font-weight:800;color:#777;margin-bottom:3px}
        .macro-bg{height:5px;background:#222;border-radius:10px;overflow:hidden}
        .macro-fill{height:100%;border-radius:10px;transition:width 0.8s}
        .tabs{display:flex;gap:4px;margin-bottom:15px}
        .tab{flex:1;padding:10px 0;background:#111;border:1px solid #222;color:#444;border-radius:8px;font-size:0.55rem;font-weight:800;text-align:center;cursor:pointer}
        .tab.active{background:#222;color:#fff;border-color:444}
        .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.98);padding:20px;z-index:1000;overflow-y:auto}
        .modal-content{background:#0a0a0a;margin:10px auto;padding:25px;border:1px solid #333;border-radius:20px;max-width:450px}
        .chef-steps p{position:relative;padding-left:30px;color:#ccc;margin:10px 0;font-size:0.8rem;line-height:1.4}
        .chef-steps p::before{counter-increment:step;content:counter(step);position:absolute;left:0;width:18px;height:18px;background:#222;color:var(--gold);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.6rem;font-weight:800}
        .chef-tip{color:var(--gold);font-size:0.75rem;font-weight:700;margin-top:15px;padding:10px;border:1px dashed var(--gold);border-radius:10px}
        .juice-name{font-size:1.1rem;font-weight:900;color:#fff;text-align:center;text-transform:uppercase;cursor:pointer;border:1px dashed #333;padding:10px;border-radius:12px}
        /* BIO BAR SYSTEM */
        .bio-section{margin-bottom:25px;padding:15px;background:rgba(255,255,255,0.03);border-radius:15px;border:1px solid rgba(255,255,255,0.05)}
        .bio-title{display:flex;justify-content:space-between;font-size:0.75rem;font-weight:800;color:#fff;margin-bottom:12px;text-transform:uppercase}
        .bar-group{display:flex;flex-direction:column;gap:8px}
        .bar-row{display:flex;align-items:center}
        .bar-lbl{width:45px;font-size:0.55rem;color:#666;font-weight:900;text-transform:uppercase}
        .bar-track{flex:1;height:8px;background:#111;border-radius:10px;margin:0 10px;border:1px solid #222;overflow:hidden}
        .bar-fill{height:100%;border-radius:10px;transition:width 1s cubic-bezier(0.4,0,0.2,1)}
        .bar-fill.past{background:#333}
        .bar-fill.now{background:var(--gold);box-shadow:0 0 10px rgba(212,175,55,0.3)}
        .bar-fill.goal{background:var(--green);box-shadow:0 0 12px rgba(0,230,118,0.4)}
        .rec-phase-list { position: relative; padding-left: 25px; margin-top: 20px; }
        .rec-phase-list::before { content: ''; position: absolute; left: 8px; top: 0; bottom: 0; width: 2px; background: linear-gradient(to bottom, var(--blue), var(--purple)); }
        .phase-item { position: relative; margin-bottom: 25px; }
        .phase-item::after { content: ''; position: absolute; left: -22px; top: 5px; width: 10px; height: 10px; background: var(--bg); border: 2px solid var(--blue); border-radius: 50%; }
        .phase-time { font-size: 0.6rem; font-weight: 900; color: var(--blue); text-transform: uppercase; letter-spacing: 1px; }
        .phase-title { display: block; font-size: 0.9rem; font-weight: 700; color: #fff; margin: 2px 0; }
        .phase-detail { font-size: 0.75rem; color: #999; line-height: 1.4; display: block; }
        
        /* NEW PILL STYLE */
        .macro-pill {
            background: #1a1a1a;
            border: 1px solid #333;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.55rem;
            color: #888;
            font-weight: 800;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            white-space: nowrap;
        }
    </style>
</head>
<body>
<div class="container">
    <header><h1>THE CENTURION</h1>
        <div class="badge-row">
            <div id="bj" class="u-badge active" onclick="switchU('J')">üßîüèæ‚Äç‚ôÇÔ∏è JERMAINE</div>
            <div id="bs" class="u-badge" onclick="switchU('S')">üë©üèæ‚Äçü¶± SOPHIA</div>
        </div>
    </header>
    <div id="dateDisplay" class="status-bar">...</div>
    <div class="controls">
        <button class="nav-btn" onclick="changeW(-1)">PREV</button>
        <button class="nav-btn" onclick="resetD()">TODAY</button>
        <button class="nav-btn" onclick="changeW(1)">NEXT</button>
        <button class="nav-btn" onclick="openBio()" style="color:var(--green)">MY DATA</button>
    </div>
    <div id="dayTabs" class="tabs"></div>
    <div id="dayContent"></div>
</div>
<div id="masterModal" class="modal"><div class="modal-content"><span onclick="closeM()" style="float:right;cursor:pointer">&times;</span><h2 id="mTitle"></h2><div id="mSub" style="color:var(--gold);font-size:0.7rem;margin:10px 0"></div><div id="mBody" class="chef-steps" style="counter-reset:step"></div><div id="mTip" class="chef-tip"></div></div></div>

<script>
let user='J', offset=0, selDate=new Date();
let dailySnack = null; 

const rDB = {
    "Sea Moss": ["92 Minerals","2 TBSP Fasted.","Thyroid & Gut support."],
    "Kombucha": ["Probiotic","4 OZ post-Lunch.","Enzyme support."],
    "Aqua Chair": ["Hydro-Massage","Align body to zero-gravity.","Jets to glutes and lats.","20 Min Duration."],
    "Sauna": ["HSP Induction","185¬∞F Range.","20 Mins total.","Heavy metal detox sweat."],
    "Theragun": ["Percussive","Float over muscles.","2m per limb.","Target Lats/Hips."],
    "Normatec": ["Compression","Level 4 Intensity.","Full leg cycle.","30m Lymphatic flush."],
    "Pre-Workout": ["Nitro-Boost","6g Citrulline Malate.","Take 20m before training."]
};

const jDB = {
    "PLASMA FLUSH": ["Recovery","3c Watermelon, 1 Lime",1,32,140],
    "TITAN RED": ["Endurance","2 Beets, 2 Carrots, Pom",3,42,185],
    "ZENITH GREEN": ["Alkalizer","4 Kale, 1 Cucumber",4,18,90],
    "APOLLO GOLD": ["Anti-Inflammatory","2 Pears, Turmeric",1,45,195]
};

// ADDED MACROS TO ALL MEALS: |Protein|Carbs|Calories
const mDB = {
    b: [
        "Japanese Tamagoyaki|Eggs,Dashi,Zucchini|roll|Roll tight.|22|4|210",
        "Bison & Eggs|Bison,Eggs,Asparagus|sear|Sear 400F.|45|2|480",
        "Protein Wrap|Tortilla,Eggs,Bacon|wrap|Toast wrap.|35|15|420",
        "Ginger Poach|Broth,Eggs,Ginger|poach|Whirlpool.|18|2|180",
        "Turkey Scramble|Turkey,Spinach,Eggs|fry|Wilt spinach.|40|3|380",
        "Salmon Omelet|Salmon,Eggs,Dill|flat|Cool salmon.|38|1|410",
        "Avocado Toast|Sardines,Avocado,Bread|raw|Use fork.|25|22|450",
        "Steak Tip Bowl|Steak,Arugula,Egg|sear|Temper 20m.|48|2|520",
        "Asparagus Bake|Asparagus,Prosciutto,Eggs|bake|Wrap tight.|28|4|320",
        "Mushroom Frittata|Whites,Mushrooms,Thyme|bake|Saut√© first.|25|6|280",
        "Zucchini Hash|Zucchini,Onion,Eggs|fry|Squeeze dry.|20|8|260",
        "Goat Cheese Scramble|Eggs,Goat Cheese|fry|Add late.|22|2|290",
        "Cod Scramble|Cod,Eggs,Parsley|fry|Flake cold.|35|1|340",
        "Bison Hash|Bison,Peppers,Eggs|sear|Dice small.|45|12|510",
        "Duck Egg Pan|Duck Eggs,Kale,Lemon|fry|Use lemon.|24|3|310",
        "Sausage Pan|Turkey Sausage,Peppers|sear|Brown deep.|38|8|440",
        "Tuna Melt|Tuna,Goat Cheese,Bread|flat|Heavy press.|42|24|550",
        "Liver & Onions|Beef Liver,Onion,Ghee|sear|Soak lemon.|32|14|380",
        "Broccoli Bake|Whites,Broccoli,Garlic|bake|Steam first.|20|12|240",
        "Salmon Roe Eggs|Roe,Eggs,Seaweed|flat|Add roe last.|28|2|320",
        "Lamb Morning|Lamb,Eggs,Mint|sear|High heat.|40|1|460",
        "Mackerel Bowl|Mackerel,Cucumber,Radish|raw|Smoked.|30|4|350",
        "Beef Heart Pan|Heart,Eggs|sear|Slice thin.|35|1|320",
        "Collard Scramble|Collards,Eggs,Garlic|fry|Saut√© vinegar.|18|6|220",
        "Boar & Eggs|Wild Boar,Eggs|sear|Lean pork.|42|2|440",
        "Scallop Pan|Scallops,Whites|sear|Dry scallops.|30|3|290",
        "Tomato Steak|Steak,Tomato,Balsamic|sear|Blister.|45|8|490",
        "Shrimp Omelet|Shrimp,Eggs,Spinach|sear|Butterfly.|35|2|360",
        "Seaweed Poach|Dulse,Eggs,Broth|poach|Natural salt.|18|2|180",
        "Venison Pan|Venison,Eggs|sear|Add berries.|40|6|390"
    ],
    l: [
        "Thai Beef Salad|Steak,Lime,Mint|raw|Slice 45deg.|45|12|480",
        "Chicken Wraps|Chicken,Lettuce,Cashew|raw|Soak cashews.|40|8|420",
        "Sardine Bowl|Sardines,Radish,Cucumber|raw|Mandoline.|28|6|320",
        "Cold Flank|Steak,Asparagus,Mustard|raw|Shock veg.|42|4|450",
        "Turkey Gem Wraps|Turkey,Ginger,Lettuce|raw|Center cut.|38|5|390",
        "Salmon Boats|Salmon,Cucumber|raw|Hollow cuc.|35|6|410",
        "Bison Jerky Plate|Jerky,Almonds,Olives|raw|12 almonds.|30|12|380",
        "Arugula Jar|Steak,Arugula,Beets|raw|Layer bottom.|40|14|460",
        "Lemon Broccoli|Chicken,Broccoli,Lemon|raw|Massage kale.|38|10|390",
        "Stuffed Peppers|Tuna,Peppers,Dill|raw|Mini peppers.|35|8|340",
        "Beef Broccoli|Beef,Sesame|raw|Toasted oil.|42|12|490",
        "Sardine Lemon|Sardines,Capers|raw|Skip salt.|28|2|310",
        "Avocado Roll|Turkey,Avocado|raw|Lime brush.|32|8|380",
        "Poached Salmon|Salmon,Cucumber,Dill|raw|Green tea.|35|2|390",
        "Lamb Salad|Lamb,Mint,Greens|raw|Use vinegar.|40|6|470",
        "Duck Salad|Duck,Arugula,Berries|raw|Blueberries.|35|12|440",
        "Cod Jars|Cod,Olive Oil,Celery|raw|High polyphenol.|32|4|360",
        "Shrimp Cocktail|Shrimp,Lemon,Celery|raw|Bay leaf.|28|4|290",
        "Heart Carpaccio|Heart,Lemon,Parmesan|raw|Freeze first.|30|2|310",
        "Venison Jerky|Venison,Walnuts,Olives|raw|High protein.|35|8|370",
        "Roe Bowl|Roe,Cucumber,Seaweed|raw|Omega-3.|25|4|280",
        "Turkey Meatballs|Turkey,Spinach,Garlic|raw|Bake ahead.|38|6|410",
        "Kimchi Steak|Steak,Kimchi,Cucumber|raw|Probiotic.|45|8|480",
        "Trout Salad|Trout,Radicchio|raw|Bitter greens.|32|4|350",
        "Boar Strip Bowl|Boar,Peppers,Onion|raw|Mono fats.|40|10|460",
        "Mackerel Fennel|Mackerel,Fennel|raw|Anti-bloat.|30|6|340",
        "Chicken Thigh Jar|Chicken,Kale,Thyme|raw|48hr prep.|38|8|420",
        "Bison Snap Peas|Bison,Snap Peas|raw|Crunch factor.|42|12|470",
        "Octopus Bowl|Octopus,Olives,Parsley|raw|Pre-boiled.|35|4|330",
        "Liver Celery Pate|Liver,Celery,Ghee|raw|Nature multi.|28|6|340"
    ],
    d: [
        "Wild Salmon|Salmon,Bok Choy,Tamari|fish|Press skin.|42|6|480",
        "Clams Garlic|Clams,Garlic,Parsley|clams|Discard closed.|30|8|320",
        "Bison Chili|Bison,Peppers,Onion|stew|Bloom spices.|48|18|560",
        "Steak Ribbons|Steak,Zucchini,Garlic|sear|Pat dry.|50|6|580",
        "Garlic Scallops|Scallops,Garlic,Spinach|sear|Don't move.|35|4|340",
        "Herb Cod Roast|Cod,Rosemary,Broccoli|bake|Lemon bed.|38|8|390",
        "Beef Stir Fry|Beef,Snap Peas,Peppers|sear|Max heat.|45|14|520",
        "Lamb Chops|Lamb,Mint,Cauliflower|sear|Baste ghee.|42|6|540",
        "Shrimp Asparagus|Shrimp,Asparagus,Lemon|sear|Lemon zest.|32|6|310",
        "Turkey Burgers|Turkey,Mushrooms,Arugula|sear|Mix mush.|40|4|430",
        "Venison Steak|Venison,Carrots,Thyme|sear|Zero fat.|45|12|470",
        "Duck Kale|Duck,Kale,Orange|sear|Score fat.|38|10|510",
        "Red Mussels|Mussels,Tomato,Garlic|clams|Use liquor.|28|12|330",
        "Swordfish|Swordfish,Olives,Peppers|sear|Meaty.|40|4|460",
        "Heart Stew|Heart,Celery,Carrots|stew|Slow cook.|35|14|390",
        "Boar Balls|Boar,Tomato,Spinach|stew|More spice.|42|8|490",
        "Halibut|Halibut,Asparagus,Butter|bake|Keep skin.|38|4|410",
        "Lamb Kabobs|Lamb,Peppers,Onion|sear|Space out.|40|12|530",
        "Ribeye Ghee|Ribeye,Rosemary,Ghee|sear|Rosemary.|52|0|650",
        "Cod Papillote|Cod,Zucchini,Lemon|bake|Fold tight.|35|6|360",
        "Scampi Zoodles|Shrimp,Garlic,Zucchini|sear|Al dente.|30|8|320",
        "Liver Bacon|Liver,Bacon,Onions|sear|Crisp bacon.|35|10|440",
        "Snapper Lime|Snapper,Cilantro,Lime|bake|Top fresh.|38|4|390",
        "Beef Tongue|Tongue,Garlic,Bay Leaf|stew|Peel first.|32|2|380",
        "Rabbit Leeks|Rabbit,Leeks,Rosemary|stew|Clean meat.|35|8|340",
        "Octopus Potato|Octopus,Paprika,Olive Oil|sear|Char cups.|30|18|420",
        "Sea Bass|Bass,Leeks,Lemon|sear|Use spatula.|36|6|380",
        "Pesto Salmon|Salmon,Pesto,Spinach|bake|Pesto top.|40|4|490",
        "Trout Bake|Trout,Parsley,Lemon|bake|Stuff cavity.|35|2|370",
        "Beef Heart Roast|Heart,Thyme,Ghee|sear|Horseradish.|38|2|350"
    ],
    s: [
        "Greek Yogurt Bowl|Berries,Honey,Walnuts|raw|Probiotic boost for gut health.|22|18|240",
        "Hard Boiled Eggs|Sea Salt,Pepper|boil|Perfect amino acid profile.|12|1|140",
        "Apple & Almonds|Sliced Apple,Raw Almonds|raw|Fiber and healthy fat combo.|6|24|200",
        "Beef Jerky|Grass-fed Beef|raw|High sodium for workout recovery.|25|4|180",
        "Cottage Cheese|Pineapple,Chia Seeds|raw|Casein protein for slow release.|24|14|210",
        "Protein Shake|Whey Isolate,Water|shake|Fast absorption post-lift.|25|2|120",
        "Hummus & Veg|Hummus,Carrots,Celery|raw|Fiber to sustain energy levels.|8|20|180",
        "Bone Broth|Beef Bone Broth|simmer|Collagen for joint repair.|10|1|50",
        "Sardines|Olive Oil,Crackers|raw|Massive Omega-3 hit.|22|0|190",
        "Dark Chocolate|90% Cacao,Almonds|raw|Polyphenol antioxidant booster.|4|12|160"
    ]
};

function switchU(uID){ user=uID; document.querySelectorAll('.u-badge').forEach(b=>b.classList.remove('active')); document.getElementById('b'+uID.toLowerCase()).classList.add('active'); render(); }
function getMon(o){ let d=new Date(); d.setHours(0,0,0,0); let day=d.getDay(); let diff=d.getDate()-day+(day===0?-6:1); d.setDate(diff+(o*7)); return d; }
function changeW(d){ offset+=d; render(); }
function resetD(){ offset=0; selDate=new Date(); render(); }

function render(){
    const mon=getMon(offset); const days=["MON","TUE","WED","THU","FRI","SAT","SUN"];
    const tabs=document.getElementById('dayTabs'); tabs.innerHTML='';
    const end=new Date(mon); end.setDate(mon.getDate()+6);
    document.getElementById('dateDisplay').innerText=`${mon.toLocaleDateString('en-US',{month:'short',day:'numeric'})} - ${end.toLocaleDateString('en-US',{month:'short',day:'numeric'})}`;
    for(let i=0; i<7; i++){
        let d=new Date(mon); d.setDate(mon.getDate()+i);
        const b=document.createElement('div'); b.className='tab'+(d.toDateString()===selDate.toDateString()?' active':'');
        b.innerHTML=`${days[i]}<br>${d.getDate()}`;
        b.onclick=()=>{ dailySnack=null; selDate=d; render() }; 
        tabs.appendChild(b);
        if(b.classList.contains('active')) showDay(d, i);
    }
}

function showDay(dObj, idx){
    const id=Math.floor(dObj.getTime()/864e5);
    
    // GET MEALS (NOW WITH MACROS at indices 4,5,6)
    const b = (mDB.b[Math.abs(id) % mDB.b.length]).split('|');
    const l = (mDB.l[Math.abs(id) % mDB.l.length]).split('|');
    const dn = (mDB.d[Math.abs(id) % mDB.d.length]).split('|');

    const sch=["HEAVY LIFT","BOXING","REFORM","BOXING","REFORM/YOGA","CS4","RELAX"];
    const jcs=["PLASMA FLUSH","TITAN RED","ZENITH GREEN","TITAN RED","ZENITH GREEN","TITAN RED","APOLLO GOLD"];
    const j=jDB[jcs[idx]], g=(user==='J')?{P:165,C:(idx%2===0?130:85),K:1950}:{P:105,C:55,K:1300};
    
    // CALC MACROS: Sum Meal Macros + Juice + Snack
    let sPro = dailySnack ? parseInt(dailySnack[4]) : 0;
    let sCarb = dailySnack ? parseInt(dailySnack[5]) : 0;
    let sCal = dailySnack ? parseInt(dailySnack[6]) : 0;

    let p = parseInt(b[4]) + parseInt(l[4]) + parseInt(dn[4]) + j[2] + sPro;
    let c = parseInt(b[5]) + parseInt(l[5]) + parseInt(dn[5]) + j[3] + sCarb;
    let k = parseInt(b[6]) + parseInt(l[6]) + parseInt(dn[6]) + j[4] + sCal;

    // SNACK UI
    let snackHTML = '';
    if(!dailySnack) {
        snackHTML = `<div onclick="openSnackSelector()" style="background:#0a0a0a; border:1px dashed #333; border-radius:10px; padding:12px; text-align:center; color:#666; font-size:0.7rem; font-weight:700; cursor:pointer; margin-bottom:15px">‚ûï TAP TO SELECT SNACK</div>`;
    } else {
        snackHTML = `<div class="value" onclick="openSnackSelector()">${dailySnack[0]} <span style="font-size:0.6rem;color:var(--green);float:right">+${sPro}g Pro</span></div>`;
    }
    
    document.getElementById('dayContent').innerHTML = `
        <div class="label">üèãÔ∏è Workout</div>
        <div class="value" onclick="openRecoveryPhase('${sch[idx]}')">${sch[idx]} <span style="font-size:0.7rem;color:var(--gold);float:right">VIEW GUIDE ‚ûî</span></div>
        
        <div class="label">üç≥ Breakfast</div>
        <div class="value" onclick="openR('${b[0]}','${b[1]}','${b[2]}','${b[3]}')">
            <span>${b[0]}</span> <span class="macro-pill">${b[4]}P ${b[5]}C ${b[6]}K</span>
        </div>
        
        <div class="label">ü•ó Lunch</div>
        <div class="value" onclick="openR('${l[0]}','${l[1]}','${l[2]}','${l[3]}')">
            <span>${l[0]} üíº</span> <span class="macro-pill">${l[4]}P ${l[5]}C ${l[6]}K</span>
        </div>
        
        <div class="label">üçΩÔ∏è Dinner</div>
        <div class="value" onclick="openR('${dn[0]}','${dn[1]}','${dn[2]}','${dn[3]}')">
            <span>${dn[0]}</span> <span class="macro-pill">${dn[4]}P ${dn[5]}C ${dn[6]}K</span>
        </div>
        
        <div class="label">ü•ú Snack Option</div>
        ${snackHTML}

        <div class="macro-dashboard">
            <div class="macro-row"><div class="macro-label"><span>PROTEIN</span><span>${p}g / ${g.P}g</span></div><div class="macro-bg"><div class="macro-fill" style="width:${(p/g.P)*100}%; background:var(--g-pro)"></div></div></div>
            <div class="macro-row"><div class="macro-label"><span>CARBS</span><span>${c}g / ${g.C}g</span></div><div class="macro-bg"><div class="macro-fill" style="width:${(c/g.C)*100}%; background:var(--g-carb)"></div></div></div>
            <div class="macro-row"><div class="macro-label"><span>CALORIES</span><span>${k} / ${g.K}</span></div><div class="macro-bg"><div class="macro-fill" style="width:${(k/g.K)*100}%; background:var(--g-cal)"></div></div></div>
        </div>
        <div class="card" style="text-align:center"><div class="label" style="color:var(--gold)">Kuvings Cold Pressed</div><div class="juice-name" onclick="openJ('${jcs[idx]}')">${jcs[idx]}</div></div>`;
}

function openSnackSelector() {
    const modalBody = document.getElementById('mBody');
    document.getElementById('mTitle').innerText = "SELECT SNACK";
    document.getElementById('mSub').innerText = "CALCULATES MACROS AUTOMATICALLY";
    
    let html = '';
    mDB.s.forEach((item, index) => {
        let s = item.split('|');
        html += `<div class="value" onclick="applySnack(${index})">
            ${s[0]} 
            <span style="float:right;font-size:0.7rem;color:#666">${s[4]}g Pro | ${s[6]} Cal</span>
        </div>`;
    });
    
    modalBody.innerHTML = html;
    document.getElementById('mTip').innerText = "PRO TIP: Prioritize high-protein snacks on Heavy Lift days.";
    document.getElementById('masterModal').style.display = 'block';
}

function applySnack(idx) {
    dailySnack = mDB.s[idx].split('|');
    document.getElementById('masterModal').style.display = 'none';
    const mon=getMon(offset);
    const dayDiff = Math.floor((selDate - mon) / 864e5);
    showDay(selDate, dayDiff);
}

function openR(n,i,a,t){
    document.getElementById('mTitle').innerText=n; document.getElementById('mSub').innerText="Prep: "+i;
    let s = (a==='sear')?["Temper 15m.","High sear 4m/side.","Rest 5m."]:(a==='roll')?["Whisk eggs.","Roll tightly."]:["Prep components.","Assemble.","Serve fresh."];
    document.getElementById('mBody').innerHTML=s.map(x=>`<p>${x}</p>`).join('');
    document.getElementById('mTip').innerText = t ? "CHEF TIP: " + t : "";
    document.getElementById('masterModal').style.display='block';
}

function openM(n){
    const d=rDB[n]; document.getElementById('mTitle').innerText=n; document.getElementById('mSub').innerText=d[0];
    document.getElementById('mBody').innerHTML=d.slice(1).map(x=>`<p>${x}</p>`).join('');
    document.getElementById('mTip').innerText = "PRO TIP: Consistency beats intensity for recovery protocols.";
    document.getElementById('masterModal').style.display='block';
}

function openJ(n){
    const d=jDB[n]; document.getElementById('mTitle').innerText=n; document.getElementById('mSub').innerText=d[0];
    document.getElementById('mBody').innerHTML=`<p><strong>Ingredients:</strong> ${d[1]}</p><p>P: ${d[2]}g | C: ${d[3]}g | Kcal: ${d[4]}</p>`;
    document.getElementById('mTip').innerText = "PRO TIP: Drink slowly to allow enzymes to activate digestion.";
    document.getElementById('masterModal').style.display='block';
}

function openRecoveryPhase(workout) {
    const m = document.getElementById('mBody');
    document.getElementById('mTitle').innerText = workout + " PROTOCOL";
    document.getElementById('mSub').innerText = "CUSTOMIZED RECOVERY LOGIC";
    
    const protocols = {
        "HEAVY LIFT": [
            { t: "PRE-WORKOUT", h: "Theragun Activation", d: "Glutes, Quads, & Hamstrings. 30s per muscle group." },
            { t: "AT THE GYM", h: "Chair + Sauna", d: "20m Zero-Gravity Chair followed by 20m Sauna (185¬∞F)." },
            { t: "AT HOME", h: "Thera Knee", d: "Alternating Mode (Hot/Cold) + Vibration to flush metabolic waste." }
        ],
        "BOXING": [
            { t: "PRE-WORKOUT", h: "Theragun Mobility", d: "Rotator cuffs, Pecs, and Calves. 2400 PPM." },
            { t: "AT THE GYM", h: "Active Cooldown", d: "Light dynamic stretching. DO NOT use Sauna today." },
            { t: "AT HOME", h: "Normatec + Thera Knee", d: "30m Normatec (Air Compression) followed by Thera Knee (Solo Cold) to reduce inflammation." }
        ],
        "REFORM": [
            { t: "PRE-WORKOUT", h: "Theragun Sweep", d: "Light percussive sweep over full body." },
            { t: "AT THE GYM", h: "Mobility + Sauna", d: "Hip openers followed by 20m Sauna for HGH boost." },
            { t: "AT HOME", h: "Thera Knee", d: "Solo Heat + Vibration cycle to maintain tissue elasticity." }
        ],
        "REFORM/YOGA": [
            { t: "PRE-WORKOUT", h: "Theragun Sweep", d: "Light percussive sweep over full body." },
            { t: "AT THE GYM", h: "Yoga + Sauna", d: "Deep fascial release followed by 20m Sauna session." },
            { t: "AT HOME", h: "Thera Knee", d: "Solo Heat mode to prolong the benefits of deep stretching." }
        ],
        "CS4": [
            { t: "WEEKEND GYM", h: "Chair + Sauna", d: "30 Min Deep Tissue Chair + 25 Min Endurance Sauna." },
            { t: "AT HOME", h: "Full Leg Recovery", d: "Normatec (Air Compression) + Thera Knee (Alternating Hot/Cold)." },
            { t: "EVENING", h: "Hydration", d: "Replenish electrolytes lost during sauna." }
        ],
        "RELAX": [
            { t: "WEEKEND GYM", h: "Chair + Sauna", d: "20 Min Relax Mode Chair + 20 Min Detox Sauna." },
            { t: "AT HOME", h: "Maintenance", d: "Theragun on tight spots + Thera Knee (Solo Heat + Vibration)." },
            { t: "EVENING", h: "Sleep Prep", d: "Magnesium and cool room temperature." }
        ]
    };

    const active = protocols[workout] || protocols["RELAX"];
    let html = '<div class="rec-phase-list">';
    active.forEach(step => {
        html += `
            <div class="phase-item">
                <span class="phase-time">${step.t}</span>
                <span class="phase-title">${step.h}</span>
                <span class="phase-detail">${step.d}</span>
            </div>`;
    });
    html += '</div>';

    m.innerHTML = html;
    document.getElementById('mTip').innerText = "TIP: Hydrate with minerals before Sauna sessions.";
    document.getElementById('masterModal').style.display = 'block';
}

function openBio() {
    const u = uH[user];
    const modalBody = document.getElementById('mBody');
    
    const fullName = (user === 'J') ? "JERMAINE" : "SOPHIA";
    document.getElementById('mTitle').innerText = fullName + " CLINICAL SCAN";
    document.getElementById('mSub').innerText = `Weight: ${u.now.w} lbs | Updated Dec 24`;
    
    const metrics = [
        { label: "Body Fat %", key: "bf", unit: "%", lowerIsBetter: true },
        { label: "Muscle Mass", key: "m", unit: " lbs", lowerIsBetter: false },
        { label: "Visceral Fat", key: "vf", unit: " lvl", lowerIsBetter: true },
        { label: "Metabolic Age", key: "age", unit: " yrs", lowerIsBetter: true }
    ];

    let html = '';
    metrics.forEach(m => {
        const p = u.past[m.key], n = u.now[m.key], g = u.goal[m.key];
        const max = Math.max(p, n, g);
        
        let arrow = "‚Üí"; let color = "var(--gold)";
        if (n < p) { arrow = "‚Üì"; color = m.lowerIsBetter ? "var(--green)" : "#FF5252"; }
        else if (n > p) { arrow = "‚Üë"; color = m.lowerIsBetter ? "#FF5252" : "var(--green)"; }

        html += `
            <div class="bio-section">
                <div class="bio-title"><span>${m.label}</span><span style="color:var(--green)">Goal: ${g}${m.unit}</span></div>
                <div class="bar-group">
                    <div class="bar-row">
                        <div class="bar-lbl">Past</div>
                        <div class="bar-track"><div class="bar-fill past" style="width:${(p/max)*100}%"></div></div>
                        <div style="font-size:0.6rem; color:#666; width:35px">${p}${m.unit}</div>
                    </div>
                    <div class="bar-row">
                        <div class="bar-lbl">Now</div>
                        <div class="bar-track"><div class="bar-fill now" style="width:${(n/max)*100}%"></div></div>
                        <div style="font-size:0.6rem; color:${color}; width:35px; font-weight:800">${n}${m.unit} ${arrow}</div>
                    </div>
                </div>
            </div>`;
    });

    modalBody.innerHTML = html;
    document.getElementById('mTip').innerText = `BMR: ${u.now.bmr} kcal/day | Efficiency: High`;
    document.getElementById('masterModal').style.display = 'block';
}

function closeM(){ document.getElementById('masterModal').style.display='none' }
window.onload=render;
</script>
</body>
</html>