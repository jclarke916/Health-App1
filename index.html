<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Centurion | v117 Performance Balanced</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #000000; --card-bg: #111111; --text-main: #E5E4E2; --text-dim: #888888;
            --accent-gold: #D4AF37; --accent-silver: #C0C0C0; --glute-pink: #d63384;
            --carb-high: #ff9100; --carb-low: #00b0ff;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-dark); color: var(--text-main); margin: 0; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .container { max-width: 1000px; width: 100%; position: relative; }
        header { text-align: center; margin-bottom: 25px; border-bottom: 1px solid #333; padding-bottom: 20px; }
        h1 { font-weight: 300; letter-spacing: 2px; text-transform: uppercase; background: linear-gradient(to right, #E5E4E2, #888888); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0; }
        .profile-badges { display: flex; justify-content: center; gap: 10px; margin-top: 15px; flex-wrap: wrap; }
        .badge { background: #1a1a1a; padding: 8px 16px; border-radius: 4px; border: 1px solid #333; font-size: 0.7rem; color: var(--accent-silver); text-transform: uppercase; letter-spacing: 1px; cursor: pointer; transition: 0.3s; }
        .badge:hover { border-color: var(--accent-gold); }
        .status-bar { text-align: center; color: var(--text-dim); font-size: 0.8rem; margin: 15px 0; text-transform: uppercase; letter-spacing: 1.5px; }
        .controls { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; }
        .nav-btn { background: var(--card-bg); border: 1px solid #333; color: var(--text-main); padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; }
        .tabs { display: flex; justify-content: space-between; background: var(--card-bg); padding: 5px; border-radius: 8px; margin-bottom: 25px; border: 1px solid #222; overflow-x: auto; }
        .tab-btn { background: none; border: none; color: #555; padding: 10px; cursor: pointer; flex: 1; font-size: 0.75rem; display: flex; flex-direction: column; align-items: center; transition: 0.3s; }
        .tab-btn span { display: block; font-size: 0.6rem; opacity: 0.7; margin-top: 4px; }
        .tab-btn.active { color: var(--accent-gold); background: rgba(255,255,255,0.03); border-radius: 4px; }
        .card { background: var(--card-bg); border-radius: 12px; padding: 30px; border: 1px solid #222; position: relative; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .card::before { content: ""; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: var(--accent-gold); }
        .label { color: var(--accent-silver); font-size: 0.6rem; text-transform: uppercase; letter-spacing: 2px; font-weight: 700; margin-bottom: 5px; }
        .value { font-size: 1.1rem; margin-bottom: 15px; color: #fff; cursor: pointer; border-bottom: 1px solid transparent; display: inline-block; }
        .value:hover { color: var(--accent-gold); border-bottom-color: var(--accent-gold); }
        .workout-tag { display: flex; justify-content: space-between; align-items: center; font-size: 0.85rem; color: var(--accent-gold); border-bottom: 1px solid #333; padding-bottom: 12px; margin-bottom: 20px; font-weight: 700; text-transform: uppercase; }
        .pb-mini { font-size: 0.6rem; padding: 4px 8px; border-radius: 3px; background: #222; border: 1px solid #444; color: #aaa; text-transform: uppercase; font-weight: 800; margin-right: 5px; display: inline-block; margin-top: 5px; }
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(8px); overflow-y: auto; }
        .modal-content { background: #050505; margin: 5% auto; padding: 30px; border: 1px solid #333; width: 90%; max-width: 650px; border-radius: 12px; }
        .macro-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin: 20px 0; background: #0a0a0a; padding: 15px; border-radius: 8px; border: 1px solid #222; }
        .macro-item { text-align: center; }
        .macro-label { font-size: 0.65rem; color: #888; text-transform: uppercase; }
        .macro-val { font-size: 1rem; color: #fff; font-weight: 700; }
        .chef-steps p { margin-bottom: 15px; color: #ccc; font-size: 0.95rem; line-height: 1.6; position: relative; padding-left: 30px; }
        .chef-steps p::before { counter-increment: step; content: counter(step); position: absolute; left: 0; top: 2px; background: var(--accent-gold); color: #000; width: 20px; height: 20px; border-radius: 50%; font-size: 0.7rem; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .sophia-mod-box { background: rgba(214, 51, 132, 0.1); border: 1px solid var(--glute-pink); padding: 15px; border-radius: 6px; margin-top: 20px; }
        .sophia-mod-title { color: var(--glute-pink); font-size: 0.8rem; font-weight: 800; text-transform: uppercase; margin-bottom: 5px; }
        .ing-list { list-style: none; padding: 0; margin-bottom: 20px; }
        .ing-list li { font-size: 0.9rem; color: #ccc; margin-bottom: 6px; padding-left: 15px; position: relative; }
        .ing-list li::before { content: "â€¢"; color: var(--accent-gold); position: absolute; left: 0; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>THE CENTURION</h1>
        <div class="profile-badges">
            <div class="badge" onclick="openModal('profileModal')">ğŸ§”ğŸ¾â€â™‚ï¸ JERMAINE</div>
            <div class="badge" onclick="openModal('profileModal')">ğŸ‘©ğŸ¾â€ğŸ¦± SOPHIA</div>
        </div>
    </header>

    <div class="status-bar" id="dateHeader">OPTIMIZING VARIETY...</div>

    <div class="controls">
        <button class="nav-btn" onclick="changeWeek(-1)">PREV</button>
        <button class="nav-btn" onclick="resetToCurrent()">TODAY</button>
        <button class="nav-btn" onclick="changeWeek(1)">NEXT</button>
    </div>

    <div class="tabs" id="dayTabs"></div>
    <div id="dayContent"></div>
</div>

<div id="recipeModal" class="modal">
    <div class="modal-content">
        <span onclick="closeModal('recipeModal')" style="float:right; cursor:pointer; font-size:24px; color:#555;">&times;</span>
        <h2 id="modalTitle" style="color:#fff; margin-bottom:5px;"></h2>
        <div id="modalTime" style="color:var(--accent-gold); font-size:0.85rem; font-weight:bold; margin-bottom:15px;"></div>
        
        <div class="macro-grid">
            <div class="macro-item"><div class="macro-label">Protein</div><div class="macro-val" id="modalP"></div></div>
            <div class="macro-item"><div class="macro-label">Carbs</div><div class="macro-val" id="modalC"></div></div>
            <div class="macro-item"><div class="macro-label">Fats</div><div class="macro-val" id="modalF"></div></div>
        </div>

        <div style="color:var(--accent-gold); font-size:0.85rem; font-weight:bold; text-transform:uppercase; margin-bottom:12px; letter-spacing:1px;">Ingredients</div>
        <ul id="modalIng" class="ing-list"></ul>

        <div style="color:var(--accent-gold); font-size:0.85rem; font-weight:bold; text-transform:uppercase; margin-bottom:12px; letter-spacing:1px;">Chef's Preparation</div>
        <div id="modalSteps" class="chef-steps" style="counter-reset: step;"></div>

        <div class="sophia-mod-box">
            <div class="sophia-mod-title">ğŸ‘ Sophia's Mod & Portions</div>
            <div id="modalMod" style="color:#e5e4e2; font-size:0.85rem; line-height:1.4;"></div>
        </div>
    </div>
</div>

<div id="profileModal" class="modal">
    <div class="modal-content">
        <span onclick="closeModal('profileModal')" style="float:right; cursor:pointer; font-size:24px; color:#555;">&times;</span>
        <h2 style="color:var(--accent-gold);">Performance Profiles</h2>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
            <div class="card" style="padding:15px;">ğŸ§”ğŸ¾â€â™‚ï¸ Jermaine<br><span style="font-size:0.75rem; color:#888;">Height: 6'4"<br>Weight: 210.8 lbs<br>Target: 195 lbs</span></div>
            <div class="card" style="padding:15px;">ğŸ‘©ğŸ¾â€ğŸ¦± Sophia<br><span style="font-size:0.75rem; color:#888;">Height: 5'2"<br>Weight: 136.1 lbs<br>Target: 125 lbs</span></div>
        </div>
    </div>
</div>

<script>
    const recipeDB = {
        // DINNERS
        "Garlic Ghee Lobster Tails": { t: "20 mins", p: "40g", c: "2g", f: "15g", ing: ["2 Lobster Tails", "Ghee", "Garlic", "Asparagus"], steps: ["Split lobster shells lengthwise.", "Brush meat with garlic-infused ghee and sea salt.", "Grill flesh-side down on high heat for 5 mins Side A.", "Flip and grill 3 mins Side B until meat is opaque.", "Serve with grilled asparagus."], mod: "Sophia: 1 tail (1.5 palms); Jermaine: 2 tails." },
        "Grilled Branzino (Whole)": { t: "25 mins", p: "45g", c: "0g", f: "15g", ing: ["Whole Branzino", "Lemon slices", "Parsley", "Garlic", "Ghee"], steps: ["Clean fish; stuff cavity with lemon and parsley.", "Brush skin with ghee for non-stick crunch.", "Roast in oven at 400Â°F for exactly 15 mins.", "Set oven to Broil for final 2 mins Side A and 1 min Side B."], mod: "Ensure scales removed. Sophia: 1.5 palms protein." },
        "Greek Grilled Octopus": { t: "1 hr 10 mins", p: "35g", c: "5g", f: "12g", ing: ["Octopus tentacles", "Vinegar", "Olive oil", "Oregano", "Lemon"], steps: ["Braise tentacles for 45 mins in water with vinegar until tender.", "Marinate in oil, oregano, and lemon.", "Grill on HIGH heat for 4 mins per side until charred."], mod: "Sophia: 1.5 palms protein; low fat recovery meal." },
        "Venison Au Poivre": { t: "20 mins", p: "50g", c: "2g", f: "8g", ing: ["6oz Venison medallions", "Black peppercorns", "Ghee", "Beef broth"], steps: ["Crush peppercorns and press into medallions.", "Sear in ghee for 3 mins Side A on high heat.", "Flip and cook 3 mins Side B (Keep rare).", "Deglaze pan with beef broth for sauce."], mod: "Sophia: 1.5 palms protein; extremely lean iron focus." },
        "Ostrich Steaks": { t: "15 mins", p: "50g", c: "5g", f: "5g", ing: ["6oz Ostrich fillet", "Ghee", "Blackberries", "Balsamic"], steps: ["Sear fillets for exactly 3 mins Side A in hot ghee.", "Flip and sear for 3 mins Side B (Keep rare).", "Simmer blackberries/balsamic in pan juices until thick."], mod: "Sophia: 1.5 palms protein; highest iron density meat." },
        "SF Style Cioppino": { t: "45 mins", p: "40g", c: "12g", f: "8g", ing: ["1lb Mussels", "White fish pieces", "Fennel", "Tomato broth", "Garlic"], steps: ["SautÃ© fennel and garlic in ghee until softened.", "Simmer tomato-based broth for 20 mins.", "Add mussels and fish pieces.", "Cover for 5 mins until mussels open fully."], mod: "High thyroid iodine support. Sophia: 1.5 palms protein." },
        "Miso Black Cod": { t: "20 mins", p: "38g", c: "8g", f: "15g", ing: ["6oz Cod fillet", "White miso", "Coconut aminos", "Ginger", "Bok choy"], steps: ["Glaze cod with white miso, aminos, and ginger.", "Bake at 400Â°F for 12 mins until flaky.", "Steam bok choy with lemon during final 5 mins."], mod: "Sophia: 1.5 palms protein; limit glaze to 1 tbsp." },
        "Sea Bass w/ Fennel": { t: "25 mins", p: "40g", c: "8g", f: "18g", ing: ["6oz Sea bass", "Shaved fennel", "Ghee", "Lemon", "Dill"], steps: ["Pat sea bass dry; sear skin-side down for 5 mins Side A.", "Flip and finish for 3 mins Side B.", "Serve over shaved fennel tossed in lemon juice."], mod: "Sophia: skip added butter; 1.5 palms protein." },
        "Wild Boar Tenderloin": { t: "25 mins", p: "45g", c: "0g", f: "8g", ing: ["6oz Wild boar", "Rosemary", "Garlic", "Ghee"], steps: ["Season boar with rosemary and salt.", "Sear all sides in ghee for 8 mins total.", "Bake at 400Â°F for 10 mins.", "Rest 10 mins before slicing."], mod: "Sophia: 1.5 palms protein; leaner than pasture pork." },
        "Arctic Char w/ Asparagus": { t: "15 mins", p: "38g", c: "2g", f: "14g", ing: ["6oz Arctic char", "Asparagus", "Lemon", "Ghee"], steps: ["Sear char skin-side down for 5 mins Side A.", "Flip and sear for 2 mins Side B.", "Steam asparagus with lemon."], mod: "High Omega-3s. Sophia: 1.5 palms protein." },

        // LUNCHES
        "Classic Peruvian Ceviche": { t: "20 mins", p: "40g", c: "12g", f: "2g", ing: ["8oz Snapper/Bass", "Lime juice", "Red onion", "Cilantro", "Sweet potato"], steps: ["Cube fish into 1/2 inch pieces.", "Submerge in fresh lime juice and chill for 15 mins.", "Toss cured fish with red onions and cilantro.", "Plate with exactly 1 slice boiled sweet potato."], mod: "Sophia: skip sweet potato for zero-carb boost." },
        "Dungeness Crab Tower": { t: "15 mins", p: "35g", c: "15g", f: "12g", ing: ["6oz Lump crab", "1/2 Avocado", "Mango", "Lime", "Cilantro"], steps: ["Mix crab with lime and cilantro.", "Layer avocado, mango, and crab in a ring mold.", "Serve cold with microgreens and cucumber."], mod: "High enzyme meal; perfect for CNS recovery." },
        "Sriracha Yogurt Bison Tacos": { t: "20 mins", p: "42g", c: "15g", f: "12g", ing: ["6oz Ground bison", "1 cup Bell peppers", "Greek Yogurt", "Sriracha", "Siete tortillas"], steps: ["Brown ground bison with diced bell peppers.", "Mix Greek Yogurt with sriracha and lime juice.", "Warm tortillas in a dry pan.", "Assemble with meat and yogurt crema."], mod: "Sophia: use lettuce wraps instead of tortillas." },
        "Cilantro-Lime Shrimp Tacos": { t: "15 mins", p: "35g", c: "15g", f: "10g", ing: ["8oz Shrimp", "1 cup Bell peppers", "Greek Yogurt", "Lime", "Siete tortillas"], steps: ["Pat shrimp dry. SautÃ© with diced bell peppers.", "High heat sear exactly 2 mins Side A, 1 min Side B.", "Mix Greek Yogurt/lime for crema.", "Assemble with cabbage slaw."], mod: "Sophia: use lettuce wraps; Jermaine: 2 palms." },
        "Bison Laab": { t: "20 mins", p: "40g", c: "8g", f: "10g", ing: ["6oz Ground bison", "Diced bell peppers", "Lime juice", "Fish sauce", "Fresh mint"], steps: ["Brown ground bison with diced bell peppers for 8 mins.", "Toss with lime juice, fish sauce, and fresh mint.", "Serve in large romaine lettuce cups."], mod: "High iron electrolyte meal; standard portions." },
        "Turkey Potstickers": { t: "25 mins", p: "38g", c: "8g", f: "12g", ing: ["6oz Ground turkey", "Cabbage leaves", "Ginger", "Garlic", "Scallions"], steps: ["Mix ground turkey with ginger and garlic.", "Blanch cabbage leaves until soft.", "Wrap meat in leaves; sear 2 mins Side A/B.", "Steam with splash of water for 5 mins."], mod: "Zero flour wrapper logic; high volume fiber." },
        "Mendo Cobb": { t: "15 mins", p: "42g", c: "15g", f: "20g", ing: ["Pasture turkey", "Roasted beets", "Avocado", "Kale/Spinach", "Broccoli sprouts"], steps: ["Chop greens finely.", "Top with turkey, roasted beets, and avocado.", "Add massive heap of Broccoli Sprouts.", "Dress with lemon and oil."], mod: "Sophia: light on oil/nuts." },

        // BREAKFASTS
        "Southwest Bison Scramble": { t: "12 mins", p: "41g", c: "11g", f: "10g", ing: ["4oz Bison", "1/2 cup Bell peppers", "Egg whites", "Greek Yogurt", "Jalapenos"], steps: ["Brown ground bison with 1/2 cup diced bell peppers.", "Pour in egg whites (4 J, 3 S).", "Scramble 3-4 mins until set.", "Top with Greek Yogurt instead of sour cream."], mod: "Sophia: 1.5 palms; cook eggs well-done." },
        "Crab Scramble": { t: "10 mins", p: "35g", c: "2g", f: "8g", ing: ["4oz Lump crab", "Fresh spinach", "Egg whites", "Ghee", "Chives"], steps: ["SautÃ© fresh spinach in ghee until wilted.", "Pour in whisked egg whites.", "Fold in lump crab at the end to warm through.", "Finish with fresh chives."], mod: "Metabolic iodine support; standard portions." },
        "Sea Moss Smoothie": { t: "5 mins", p: "45g", c: "25g", f: "10g", ing: ["2tbsp Sea Moss gel", "Pea protein", "Frozen blackberries", "Hemp seeds"], steps: ["Add blackberries and liquid base to blender.", "Add Sea Moss gel and protein powders.", "Blend on high for 60 seconds until emulsified."], mod: "Standard portion; use water base for Sophia." },
        "Japanese Tamagoyaki": { t: "15 mins", p: "32g", c: "2g", f: "15g", ing: ["4 Eggs", "Dashi stock", "Coconut aminos", "Nori strips"], steps: ["Whisk eggs with dashi stock and aminos.", "Pour thin layer into hot rectangular pan.", "Fold slowly to build layers.", "Top with nori strips."], mod: "Sophia: 3 eggs; Jermaine: 4 eggs." }
    };

    const mealLibrary = {
        breakfasts: ["Southwest Bison Scramble", "Crab Scramble", "Sea Moss Smoothie", "Japanese Tamagoyaki", "Bison Steak & Eggs", "Shakshuka w/ Bison", "Savory Bone Broth Oats", "Lump Crab Eggs", "Protein Shake", "Iron-Bison Scramble", "Turkey Sausage Scramble", "Dashi Eggs", "Cod Scramble", "Egg White Bison", "Southwest Whites", "Morning Iron Bowl", "Mineral Shake", "Dashi Bison", "Smoothie Fuel", "Crab & Spinach", "Bison Breakfast Skillet", "Southwest Iron Start", "Crab Morning Salad", "Bison Steak Bowl", "Power Morning Smoothie", "Southwest Whites Skillet", "Scrambled Crab Meat Bowl", "Bone Broth Porridge", "Tamago Protein", "Bison Nutrient Bowl", "Spinach Crab Eggs", "Sea Moss Fuel Start", "Bison & Pepper Skillet", "Crab Protein Start", "Iron Scramble Bowl", "Egg White Bison Start", "Southwest Crab Skillet", "Morning Iron Start", "Mineral Shake Bowl", "Dashi Bison Start"],
        lunches: ["Classic Peruvian Ceviche", "Dungeness Crab Tower", "Sriracha Yogurt Bison Tacos", "Cilantro-Lime Shrimp Tacos", "Bison Laab", "Turkey Potstickers", "Mendo Cobb", "Snapper Ceviche", "Crab Avocado Salad", "Bison Thai Salad", "Cabbage Potstickers", "Turkey Greens Cobb", "Whitefish Ceviche", "Crab Mango Bowl", "Yogurt Crema Tacos", "Shrimp Slaw Bowl", "Bison Pepper Laab", "Turkey Wrap", "Southwest Cobb", "Lime Fish Ceviche", "Crab & Cucumber Bowl", "Bison Greek Salad", "Shrimp Peppers Bowl", "Garlic Turkey Salad", "Brussels Cobb", "Whitefish Lime Bowl", "Crab Protein Salad", "Bison Herb Laab", "Turkey Greens Salad", "Beet Cobb", "Trout Ceviche", "Dungeness Salad", "Yogurt Bison Bowl", "Cilantro Shrimp Salad", "Thai Meat Salad", "Turkey Dumpling Bowl", "Kale Cobb", "Snapper Mango Ceviche", "Crab Lime Tower", "Bison Citrus Salad"],
        dinners: ["Garlic Ghee Lobster Tails", "SF Style Cioppino", "Grilled Branzino (Whole)", "Greek Grilled Octopus", "Venison Au Poivre", "Miso Black Cod", "Centurion Bone Broth Stew", "Ostrich Steaks", "Duck Ragu", "Sea Bass w/ Fennel", "Wild Boar Tenderloin", "Arctic Char w/ Asparagus", "Elk Medallions w/ Juniper", "Salmon Roast", "Trout Fillet", "Scallops ProvenÃ§al", "Bison Bolognese", "Turkey Stuffed Peppers", "Snapper Bake", "Cod Parchment", "Duck & Mushroom Ragu", "Ostrich Medallion", "Venison Sear", "Lobster Roast", "Mussel Pot", "Branzino Sear", "Duck Shiitake", "Sea Bass Bake", "Wild Boar Roast", "Char Grill", "Elk Juniper", "Salmon Dill", "Trout Lemon", "Scallop Ghee", "Bison Chili", "Turkey Bell Skillet", "Snapper Lime", "Cod Amino", "Octopus Htapodi", "Venison Broth"]
    };

    const dayLogicMap = { 0: {w:"RECOVERY", c:"low", h:"3L"}, 1: {w:"LIFT + Massage", c:"high", h:"1 Gal"}, 2: {w:"BOXING", c:"high", h:"1.2 Gal"}, 3: {w:"REFORM", c:"low", h:"3L"}, 4: {w:"BOXING", c:"high", h:"1.2 Gal"}, 5: {w:"YOGA + REFORM", c:"low", h:"3.5L"}, 6: {w:"CS4 HIIT", c:"high", h:"1 Gal"} };

    let weekOffset = 0;

    function getMonday(offset) {
        let d = new Date();
        let day = d.getDay(), diff = d.getDate() - day + (day == 0 ? -6:1);
        let mon = new Date(d.setDate(diff));
        mon.setDate(mon.getDate() + (offset * 7));
        return mon;
    }

    function openRecipe(name) {
        const r = recipeDB[name] || { t: "20 mins", p: "40g", c: "10g", f: "10g", ing: ["Clean protein source", "Vegetable nutrient base"], steps: ["Follow Centurion standard prep: dry protein, sear high heat, rest."], mod: "Sophia: 1.5 palms; Jermaine: 2 palms protein." };
        document.getElementById('modalTitle').innerText = name;
        document.getElementById('modalTime').innerText = "â±ï¸ " + r.t;
        document.getElementById('modalP').innerText = r.p;
        document.getElementById('modalC').innerText = r.c;
        document.getElementById('modalF').innerText = r.f;
        document.getElementById('modalIng').innerHTML = r.ing.map(i => `<li>${i}</li>`).join('');
        document.getElementById('modalSteps').innerHTML = r.steps.map(s => `<p>${s}</p>`).join('');
        document.getElementById('modalMod').innerText = r.mod;
        document.getElementById('recipeModal').style.display = 'block';
    }

    function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    function openModal(id) { document.getElementById(id).style.display = 'block'; }

    function renderTabs() {
        const monday = getMonday(weekOffset);
        const tabs = document.getElementById('dayTabs');
        tabs.innerHTML = '';
        ["MON", "TUE", "WED", "THU", "FRI", "SAT", "SUN"].forEach((day, i) => {
            let tabDate = new Date(monday);
            tabDate.setDate(monday.getDate() + i);
            const btn = document.createElement('button');
            btn.className = 'tab-btn' + (i === 0 ? ' active' : '');
            btn.innerHTML = `${day}<span>${tabDate.getDate()}</span>`;
            btn.onclick = () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                showDay(tabDate);
            };
            tabs.appendChild(btn);
        });
        document.getElementById('dateHeader').innerText = `${monday.toLocaleDateString('en-US', {month:'long'})} â€” SYSTEM STABLE`;
        showDay(monday);
    }

    function showDay(dateObj) {
        const start = new Date(2025, 0, 1);
        const dayId = Math.floor((dateObj - start) / 86400000);
        const d = dayLogicMap[dateObj.getDay()];
        
        // BALANCED OFFSET LOGIC - Ensures combinations don't repeat
        const b = mealLibrary.breakfasts[dayId % 40];
        const l = mealLibrary.lunches[(dayId * 3) % 40];
        const dn = mealLibrary.dinners[(dayId * 7) % 40];

        document.getElementById('dayContent').innerHTML = `
            <div class="card">
                <div class="workout-tag"><span>${d.w}</span><span style="color:${d.c==='high'?'var(--carb-high)':'var(--carb-low)'}">${d.c.toUpperCase()} CARB</span></div>
                <div class="label">ğŸ³ Breakfast</div><div class="value" onclick="openRecipe('${b}')">ğŸ§”ğŸ¾â€â™‚ï¸ J: ${b}</div>
                <div style="font-size:0.75rem; color:var(--text-dim); margin-bottom:15px; font-style:italic;">ğŸ‘©ğŸ¾â€ğŸ¦± S: ${recipeDB[b]?.mod || "Standard Portion"}</div>
                
                <div class="label">ğŸ¥— Lunch</div><div class="value" onclick="openRecipe('${l}')">ğŸ§”ğŸ¾â€â™‚ï¸ J: ${l}</div>
                <div style="font-size:0.75rem; color:var(--text-dim); margin-bottom:15px; font-style:italic;">ğŸ‘©ğŸ¾â€ğŸ¦± S: ${recipeDB[l]?.mod || "Standard Portion"}</div>
                
                <div class="label">ğŸ½ï¸ Dinner</div><div class="value" onclick="openRecipe('${dn}')">ğŸ§”ğŸ¾â€â™‚ï¸ J: ${dn}</div>
                <div style="font-size:0.75rem; color:var(--text-dim); margin-bottom:15px; font-style:italic;">ğŸ‘©ğŸ¾â€ğŸ¦± S: ${recipeDB[dn]?.mod || "Standard Portion"}</div>
            </div>
            <div class="card" style="background:#0a0a0a; border-top:1px solid #333; padding:20px;">
                <div class="label">Daily Protocol</div>
                <div style="margin-top:10px;">
                    <span class="pb-mini">ğŸŒ¿ Sea Moss: 2tbsp</span>
                    <span class="pb-mini">ğŸ¥¤ Kombucha: 4-8oz</span>
                    <span class="pb-mini">ğŸ’§ Hydration: ${d.h}</span>
                </div>
            </div>`;
    }

    function changeWeek(dir) { weekOffset += dir; renderTabs(); }
    function resetToCurrent() { weekOffset = 0; renderTabs(); }
    window.onload = renderTabs;
</script>
</body>
</html>